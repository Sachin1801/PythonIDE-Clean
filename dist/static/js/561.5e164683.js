(self["webpackChunkvm_web_ide"]=self["webpackChunkvm_web_ide"]||[]).push([[561],{5561:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return wh}});var i=o(20641),s=o(53751),n=o(90033);const r={class:"login-modal"},a={class:"login-header"},l={class:"login-body"},d={class:"form-group"},c=["disabled"],h={class:"form-group"},u=["disabled"],p={key:0,class:"error-message"},m={key:1,class:"info-message"},f=["disabled"],g={key:0},v={key:1};function y(e,t,o,y,w,b){return o.visible?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"login-modal-overlay",onClick:t[6]||(t[6]=(0,s.D$)((...e)=>b.close&&b.close(...e),["self"]))},[(0,i.Lk)("div",r,[(0,i.Lk)("div",a,[t[7]||(t[7]=(0,i.Lk)("h2",null,"Sign In to Python IDE",-1)),(0,i.Lk)("button",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>b.close&&b.close(...e))},"×")]),(0,i.Lk)("div",l,[(0,i.Lk)("form",{onSubmit:t[5]||(t[5]=(0,s.D$)((...e)=>b.handleLogin&&b.handleLogin(...e),["prevent"]))},[(0,i.Lk)("div",d,[t[8]||(t[8]=(0,i.Lk)("label",{for:"username"},"Username (Student ID)",-1)),(0,i.bo)((0,i.Lk)("input",{id:"username","onUpdate:modelValue":t[1]||(t[1]=e=>w.username=e),type:"text",placeholder:"e.g., sa9082",required:"",disabled:w.loading,onInput:t[2]||(t[2]=(...e)=>b.clearError&&b.clearError(...e))},null,40,c),[[s.Jo,w.username]])]),(0,i.Lk)("div",h,[t[9]||(t[9]=(0,i.Lk)("label",{for:"password"},"Password",-1)),(0,i.bo)((0,i.Lk)("input",{id:"password","onUpdate:modelValue":t[3]||(t[3]=e=>w.password=e),type:"password",placeholder:"Enter your password",required:"",disabled:w.loading,onInput:t[4]||(t[4]=(...e)=>b.clearError&&b.clearError(...e))},null,40,u),[[s.Jo,w.password]])]),w.error?((0,i.uX)(),(0,i.CE)("div",p,(0,n.v_)(w.error),1)):(0,i.Q3)("",!0),w.isFirstLogin?((0,i.uX)(),(0,i.CE)("div",m,[(0,i.Lk)("p",null,[t[10]||(t[10]=(0,i.eW)("First time? Your initial password is: ",-1)),(0,i.Lk)("code",null,(0,n.v_)(w.username)+"2024",1)]),t[11]||(t[11]=(0,i.Lk)("p",null,"Please change it after logging in.",-1))])):(0,i.Q3)("",!0),(0,i.Lk)("button",{type:"submit",class:"login-btn",disabled:w.loading},[w.loading?((0,i.uX)(),(0,i.CE)("span",g,"Signing in...")):((0,i.uX)(),(0,i.CE)("span",v,"Sign In"))],8,f)],32),t[12]||(t[12]=(0,i.Lk)("div",{class:"login-footer"},[(0,i.Lk)("p",{class:"demo-info"},"Demo Accounts:"),(0,i.Lk)("ul",{class:"demo-accounts"},[(0,i.Lk)("li",null,[(0,i.eW)("Student: "),(0,i.Lk)("code",null,"sa9082"),(0,i.eW)(" / "),(0,i.Lk)("code",null,"sa90822024")]),(0,i.Lk)("li",null,[(0,i.eW)("Professor: "),(0,i.Lk)("code",null,"professor"),(0,i.eW)(" / "),(0,i.Lk)("code",null,"ChangeMeASAP2024!")])])],-1))])])])):(0,i.Q3)("",!0)}var w=o(96763),b={name:"LoginModal",props:{visible:{type:Boolean,default:!1}},data(){return{username:"",password:"",loading:!1,error:"",isFirstLogin:!1}},watch:{username(e){e&&e.match(/^[a-z]{2}\d{4}$/)?this.isFirstLogin=!0:this.isFirstLogin=!1}},methods:{async handleLogin(){this.loading=!0,this.error="";try{const e="/api/login",t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this.password})}),o=await t.json();o.success?(localStorage.setItem("session_id",o.session_id),localStorage.setItem("username",o.username),localStorage.setItem("role",o.role),localStorage.setItem("full_name",o.full_name),this.$emit("login-success",{username:o.username,role:o.role,full_name:o.full_name,session_id:o.session_id}),this.close(),window.location.reload()):this.error=o.error||"Invalid username or password"}catch(lo){w.error("Login error:",lo),this.error="Connection error. Please try again."}finally{this.loading=!1}},clearError(){this.error=""},close(){this.username="",this.password="",this.error="",this.loading=!1,this.$emit("close")},async validateSession(e){try{const t="/api/validate-session",o=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:e})}),i=await o.json();i.success||(localStorage.removeItem("session_id"),localStorage.removeItem("username"),localStorage.removeItem("role"),localStorage.removeItem("full_name"))}catch(lo){w.error("Session validation error:",lo)}}},mounted(){const e=localStorage.getItem("session_id");e&&this.validateSession(e)}},k=o(66262);const I=(0,k.A)(b,[["render",y],["__scopeId","data-v-2f673151"]]);var P=I,S=o(5012),C=o(42496),L=o(64481),F=o(65173);const R={class:"file-browser-content"},E={class:"current-path"},x={class:"path-value"},j={class:"file-tree-container"},$={class:"node-item"},D=["src"],T={class:"node-label"},M={key:0,class:"selected-file"},N={class:"selected-value"},_={key:1,class:"selected-file"},A={class:"selected-value"},W={class:"dialog-footer"};function O(e,t,o,s,r,a){const l=F.qk,d=L.S2,c=C.kZ;return(0,i.uX)(),(0,i.Wv)(c,{title:a.title,modelValue:a.visible,"onUpdate:modelValue":t[0]||(t[0]=e=>a.visible=e),width:"600px","close-on-click-modal":!1,onClose:a.handleClose,class:"file-browser-dialog custom-dialog"},{footer:(0,i.k6)(()=>[(0,i.Lk)("div",W,[(0,i.bF)(d,{onClick:a.handleClose},{default:(0,i.k6)(()=>t[4]||(t[4]=[(0,i.eW)("Cancel",-1)])),_:1,__:[4]},8,["onClick"]),(0,i.bF)(d,{type:"primary",onClick:a.handleConfirm,disabled:!a.canConfirm},{default:(0,i.k6)(()=>[(0,i.eW)((0,n.v_)(a.confirmButtonText),1)]),_:1},8,["onClick","disabled"])])]),default:(0,i.k6)(()=>[(0,i.Lk)("div",R,[(0,i.Lk)("div",E,[t[1]||(t[1]=(0,i.Lk)("span",{class:"path-label"},"Current Path:",-1)),(0,i.Lk)("span",x,(0,n.v_)(r.currentPath||"/"),1)]),(0,i.Lk)("div",j,[(0,i.bF)(l,{data:a.treeData,props:r.treeProps,"node-key":"path","expand-on-click-node":!1,"default-expanded-keys":r.expandedKeys,"highlight-current":"",onNodeClick:a.handleNodeClick,onNodeExpand:a.handleNodeExpand,onNodeCollapse:a.handleNodeCollapse,ref:"fileTree"},{default:(0,i.k6)(({node:e,data:t})=>[(0,i.Lk)("span",$,[(0,i.Lk)("img",{src:a.getIconUrl(t),alt:"",class:"node-icon"},null,8,D),(0,i.Lk)("span",T,(0,n.v_)(e.label),1)])]),_:1},8,["data","props","default-expanded-keys","onNodeClick","onNodeExpand","onNodeCollapse"])]),"open"===o.mode?((0,i.uX)(),(0,i.CE)("div",M,[t[2]||(t[2]=(0,i.Lk)("span",{class:"selected-label"},"Selected File:",-1)),(0,i.Lk)("span",N,(0,n.v_)(r.selectedFile?r.selectedFile.label:"None"),1)])):(0,i.Q3)("",!0),"move"===o.mode?((0,i.uX)(),(0,i.CE)("div",_,[t[3]||(t[3]=(0,i.Lk)("span",{class:"selected-label"},"Move to:",-1)),(0,i.Lk)("span",A,(0,n.v_)(r.selectedFolder?r.selectedFolder.path:"/"),1)])):(0,i.Q3)("",!0)])]),_:1},8,["title","modelValue","onClose"])}o(44114),o(18111),o(22489),o(7588),o(61701);var V=o(53793),U=o(96763),z={name:"DialogFileBrowser",props:{modelValue:{type:Boolean,default:!1},mode:{type:String,default:"open",validator:e=>["open","move"].includes(e)},fileToMove:{type:Object,default:null},currentUser:{type:Object,default:null}},data(){return{selectedFile:null,selectedFolder:null,currentPath:"/",expandedKeys:[],treeProps:{label:"label",children:"children"}}},computed:{visible:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},title(){return"open"===this.mode?"Open File":"Move File"},confirmButtonText(){return"open"===this.mode?"Open":"Move"},canConfirm(){return"open"===this.mode?null!==this.selectedFile:"move"===this.mode&&(null!==this.selectedFolder&&this.fileToMove&&this.selectedFolder.path!==this.getParentPath(this.fileToMove.path))},ideInfo(){return this.$store?.state?.ide?.ideInfo||{}},treeData(){let e;return e=this.ideInfo.multiRootData&&this.ideInfo.multiRootData.children.length>0?this.ideInfo.multiRootData.children:this.ideInfo.currProj.data?[this.ideInfo.currProj.data]:[],"move"===this.mode&&(e=this.filterOutFile(e),e=this.filterByPermissions(e)),e},isStudent(){return this.currentUser&&"student"===this.currentUser.role},studentDirectory(){return this.isStudent&&this.currentUser?.username?`Local/${this.currentUser.username}`:null}},methods:{getIconUrl(e){try{if("file"===e.type){const t=e.path.substring(e.path.lastIndexOf(".")+1);return o(80238)(`./${(0,V.ry)(t)}`)}if("dir"===e.type||"folder"===e.type){const t=this.expandedKeys.includes(e.path),i=t?(0,V.vT)(e.label):(0,V.lM)(e.label);return o(80238)(`./${i}`)}}catch(t){return"file"===e.type?o(77844):o(67734)}},handleNodeClick(e){if("open"===this.mode)"file"===e.type?(this.selectedFile=e,this.currentPath=e.path):this.expandedKeys.includes(e.path)?this.handleNodeCollapse(e):this.handleNodeExpand(e);else if("move"===this.mode&&("dir"===e.type||"folder"===e.type)){if(this.currentUser&&this.isStudent&&!this.canAccessPath(e.path))return void this.$message.warning("You can only move files within your personal directory");this.selectedFolder=e,this.currentPath=e.path}},handleNodeExpand(e){this.expandedKeys.includes(e.path)||this.expandedKeys.push(e.path)},handleNodeCollapse(e){const t=this.expandedKeys.indexOf(e.path);t>-1&&this.expandedKeys.splice(t,1)},handleConfirm(){if(U.log("[DialogFileBrowser] handleConfirm called:",{mode:this.mode,selectedFile:this.selectedFile,selectedFolder:this.selectedFolder,fileToMove:this.fileToMove}),"open"===this.mode&&this.selectedFile)U.log("[DialogFileBrowser] Opening file:",this.selectedFile.path),this.$emit("open-file",this.selectedFile.path),this.handleClose();else if("move"===this.mode&&this.selectedFolder&&this.fileToMove){const e=this.getFileName(this.fileToMove.path),t=this.selectedFolder.path.endsWith("/")?this.selectedFolder.path+e:this.selectedFolder.path+"/"+e;U.log("[DialogFileBrowser] Moving file - DETAILED DEBUG:",{mode:this.mode,oldPath:this.fileToMove.path,newPath:t,selectedFolderPath:this.selectedFolder.path,fileName:e,fileToMove:this.fileToMove,selectedFolder:this.selectedFolder,projectName:this.fileToMove.projectName||this.ideInfo.currProj?.data?.name}),this.$emit("move-file",{oldPath:this.fileToMove.path,newPath:t,projectName:this.fileToMove.projectName||this.ideInfo.currProj?.data?.name}),this.handleClose()}else U.log("[DialogFileBrowser] Cannot confirm - missing requirements:",{mode:this.mode,hasSelectedFile:!!this.selectedFile,hasSelectedFolder:!!this.selectedFolder,hasFileToMove:!!this.fileToMove,canConfirm:this.canConfirm})},handleClose(){this.selectedFile=null,this.selectedFolder=null,this.currentPath="/",this.expandedKeys=[],this.$emit("update:modelValue",!1)},getParentPath(e){const t=e.lastIndexOf("/");return t>0?e.substring(0,t):"/"},getFileName(e){const t=e.lastIndexOf("/");return t>=0?e.substring(t+1):e},filterOutFile(e){return this.fileToMove?e.map(e=>e.path===this.fileToMove.path?null:e.children&&e.children.length>0?{...e,children:this.filterOutFile(e.children).filter(Boolean)}:e).filter(Boolean):e},filterByPermissions(e){return this.isStudent?e.map(e=>this.canAccessPath(e.path)?e.children&&e.children.length>0?{...e,children:this.filterByPermissions(e.children)}:e:null).filter(Boolean):e},canAccessPath(e){return!this.isStudent||!(!e||!this.studentDirectory)&&(e===this.studentDirectory||e.startsWith(this.studentDirectory+"/"))}},watch:{visible(e){e&&(this.selectedFile=null,this.selectedFolder=null,this.currentPath="/",this.expandedKeys=[],this.$nextTick(()=>{this.treeData&&this.treeData.length>0&&this.treeData.forEach(e=>{"dir"!==e.type&&"folder"!==e.type||!e.path||this.expandedKeys.push(e.path)})}))}}};const B=(0,k.A)(z,[["render",O]]);var K=B;const H={class:"new-folder-dialog"},X={class:"dialog-header"},q={class:"dialog-body"},G={class:"directory-section"},Q={class:"directory-nav"},J={key:0,class:"directory-tree"},Y=["onClick"],Z={class:"foldername-section"},ee={class:"foldername-input-wrapper"},te={class:"folder-type-icon"},oe={key:0,class:"error-hint"},ie={key:1,class:"folder-hint"},se={key:0,class:"preview-section"},ne={class:"folder-preview"},re={class:"folder-info"},ae={class:"folder-path"},le={class:"dialog-footer"},de=["disabled"];function ce(e,t,o,r,a,l){const d=(0,i.g2)("X"),c=(0,i.g2)("FolderOpen"),h=(0,i.g2)("ChevronDown"),u=(0,i.g2)("ChevronRight"),p=(0,i.g2)("Home"),m=(0,i.g2)("Folder");return(0,i.uX)(),(0,i.CE)("div",null,[t[11]||(t[11]=(0,i.Lk)("div",{class:"dialog-cover"},null,-1)),(0,i.Lk)("div",H,[(0,i.Lk)("div",X,[t[6]||(t[6]=(0,i.Lk)("h3",null,"New Folder",-1)),(0,i.Lk)("div",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>l.onCancel&&l.onCancel(...e))},[(0,i.bF)(d,{size:20})])]),(0,i.Lk)("div",q,[(0,i.Lk)("div",G,[t[7]||(t[7]=(0,i.Lk)("label",null,"Select Parent Directory:",-1)),(0,i.Lk)("div",Q,[(0,i.Lk)("div",{class:"current-path",onClick:t[1]||(t[1]=(...e)=>l.toggleDirectoryTree&&l.toggleDirectoryTree(...e))},[(0,i.bF)(c,{size:16}),(0,i.Lk)("span",null,(0,n.v_)(l.formatCurrentPath(a.currentPath)),1),a.showDirectoryTree?((0,i.uX)(),(0,i.Wv)(h,{key:0,size:16,class:"chevron"})):((0,i.uX)(),(0,i.Wv)(u,{key:1,size:16,class:"chevron"}))]),a.showDirectoryTree?((0,i.uX)(),(0,i.CE)("div",J,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.directories,e=>((0,i.uX)(),(0,i.CE)("div",{key:e.path,class:(0,n.C4)(["directory-item",{selected:a.currentPath===e.path,"root-item":e.isRoot}]),style:(0,n.Tr)({paddingLeft:20*e.level+12+"px"}),onClick:t=>l.selectDirectory(e)},[e.isRoot?((0,i.uX)(),(0,i.Wv)(p,{key:0,size:14})):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.bF)(u,{size:14}),(0,i.bF)(m,{size:14})],64)),(0,i.Lk)("span",null,(0,n.v_)(e.displayName||e.name),1)],14,Y))),128))])):(0,i.Q3)("",!0)])]),(0,i.Lk)("div",Z,[t[8]||(t[8]=(0,i.Lk)("label",null,"Folder Name:",-1)),(0,i.Lk)("div",ee,[(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>a.folderName=e),onInput:t[3]||(t[3]=(...e)=>l.validateFolderName&&l.validateFolderName(...e)),placeholder:"Enter folder name",class:"foldername-input",ref:"folderNameInput"},null,544),[[s.Jo,a.folderName]]),(0,i.Lk)("div",te,[(0,i.bF)(m,{size:20})])]),a.folderNameError?((0,i.uX)(),(0,i.CE)("div",oe,(0,n.v_)(a.folderNameError),1)):((0,i.uX)(),(0,i.CE)("div",ie," Folder names should not contain special characters "))]),a.folderName&&!a.folderNameError?((0,i.uX)(),(0,i.CE)("div",se,[t[10]||(t[10]=(0,i.Lk)("label",null,"Folder will be created at:",-1)),(0,i.Lk)("div",ne,[(0,i.Lk)("div",re,[(0,i.bF)(m,{size:20}),(0,i.Lk)("div",null,[(0,i.Lk)("div",ae,(0,n.v_)(l.getFullFolderPath()),1),t[9]||(t[9]=(0,i.Lk)("div",{class:"folder-type"},"Directory",-1))])])])])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",le,[(0,i.Lk)("button",{class:"btn-cancel",onClick:t[4]||(t[4]=(...e)=>l.onCancel&&l.onCancel(...e))},"Cancel"),(0,i.Lk)("button",{class:"btn-create",onClick:t[5]||(t[5]=(...e)=>l.onCreate&&l.onCreate(...e)),disabled:!a.folderName||!!a.folderNameError||a.creating},(0,n.v_)(a.creating?"Creating...":"Create Folder"),9,de)])])])}var he=o(6494),ue=o(74829),pe=o(27336),me=o(77950),fe=o(24758),ge=o(51058),ve=o(56660),ye=o(16990),we=o(96763),be={props:{modelValue:Boolean},data(){return{currentPath:"/",currentProject:null,directories:[],folderName:"",folderNameError:"",creating:!1,showDirectoryTree:!1}},components:{X:he.A,FolderOpen:ue.A,Folder:pe.A,ChevronRight:me.A,ChevronDown:fe.A,Home:ge.A},mounted(){this.loadDirectoryStructure(),this.$nextTick(()=>{this.$refs.folderNameInput?.focus()})},methods:{loadDirectoryStructure(){if(this.ideInfo.multiRootData&&this.ideInfo.multiRootData.children.length>0?(this.directories=[],this.ideInfo.multiRootData.children.forEach(e=>{const t=this.buildDirectoryTree(e,0,e.label);this.directories=this.directories.concat(t)})):this.ideInfo.currProj&&this.ideInfo.currProj.data&&(this.directories=this.buildDirectoryTree(this.ideInfo.currProj.data,0,this.ideInfo.currProj.data.label)),this.ideInfo.nodeSelected){if("dir"===this.ideInfo.nodeSelected.type||"folder"===this.ideInfo.nodeSelected.type)this.currentPath=this.ideInfo.nodeSelected.path,this.currentProject=this.ideInfo.nodeSelected.projectName||this.ideInfo.currProj?.data?.name;else if("file"===this.ideInfo.nodeSelected.type){const e=this.ideInfo.nodeSelected.path.substring(0,this.ideInfo.nodeSelected.path.lastIndexOf("/"))||"/";this.currentPath=e,this.currentProject=this.ideInfo.nodeSelected.projectName||this.ideInfo.currProj?.data?.name}}else this.currentProject=this.ideInfo.currProj?.data?.name||this.ideInfo.currProj?.config?.name},buildDirectoryTree(e,t=0,o=null){let i=[];return 0===t&&i.push({name:o||e.label||"/",displayName:o||e.label||"/",path:e.path||"/",level:0,isRoot:!0,projectName:o||e.label,fullPath:o?`${o}${e.path}`:e.path}),e.children&&e.children.forEach(e=>{"dir"!==e.type&&"folder"!==e.type||(i.push({name:e.label,displayName:e.label,path:e.path,level:t+1,isRoot:!1,projectName:o||e.projectName,fullPath:o?`${o}${e.path}`:e.path}),e.children&&(i=i.concat(this.buildDirectoryTree(e,t+1,o))))}),i},selectDirectory(e){this.currentPath=e.path,this.currentProject=e.projectName,this.showDirectoryTree=!1},toggleDirectoryTree(){this.showDirectoryTree=!this.showDirectoryTree},formatCurrentPath(e){if(e&&"/"!==e){const t=["Local","Lecture Notes","Assignments","Tests"];for(let o of t)if(e.startsWith(o))return e}if(this.currentProject)return"/"===e?this.currentProject:e.startsWith(this.currentProject)?e:this.currentProject+e;if("/"===e&&this.ideInfo.currProj)return this.ideInfo.currProj.data?.label||this.ideInfo.currProj.config?.name;if(e.startsWith("/")&&this.ideInfo.currProj){const t=this.ideInfo.currProj.data?.label||this.ideInfo.currProj.config?.name;return e.includes(t)?e:t+e}return e},validateFolderName(){if(this.folderNameError="",!this.folderName)return;if(/[<>:"|?*\\\/]/.test(this.folderName))return void(this.folderNameError="Folder name contains invalid characters");const e=["CON","PRN","AUX","NUL","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9"],t=this.folderName.toUpperCase();e.includes(t)?this.folderNameError="This is a reserved folder name":this.folderName.startsWith(".")||this.folderName.endsWith(".")?this.folderNameError="Folder name cannot start or end with a dot":this.folderName.length>255&&(this.folderNameError="Folder name is too long")},getFullFolderPath(){const e=this.folderName||"new_folder",t="/"===this.currentPath?`/${e}`:`${this.currentPath}/${e}`;return this.formatCurrentPath(t)},async onCreate(){if(this.folderName&&!this.folderNameError){this.creating=!0;try{const e=this.folderName,t=this.currentPath,o=this.currentProject||this.ideInfo.currProj?.data?.name||this.ideInfo.currProj?.config?.name;we.log("[DialogNewFolder] Creating folder:",{folderName:e,parentPath:t,projectName:o}),await new Promise((i,s)=>{this.$store.dispatch(`ide/${ve.p_}`,{projectName:o,parentPath:t,folderName:e,callback:n=>{if(we.log("[DialogNewFolder] Create folder response:",n),0===n.code){ye.nk.success(`Folder "${e}" created successfully`),this.$store.dispatch(`ide/${ve.QQ}`,{projectName:o,callback:e=>{0===e.code&&(this.$store.commit("ide/handleProject",e.data),this.ideInfo.multiRootData&&this.$parent.loadAllDefaultProjects?.())}});const s="/"===t?`/${e}`:`${t}/${e}`;this.$emit("folder-created",{path:s,projectName:o}),this.$emit("update:modelValue",!1),i()}else{const e=n.message||n.msg||"Failed to create folder";ye.nk.error(e),s(new Error(e))}}})})}catch(lo){we.error("[DialogNewFolder] Error creating folder:",lo),ye.nk.error("Failed to create folder: "+lo.message)}finally{this.creating=!1}}},onCancel(){this.$emit("update:modelValue",!1)}},computed:{ideInfo(){return this.$store.state.ide.ideInfo}}};const ke=(0,k.A)(be,[["render",ce],["__scopeId","data-v-08e88267"]]);var Ie=ke;const Pe={class:"new-file-dialog"},Se={class:"dialog-header"},Ce={class:"dialog-body"},Le={class:"directory-section"},Fe={class:"directory-nav"},Re={key:0,class:"directory-tree"},Ee=["onClick"],xe={class:"filename-section"},je={class:"filename-input-wrapper"},$e={key:0,class:"file-type-icon"},De={key:0,class:"error-hint"},Te={key:1,class:"file-types-hint"},Me={key:0,class:"preview-section"},Ne={class:"file-preview"},_e={class:"file-info"},Ae={class:"file-path"},We={class:"file-type"},Oe={class:"dialog-footer"},Ve=["disabled"];function Ue(e,t,o,r,a,l){const d=(0,i.g2)("X"),c=(0,i.g2)("FolderOpen"),h=(0,i.g2)("ChevronDown"),u=(0,i.g2)("ChevronRight"),p=(0,i.g2)("Home"),m=(0,i.g2)("Folder"),f=(0,i.g2)("FileText");return(0,i.uX)(),(0,i.CE)("div",null,[t[10]||(t[10]=(0,i.Lk)("div",{class:"dialog-cover"},null,-1)),(0,i.Lk)("div",Pe,[(0,i.Lk)("div",Se,[t[6]||(t[6]=(0,i.Lk)("h3",null,"New File",-1)),(0,i.Lk)("div",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>l.onCancel&&l.onCancel(...e))},[(0,i.bF)(d,{size:20})])]),(0,i.Lk)("div",Ce,[(0,i.Lk)("div",Le,[t[7]||(t[7]=(0,i.Lk)("label",null,"Select Directory:",-1)),(0,i.Lk)("div",Fe,[(0,i.Lk)("div",{class:"current-path",onClick:t[1]||(t[1]=(...e)=>l.toggleDirectoryTree&&l.toggleDirectoryTree(...e))},[(0,i.bF)(c,{size:16}),(0,i.Lk)("span",null,(0,n.v_)(l.formatCurrentPath(a.currentPath)),1),a.showDirectoryTree?((0,i.uX)(),(0,i.Wv)(h,{key:0,size:16,class:"chevron"})):((0,i.uX)(),(0,i.Wv)(u,{key:1,size:16,class:"chevron"}))]),a.showDirectoryTree?((0,i.uX)(),(0,i.CE)("div",Re,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.directories,e=>((0,i.uX)(),(0,i.CE)("div",{key:e.path,class:(0,n.C4)(["directory-item",{selected:a.currentPath===e.path,"root-item":e.isRoot}]),style:(0,n.Tr)({paddingLeft:20*e.level+12+"px"}),onClick:t=>l.selectDirectory(e)},[e.isRoot?((0,i.uX)(),(0,i.Wv)(p,{key:0,size:14})):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.bF)(u,{size:14}),(0,i.bF)(m,{size:14})],64)),(0,i.Lk)("span",null,(0,n.v_)(e.displayName||e.name),1)],14,Ee))),128))])):(0,i.Q3)("",!0)])]),(0,i.Lk)("div",xe,[t[8]||(t[8]=(0,i.Lk)("label",null,"File Name:",-1)),(0,i.Lk)("div",je,[(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>a.fileName=e),onInput:t[3]||(t[3]=(...e)=>l.validateFileName&&l.validateFileName(...e)),placeholder:"Enter file name (e.g., script.py)",class:"filename-input",ref:"fileNameInput"},null,544),[[s.Jo,a.fileName]]),l.fileExtension?((0,i.uX)(),(0,i.CE)("div",$e,[(0,i.bF)(f,{size:20})])):(0,i.Q3)("",!0)]),a.fileNameError?((0,i.uX)(),(0,i.CE)("div",De,(0,n.v_)(a.fileNameError),1)):((0,i.uX)(),(0,i.CE)("div",Te," Common extensions: .py, .txt, .csv, .json, .md, .html, .css, .js "))]),a.fileName&&!a.fileNameError?((0,i.uX)(),(0,i.CE)("div",Me,[t[9]||(t[9]=(0,i.Lk)("label",null,"File will be created at:",-1)),(0,i.Lk)("div",Ne,[(0,i.Lk)("div",_e,[(0,i.bF)(f,{size:20}),(0,i.Lk)("div",null,[(0,i.Lk)("div",Ae,(0,n.v_)(l.getFullFilePath()),1),(0,i.Lk)("div",We,(0,n.v_)(l.getFileTypeDescription()),1)])])])])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",Oe,[(0,i.Lk)("button",{class:"btn-cancel",onClick:t[4]||(t[4]=(...e)=>l.onCancel&&l.onCancel(...e))},"Cancel"),(0,i.Lk)("button",{class:"btn-create",onClick:t[5]||(t[5]=(...e)=>l.onCreate&&l.onCreate(...e)),disabled:!a.fileName||!!a.fileNameError||a.creating},(0,n.v_)(a.creating?"Creating...":"Create File"),9,Ve)])])])}var ze=o(79992),Be=o(96763),Ke={props:{modelValue:Boolean},data(){return{currentPath:"/",currentProject:null,directories:[],fileName:"",fileNameError:"",creating:!1,showDirectoryTree:!1}},computed:{ideInfo(){return this.$store.state.ide.ideInfo},fileExtension(){if(!this.fileName)return"";const e=this.fileName.lastIndexOf(".");return e>0?this.fileName.substring(e):""}},components:{X:he.A,FolderOpen:ue.A,Folder:pe.A,ChevronRight:me.A,ChevronDown:fe.A,FileText:ze.A,Home:ge.A},mounted(){this.loadDirectoryStructure(),this.$nextTick(()=>{this.$refs.fileNameInput?.focus()})},methods:{loadDirectoryStructure(){if(this.ideInfo.multiRootData&&this.ideInfo.multiRootData.children.length>0?(this.directories=[],this.ideInfo.multiRootData.children.forEach(e=>{const t=this.buildDirectoryTree(e,0,e.label);this.directories=this.directories.concat(t)})):this.ideInfo.currProj&&this.ideInfo.currProj.data&&(this.directories=this.buildDirectoryTree(this.ideInfo.currProj.data,0,this.ideInfo.currProj.data.label)),this.ideInfo.nodeSelected){if("dir"===this.ideInfo.nodeSelected.type||"folder"===this.ideInfo.nodeSelected.type)this.currentPath=this.ideInfo.nodeSelected.path,this.currentProject=this.ideInfo.nodeSelected.projectName||this.ideInfo.currProj?.data?.name;else if("file"===this.ideInfo.nodeSelected.type){const e=this.ideInfo.nodeSelected.path.substring(0,this.ideInfo.nodeSelected.path.lastIndexOf("/"))||"/";this.currentPath=e,this.currentProject=this.ideInfo.nodeSelected.projectName||this.ideInfo.currProj?.data?.name}}else this.currentProject=this.ideInfo.currProj?.data?.name||this.ideInfo.currProj?.config?.name},buildDirectoryTree(e,t=0,o=null){let i=[];return 0===t&&i.push({name:o||e.label||"/",displayName:o||e.label||"/",path:e.path||"/",level:0,isRoot:!0,projectName:o||e.label,fullPath:o?`${o}${e.path}`:e.path}),e.children&&e.children.forEach(e=>{"dir"!==e.type&&"folder"!==e.type||(i.push({name:e.label,displayName:e.label,path:e.path,level:t+1,isRoot:!1,projectName:o||e.projectName,fullPath:o?`${o}${e.path}`:e.path}),e.children&&(i=i.concat(this.buildDirectoryTree(e,t+1,o))))}),i},selectDirectory(e){this.currentPath=e.path,this.currentProject=e.projectName,this.showDirectoryTree=!1},toggleDirectoryTree(){this.showDirectoryTree=!this.showDirectoryTree},formatCurrentPath(e){if(e&&"/"!==e){const t=["Local","Lecture Notes","Assignments","Tests"];for(let o of t)if(e.startsWith(o))return e}if(this.currentProject)return"/"===e?this.currentProject:e.startsWith(this.currentProject)?e:this.currentProject+e;if("/"===e&&this.ideInfo.currProj)return this.ideInfo.currProj.data?.label||this.ideInfo.currProj.config?.name;if(e.startsWith("/")&&this.ideInfo.currProj){const t=this.ideInfo.currProj.data?.label||this.ideInfo.currProj.config?.name;return e.includes(t)?e:t+e}return e},validateFileName(){if(this.fileNameError="",!this.fileName)return;if(/[<>:"|?*\\]/.test(this.fileName))return void(this.fileNameError="File name contains invalid characters");const e=["CON","PRN","AUX","NUL","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9"],t=this.fileName.split(".")[0].toUpperCase();e.includes(t)?this.fileNameError="This is a reserved file name":this.fileName.startsWith(".")||this.fileName.endsWith(".")?this.fileNameError="File name cannot start or end with a dot":this.fileExtension||(this.fileNameError="Consider adding a file extension (e.g., .py, .txt)")},getFullFilePath(){const e=this.fileName||"new_file",t="/"===this.currentPath?`/${e}`:`${this.currentPath}/${e}`;return this.formatCurrentPath(t)},getFileTypeDescription(){const e=this.fileExtension.toLowerCase(),t={".py":"Python Script",".txt":"Text File",".csv":"CSV Data File",".json":"JSON Data File",".md":"Markdown Document",".html":"HTML Document",".css":"CSS Stylesheet",".js":"JavaScript File",".xml":"XML Document",".yaml":"YAML Configuration",".yml":"YAML Configuration",".ini":"Configuration File",".log":"Log File"};return t[e]||"File"},async onCreate(){if(this.fileName&&!this.fileNameError){this.creating=!0;try{const e=this.fileName,t=this.currentPath,o=this.currentProject||this.ideInfo.currProj?.data?.name||this.ideInfo.currProj?.config?.name;Be.log("[DialogNewFile] Creating file:",{fileName:e,parentPath:t,projectName:o});let i="";const s=this.fileExtension.toLowerCase();".py"===s?i="#!/usr/bin/env python3\n\n":".json"===s&&(i="{}"),await new Promise((s,n)=>{this.$store.dispatch(`ide/${ve.Zd}`,{projectName:o,parentPath:t,fileName:e,callback:r=>{if(Be.log("[DialogNewFile] Create file response:",r),0===r.code){if(ye.nk.success(`File "${e}" created successfully`),i){const n="/"===t?`/${e}`:`${t}/${e}`;this.$store.dispatch(`ide/${ve._L}`,{projectName:o,filePath:n,fileData:i,callback:e=>{Be.log("[DialogNewFile] Write file response:",e),s()}})}else s();this.$store.dispatch(`ide/${ve.QQ}`,{projectName:o,callback:e=>{0===e.code&&(this.$store.commit("ide/handleProject",e.data),this.ideInfo.multiRootData&&this.$parent.loadAllDefaultProjects?.())}});const n="/"===t?`/${e}`:`${t}/${e}`;this.$emit("file-created",{path:n,projectName:o}),this.$emit("update:modelValue",!1)}else{const e=r.message||"Failed to create file";ye.nk.error(e),n(new Error(e))}}})})}catch(lo){Be.error("[DialogNewFile] Error creating file:",lo),ye.nk.error("Failed to create file: "+lo.message)}finally{this.creating=!1}}},onCancel(){this.$emit("update:modelValue",!1)}}};const He=(0,k.A)(Ke,[["render",Ue],["__scopeId","data-v-eec68352"]]);var Xe=He,qe=o(22542),Ge=o(7093),Qe=o(22164),Je=o(94411),Ye=o(16309),Ze=o(42258),et=o(31423),tt=o(91030);const ot={key:0,class:"fullscreen-preview"},it={class:"preview-header"},st={class:"preview-header-left"},nt={class:"preview-title"},rt={class:"preview-header-right"},at={class:"preview-content"},lt={key:2,class:"unsupported-preview"};function dt(e,t,o,s,r,a){const l=Ye.A,d=Ze.A;return a.isActive?((0,i.uX)(),(0,i.CE)("div",ot,[(0,i.Lk)("div",it,[(0,i.Lk)("div",st,[(0,i.Lk)("span",nt,(0,n.v_)(a.fileName),1)]),(0,i.Lk)("div",rt,[(0,i.Lk)("button",{class:"preview-action-btn",onClick:t[0]||(t[0]=(...e)=>a.openInRightPanel&&a.openInRightPanel(...e)),title:"Open in Right Panel"},t[2]||(t[2]=[(0,i.Lk)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[(0,i.Lk)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),(0,i.Lk)("path",{d:"M15 3v18"})],-1)])),(0,i.Lk)("button",{class:"preview-close-btn",onClick:t[1]||(t[1]=(...e)=>a.close&&a.close(...e)),title:"Close Preview"},t[3]||(t[3]=[(0,i.Lk)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[(0,i.Lk)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,i.Lk)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))])]),(0,i.Lk)("div",at,[a.isCsvFile?((0,i.uX)(),(0,i.Wv)(l,{key:0,content:a.content},null,8,["content"])):a.isMediaFile?((0,i.uX)(),(0,i.Wv)(d,{key:1,codeItem:a.mediaCodeItem,codeItemIndex:0},null,8,["codeItem"])):((0,i.uX)(),(0,i.CE)("div",lt,t[4]||(t[4]=[(0,i.Lk)("p",null,"Preview not supported for this file type",-1)])))])])):(0,i.Q3)("",!0)}var ct={name:"FullscreenPreview",components:{CsvViewer:Ye.A,MediaViewer:Ze.A},computed:{ideInfo(){return this.$store.state.ide.ideInfo},isActive(){return this.ideInfo.fullscreenPreview.active},file(){return this.ideInfo.fullscreenPreview.file},content(){return this.ideInfo.fullscreenPreview.content},fileName(){return this.file?.name||""},filePath(){return this.file?.path||""},isCsvFile(){return this.filePath.toLowerCase().endsWith(".csv")},isMediaFile(){const e=[".png",".jpg",".jpeg",".gif",".bmp",".svg",".webp",".pdf"],t=this.filePath.toLowerCase();return e.some(e=>t.endsWith(e))},mediaCodeItem(){return this.file?{name:this.file.name,path:this.file.path,projectName:this.file.projectName,content:this.content,preloaded:!0}:null}},methods:{close(){this.$store.commit("ide/closeFullscreenPreview")},openInRightPanel(){this.$store.commit("ide/closeFullscreenPreview"),this.file&&this.$emit("open-in-right-panel",this.file.path)}},mounted(){this.handleEsc=e=>{"Escape"===e.key&&this.isActive&&this.close()},document.addEventListener("keydown",this.handleEsc)},beforeUnmount(){document.removeEventListener("keydown",this.handleEsc)}};const ht=(0,k.A)(ct,[["render",dt],["__scopeId","data-v-3c263865"]]);var ut=ht,pt=o(52707);const mt={class:"modal-header"},ft={class:"modal-body"},gt={class:"input-group"},vt={key:0,class:"input-group"},yt={class:"options-group"},wt={class:"checkbox-label"},bt={class:"checkbox-label"},kt={class:"checkbox-label"},It={key:1,class:"search-info"},Pt={class:"modal-footer"},St={class:"button-group"},Ct=["disabled"],Lt=["disabled"],Ft=["disabled"],Rt=["disabled"];function Et(e,t,o,r,a,l){const d=(0,i.g2)("X"),c=(0,i.g2)("ChevronUp"),h=(0,i.g2)("ChevronDown");return(0,i.uX)(),(0,i.Wv)(s.eB,{name:"modal-fade"},{default:(0,i.k6)(()=>[o.modelValue?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"find-replace-overlay",onClick:t[16]||(t[16]=(0,s.D$)((...e)=>l.close&&l.close(...e),["self"]))},[(0,i.Lk)("div",{class:"find-replace-modal",onClick:t[15]||(t[15]=(0,s.D$)(()=>{},["stop"]))},[(0,i.Lk)("div",mt,[(0,i.Lk)("h3",null,(0,n.v_)(l.isReplaceMode?"Find and Replace":"Find"),1),(0,i.Lk)("button",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>l.close&&l.close(...e)),title:"Close (Esc)"},[(0,i.bF)(d,{size:18})])]),(0,i.Lk)("div",ft,[(0,i.Lk)("div",gt,[t[17]||(t[17]=(0,i.Lk)("label",null,"Find:",-1)),(0,i.bo)((0,i.Lk)("input",{ref:"findInput","onUpdate:modelValue":t[1]||(t[1]=e=>a.findText=e),type:"text",class:"modal-input",placeholder:"Enter text to find...",onKeydown:[t[2]||(t[2]=(0,s.jR)((...e)=>l.findNext&&l.findNext(...e),["enter"])),t[3]||(t[3]=(0,s.jR)((...e)=>l.close&&l.close(...e),["escape"]))]},null,544),[[s.Jo,a.findText]])]),l.isReplaceMode?((0,i.uX)(),(0,i.CE)("div",vt,[t[18]||(t[18]=(0,i.Lk)("label",null,"Replace with:",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>a.replaceText=e),type:"text",class:"modal-input",placeholder:"Enter replacement text...",onKeydown:[t[5]||(t[5]=(0,s.jR)((...e)=>l.replace&&l.replace(...e),["enter"])),t[6]||(t[6]=(0,s.jR)((...e)=>l.close&&l.close(...e),["escape"]))]},null,544),[[s.Jo,a.replaceText]])])):(0,i.Q3)("",!0),(0,i.Lk)("div",yt,[(0,i.Lk)("label",wt,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=e=>a.caseSensitive=e)},null,512),[[s.lH,a.caseSensitive]]),t[19]||(t[19]=(0,i.Lk)("span",null,"Case sensitive",-1))]),(0,i.Lk)("label",bt,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=e=>a.wholeWord=e)},null,512),[[s.lH,a.wholeWord]]),t[20]||(t[20]=(0,i.Lk)("span",null,"Whole word",-1))]),(0,i.Lk)("label",kt,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=e=>a.useRegex=e)},null,512),[[s.lH,a.useRegex]]),t[21]||(t[21]=(0,i.Lk)("span",null,"Regular expression",-1))])]),a.searchInfo?((0,i.uX)(),(0,i.CE)("div",It,(0,n.v_)(a.searchInfo),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",Pt,[(0,i.Lk)("div",St,[(0,i.Lk)("button",{class:"action-btn",onClick:t[10]||(t[10]=(...e)=>l.findPrevious&&l.findPrevious(...e)),disabled:!a.findText},[(0,i.bF)(c,{size:16}),t[22]||(t[22]=(0,i.eW)(" Find Previous ",-1))],8,Ct),(0,i.Lk)("button",{class:"action-btn primary",onClick:t[11]||(t[11]=(...e)=>l.findNext&&l.findNext(...e)),disabled:!a.findText},[(0,i.bF)(h,{size:16}),t[23]||(t[23]=(0,i.eW)(" Find Next ",-1))],8,Lt),l.isReplaceMode?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.Lk)("button",{class:"action-btn",onClick:t[12]||(t[12]=(...e)=>l.replace&&l.replace(...e)),disabled:!a.findText}," Replace ",8,Ft),(0,i.Lk)("button",{class:"action-btn",onClick:t[13]||(t[13]=(...e)=>l.replaceAll&&l.replaceAll(...e)),disabled:!a.findText}," Replace All ",8,Rt)],64)):(0,i.Q3)("",!0),(0,i.Lk)("button",{class:"action-btn",onClick:t[14]||(t[14]=(...e)=>l.close&&l.close(...e))}," Close ")])])])])):(0,i.Q3)("",!0)]),_:1})}var xt=o(53957);
/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const jt=(0,xt.A)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var $t={name:"FindReplaceModal",components:{X:he.A,ChevronUp:jt,ChevronDown:fe.A},props:{modelValue:{type:Boolean,default:!1},mode:{type:String,default:"find",validator:e=>["find","replace"].includes(e)}},data(){return{findText:"",replaceText:"",caseSensitive:!1,wholeWord:!1,useRegex:!1,searchInfo:"",currentMatch:0,totalMatches:0,searchCursor:null}},computed:{isReplaceMode(){return"replace"===this.mode},activeEditor(){const e=document.querySelector(".editor-content .code-editor-flex .CodeMirror");return e&&e.CodeMirror?e.CodeMirror:null}},watch:{modelValue(e){e?this.$nextTick(()=>{this.$refs.findInput?.focus(),this.initializeSearch()}):this.clearSearch()},findText(){this.findText?this.updateSearchInfo():(this.searchInfo="",this.clearSearch())}},methods:{initializeSearch(){if(this.activeEditor){const e=this.activeEditor.getSelection();e&&(this.findText=e)}},clearSearch(){this.activeEditor&&this.activeEditor.operation(()=>{const e=this.activeEditor.getAllMarks();e.forEach(e=>{"CodeMirror-search-match"===e.className&&e.clear()})}),this.searchCursor=null,this.currentMatch=0,this.totalMatches=0,this.searchInfo=""},getSearchQuery(){let e=this.findText;this.useRegex||(e=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),this.wholeWord&&(e="\\b"+e+"\\b");try{return new RegExp(e,this.caseSensitive?"g":"gi")}catch(t){return this.findText}},findNext(){if(!this.findText||!this.activeEditor)return;const e=this.getSearchQuery(),t=this.activeEditor.getSearchCursor(e,this.activeEditor.getCursor(),!this.caseSensitive);if(t.findNext())this.activeEditor.setSelection(t.from(),t.to()),this.activeEditor.scrollIntoView(t.from(),50),this.highlightMatch(t);else{const t=this.activeEditor.getSearchCursor(e,{line:0,ch:0},!this.caseSensitive);t.findNext()?(this.activeEditor.setSelection(t.from(),t.to()),this.activeEditor.scrollIntoView(t.from(),50),this.highlightMatch(t),this.searchInfo="Wrapped to beginning"):this.searchInfo="No matches found"}this.updateSearchInfo()},findPrevious(){if(!this.findText||!this.activeEditor)return;const e=this.getSearchQuery(),t=this.activeEditor.getSearchCursor(e,this.activeEditor.getCursor("from"),!this.caseSensitive);if(t.findPrevious())this.activeEditor.setSelection(t.from(),t.to()),this.activeEditor.scrollIntoView(t.from(),50),this.highlightMatch(t);else{const t=this.activeEditor.lastLine(),o=this.activeEditor.getLine(t).length,i=this.activeEditor.getSearchCursor(e,{line:t,ch:o},!this.caseSensitive);i.findPrevious()?(this.activeEditor.setSelection(i.from(),i.to()),this.activeEditor.scrollIntoView(i.from(),50),this.highlightMatch(i),this.searchInfo="Wrapped to end"):this.searchInfo="No matches found"}this.updateSearchInfo()},replace(){if(!this.findText||!this.activeEditor)return;const e=this.activeEditor.getSelection(),t=this.getSearchQuery();e&&("string"===typeof t&&e===t||t instanceof RegExp&&t.test(e))?(this.activeEditor.replaceSelection(this.replaceText),this.findNext()):this.findNext()},replaceAll(){if(!this.findText||!this.activeEditor)return;const e=this.getSearchQuery(),t=this.activeEditor.getSearchCursor(e,{line:0,ch:0},!this.caseSensitive);let o=0;this.activeEditor.operation(()=>{while(t.findNext())t.replace(this.replaceText),o++}),this.searchInfo=`Replaced ${o} occurrence${1!==o?"s":""}`},highlightMatch(e){},updateSearchInfo(){if(!this.findText||!this.activeEditor)return void(this.searchInfo="");const e=this.getSearchQuery(),t=this.activeEditor.getSearchCursor(e,{line:0,ch:0},!this.caseSensitive);let o=0;while(t.findNext())o++;this.searchInfo=0===o?"No matches found":1===o?"1 match found":`${o} matches found`},close(){this.clearSearch(),this.$emit("update:modelValue",!1)},handleKeydown(e){"Escape"===e.key?this.close():("F3"===e.key||e.ctrlKey&&"g"===e.key)&&(e.preventDefault(),e.shiftKey?this.findPrevious():this.findNext())}},mounted(){document.addEventListener("keydown",this.handleKeydown)},beforeUnmount(){document.removeEventListener("keydown",this.handleKeydown),this.clearSearch()}};const Dt=(0,k.A)($t,[["render",Et],["__scopeId","data-v-28db288f"]]);var Tt=Dt;const Mt={class:"modal-container"},Nt={class:"modal-header"};function _t(e,t,o,n,r,a){const l=(0,i.g2)("X");return(0,i.uX)(),(0,i.Wv)(s.eB,{name:"modal-fade"},{default:(0,i.k6)(()=>[o.modelValue?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"modal-overlay",onClick:t[1]||(t[1]=(0,s.D$)((...e)=>a.close&&a.close(...e),["self"]))},[(0,i.Lk)("div",Mt,[(0,i.Lk)("div",Nt,[t[2]||(t[2]=(0,i.Lk)("h2",null,"Keyboard Shortcuts (Universal for Mac/Windows/Linux)",-1)),(0,i.Lk)("button",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>a.close&&a.close(...e))},[(0,i.bF)(l,{size:20})])]),t[3]||(t[3]=(0,i.Lk)("div",{class:"modal-body"},[(0,i.Lk)("div",{class:"shortcut-section"},[(0,i.Lk)("h3",null,"File Operations"),(0,i.Lk)("div",{class:"shortcut-list"},[(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"New File"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+Alt+N")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Open File"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+O")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Save"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+S")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Save As"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+Shift+S")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Move"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+Shift+M")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Download"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+D")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Delete File"),(0,i.Lk)("span",{class:"shortcut-keys"},"Delete")])])]),(0,i.Lk)("div",{class:"shortcut-section"},[(0,i.Lk)("h3",null,"Edit Operations"),(0,i.Lk)("div",{class:"shortcut-list"},[(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Undo"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+Z")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Redo"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+Y")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Cut"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+X")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Copy"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+C")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Paste"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+V")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Find"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+F")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Replace"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+H")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Comment/Uncomment"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+/")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Select All"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+A")])])]),(0,i.Lk)("div",{class:"shortcut-section"},[(0,i.Lk)("h3",null,"Run Operations"),(0,i.Lk)("div",{class:"shortcut-list"},[(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Run Script"),(0,i.Lk)("span",{class:"shortcut-keys"},"F5")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Stop Script"),(0,i.Lk)("span",{class:"shortcut-keys"},"Shift+F5")])])]),(0,i.Lk)("div",{class:"shortcut-section"},[(0,i.Lk)("h3",null,"View Operations"),(0,i.Lk)("div",{class:"shortcut-list"},[(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Toggle Console"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+`")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Toggle Preview Panel"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+Shift+P")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Toggle Sidebar"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+B")])])]),(0,i.Lk)("div",{class:"shortcut-section"},[(0,i.Lk)("h3",null,"General"),(0,i.Lk)("div",{class:"shortcut-list"},[(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Show Keyboard Shortcuts"),(0,i.Lk)("span",{class:"shortcut-keys"},"F1")]),(0,i.Lk)("div",{class:"shortcut-item"},[(0,i.Lk)("span",{class:"shortcut-action"},"Settings"),(0,i.Lk)("span",{class:"shortcut-keys"},"Ctrl+,")])])])],-1))])])):(0,i.Q3)("",!0)]),_:1})}var At={name:"KeyboardShortcutsModal",props:{modelValue:{type:Boolean,default:!1}},components:{X:he.A},methods:{close(){this.$emit("update:modelValue",!1)}},mounted(){this.handleEsc=e=>{"Escape"===e.key&&this.modelValue&&this.close()},document.addEventListener("keydown",this.handleEsc)},beforeUnmount(){document.removeEventListener("keydown",this.handleEsc)}};const Wt=(0,k.A)(At,[["render",_t],["__scopeId","data-v-62d3d050"]]);var Ot=Wt,Vt=o(86461),Ut=o(50953),zt=o(50819);const Bt=(0,zt.b_)({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:(0,zt.jq)(String),default:"solid"}});var Kt=o(78396),Ht=o(65980);const Xt=(0,i.pM)({name:"ElDivider"}),qt=(0,i.pM)({...Xt,props:Bt,setup(e){const t=e,o=(0,Ht.DU)("divider"),s=(0,i.EW)(()=>o.cssVar({"border-style":t.borderStyle}));return(e,t)=>((0,i.uX)(),(0,i.CE)("div",{class:(0,n.C4)([(0,Ut.R1)(o).b(),(0,Ut.R1)(o).m(e.direction)]),style:(0,n.Tr)((0,Ut.R1)(s)),role:"separator"},[e.$slots.default&&"vertical"!==e.direction?((0,i.uX)(),(0,i.CE)("div",{key:0,class:(0,n.C4)([(0,Ut.R1)(o).e("text"),(0,Ut.R1)(o).is(e.contentPosition)])},[(0,i.RG)(e.$slots,"default")],2)):(0,i.Q3)("v-if",!0)],6))}});var Gt=(0,Kt.A)(qt,[["__file","divider.vue"]]),Qt=o(64769);const Jt=(0,Qt.GU)(Gt);var Yt=o(67959),Zt=o(18472),eo=o(2154);const to=(0,zt.b_)({size:{type:String,values:Zt.I},disabled:Boolean}),oo=(0,zt.b_)({...to,model:Object,rules:{type:(0,zt.jq)(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:(0,zt.jq)([Object,Boolean]),default:!0}}),io={validate:(e,t,o)=>((0,n.cy)(e)||(0,n.Kg)(e))&&(0,eo.Lm)(t)&&(0,n.Kg)(o)};var so=o(67996);function no(){const e=(0,Ut.KR)([]),t=(0,i.EW)(()=>{if(!e.value.length)return"0";const t=Math.max(...e.value);return t?`${t}px`:""});function o(o){const i=e.value.indexOf(o);return-1===i&&t.value,i}function s(t,i){if(t&&i){const s=o(i);e.value.splice(s,1,t)}else t&&e.value.push(t)}function n(t){const i=o(t);i>-1&&e.value.splice(i,1)}return{autoLabelWidth:t,registerLabelWidth:s,deregisterLabelWidth:n}}const ro=(e,t)=>{const o=(0,so.A)(t).map(e=>(0,n.cy)(e)?e.join("."):e);return o.length>0?e.filter(e=>e.propString&&o.includes(e.propString)):e};var ao=o(72207),lo=o(41651);const co="ElForm",ho=(0,i.pM)({name:co}),uo=(0,i.pM)({...ho,props:oo,emits:io,setup(e,{expose:t,emit:o}){const s=e,r=(0,Ut.KR)(),a=(0,Ut.Kh)([]),l=(0,ao.NV)(),d=(0,Ht.DU)("form"),c=(0,i.EW)(()=>{const{labelPosition:e,inline:t}=s;return[d.b(),d.m(l.value||"default"),{[d.m(`label-${e}`)]:e,[d.m("inline")]:t}]}),h=e=>ro(a,[e])[0],u=e=>{a.push(e)},p=e=>{e.prop&&a.splice(a.indexOf(e),1)},m=(e=[])=>{s.model&&ro(a,e).forEach(e=>e.resetField())},f=(e=[])=>{ro(a,e).forEach(e=>e.clearValidate())},g=(0,i.EW)(()=>{const e=!!s.model;return e}),v=e=>{if(0===a.length)return[];const t=ro(a,e);return t.length?t:[]},y=async e=>b(void 0,e),w=async(e=[])=>{if(!g.value)return!1;const t=v(e);if(0===t.length)return!0;let o={};for(const s of t)try{await s.validate(""),"error"!==s.validateState||s.error||s.resetField()}catch(i){o={...o,...i}}return 0===Object.keys(o).length||Promise.reject(o)},b=async(e=[],t)=>{let o=!1;const i=!(0,n.Tn)(t);try{return o=await w(e),!0===o&&await(null==t?void 0:t(o)),o}catch(a){if(a instanceof Error)throw a;const e=a;if(s.scrollToError&&r.value){const e=r.value.querySelector(`.${d.b()}-item.is-error`);null==e||e.scrollIntoView(s.scrollIntoViewOptions)}return!o&&await(null==t?void 0:t(!1,e)),i&&Promise.reject(e)}},k=e=>{var t;const o=h(e);o&&(null==(t=o.$el)||t.scrollIntoView(s.scrollIntoViewOptions))};return(0,i.wB)(()=>s.rules,()=>{s.validateOnRuleChange&&y().catch(e=>(0,lo.U)())},{deep:!0,flush:"post"}),(0,i.Gt)(Yt.F,(0,Ut.Kh)({...(0,Ut.QW)(s),emit:o,resetFields:m,clearValidate:f,validateField:b,getField:h,addField:u,removeField:p,...no()})),t({validate:y,validateField:b,resetFields:m,clearValidate:f,scrollToField:k,getField:h,fields:a}),(e,t)=>((0,i.uX)(),(0,i.CE)("form",{ref_key:"formRef",ref:r,class:(0,n.C4)((0,Ut.R1)(c))},[(0,i.RG)(e.$slots,"default")],2))}});var po=(0,Kt.A)(uo,[["__file","form.vue"]]),mo=(o(65606),o(96763));function fo(){return fo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},fo.apply(this,arguments)}function go(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,yo(e,t)}function vo(e){return vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vo(e)}function yo(e,t){return yo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},yo(e,t)}function wo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function bo(e,t,o){return bo=wo()?Reflect.construct.bind():function(e,t,o){var i=[null];i.push.apply(i,t);var s=Function.bind.apply(e,i),n=new s;return o&&yo(n,o.prototype),n},bo.apply(null,arguments)}function ko(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function Io(e){var t="function"===typeof Map?new Map:void 0;return Io=function(e){if(null===e||!ko(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return bo(e,arguments,vo(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),yo(o,e)},Io(e)}var Po=/%[sdj%]/g,So=function(){};function Co(e){if(!e||!e.length)return null;var t={};return e.forEach(function(e){var o=e.field;t[o]=t[o]||[],t[o].push(e)}),t}function Lo(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];var s=0,n=o.length;if("function"===typeof e)return e.apply(null,o);if("string"===typeof e){var r=e.replace(Po,function(e){if("%%"===e)return"%";if(s>=n)return e;switch(e){case"%s":return String(o[s++]);case"%d":return Number(o[s++]);case"%j":try{return JSON.stringify(o[s++])}catch(t){return"[Circular]"}default:return e}});return r}return e}function Fo(e){return"string"===e||"url"===e||"hex"===e||"email"===e||"date"===e||"pattern"===e}function Ro(e,t){return void 0===e||null===e||(!("array"!==t||!Array.isArray(e)||e.length)||!(!Fo(t)||"string"!==typeof e||e))}function Eo(e,t,o){var i=[],s=0,n=e.length;function r(e){i.push.apply(i,e||[]),s++,s===n&&o(i)}e.forEach(function(e){t(e,r)})}function xo(e,t,o){var i=0,s=e.length;function n(r){if(r&&r.length)o(r);else{var a=i;i+=1,a<s?t(e[a],n):o([])}}n([])}function jo(e){var t=[];return Object.keys(e).forEach(function(o){t.push.apply(t,e[o]||[])}),t}var $o=function(e){function t(t,o){var i;return i=e.call(this,"Async Validation Error")||this,i.errors=t,i.fields=o,i}return go(t,e),t}(Io(Error));function Do(e,t,o,i,s){if(t.first){var n=new Promise(function(t,n){var r=function(e){return i(e),e.length?n(new $o(e,Co(e))):t(s)},a=jo(e);xo(a,o,r)});return n["catch"](function(e){return e}),n}var r=!0===t.firstFields?Object.keys(e):t.firstFields||[],a=Object.keys(e),l=a.length,d=0,c=[],h=new Promise(function(t,n){var h=function(e){if(c.push.apply(c,e),d++,d===l)return i(c),c.length?n(new $o(c,Co(c))):t(s)};a.length||(i(c),t(s)),a.forEach(function(t){var i=e[t];-1!==r.indexOf(t)?xo(i,o,h):Eo(i,o,h)})});return h["catch"](function(e){return e}),h}function To(e){return!(!e||void 0===e.message)}function Mo(e,t){for(var o=e,i=0;i<t.length;i++){if(void 0==o)return o;o=o[t[i]]}return o}function No(e,t){return function(o){var i;return i=e.fullFields?Mo(t,e.fullFields):t[o.field||e.fullField],To(o)?(o.field=o.field||e.fullField,o.fieldValue=i,o):{message:"function"===typeof o?o():o,fieldValue:i,field:o.field||e.fullField}}}function _o(e,t){if(t)for(var o in t)if(t.hasOwnProperty(o)){var i=t[o];"object"===typeof i&&"object"===typeof e[o]?e[o]=fo({},e[o],i):e[o]=i}return e}var Ao,Wo=function(e,t,o,i,s,n){!e.required||o.hasOwnProperty(e.field)&&!Ro(t,n||e.type)||i.push(Lo(s.messages.required,e.fullField))},Oo=function(e,t,o,i,s){(/^\s+$/.test(t)||""===t)&&i.push(Lo(s.messages.whitespace,e.fullField))},Vo=function(){if(Ao)return Ao;var e="[a-fA-F\\d:]",t=function(t){return t&&t.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},o="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",i="[a-fA-F\\d]{1,4}",s=("\n(?:\n(?:"+i+":){7}(?:"+i+"|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:"+i+":){6}(?:"+o+"|:"+i+"|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:"+i+":){5}(?::"+o+"|(?::"+i+"){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:"+i+":){4}(?:(?::"+i+"){0,1}:"+o+"|(?::"+i+"){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:"+i+":){3}(?:(?::"+i+"){0,2}:"+o+"|(?::"+i+"){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:"+i+":){2}(?:(?::"+i+"){0,3}:"+o+"|(?::"+i+"){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:"+i+":){1}(?:(?::"+i+"){0,4}:"+o+"|(?::"+i+"){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::"+i+"){0,5}:"+o+"|(?::"+i+"){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n").replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),n=new RegExp("(?:^"+o+"$)|(?:^"+s+"$)"),r=new RegExp("^"+o+"$"),a=new RegExp("^"+s+"$"),l=function(e){return e&&e.exact?n:new RegExp("(?:"+t(e)+o+t(e)+")|(?:"+t(e)+s+t(e)+")","g")};l.v4=function(e){return e&&e.exact?r:new RegExp(""+t(e)+o+t(e),"g")},l.v6=function(e){return e&&e.exact?a:new RegExp(""+t(e)+s+t(e),"g")};var d="(?:(?:[a-z]+:)?//)",c="(?:\\S+(?::\\S*)?@)?",h=l.v4().source,u=l.v6().source,p="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",m="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",f="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",g="(?::\\d{2,5})?",v='(?:[/?#][^\\s"]*)?',y="(?:"+d+"|www\\.)"+c+"(?:localhost|"+h+"|"+u+"|"+p+m+f+")"+g+v;return Ao=new RegExp("(?:^"+y+"$)","i"),Ao},Uo={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},zo={integer:function(e){return zo.number(e)&&parseInt(e,10)===e},float:function(e){return zo.number(e)&&!zo.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch(t){return!1}},date:function(e){return"function"===typeof e.getTime&&"function"===typeof e.getMonth&&"function"===typeof e.getYear&&!isNaN(e.getTime())},number:function(e){return!isNaN(e)&&"number"===typeof e},object:function(e){return"object"===typeof e&&!zo.array(e)},method:function(e){return"function"===typeof e},email:function(e){return"string"===typeof e&&e.length<=320&&!!e.match(Uo.email)},url:function(e){return"string"===typeof e&&e.length<=2048&&!!e.match(Vo())},hex:function(e){return"string"===typeof e&&!!e.match(Uo.hex)}},Bo=function(e,t,o,i,s){if(e.required&&void 0===t)Wo(e,t,o,i,s);else{var n=["integer","float","array","regexp","object","method","email","number","date","url","hex"],r=e.type;n.indexOf(r)>-1?zo[r](t)||i.push(Lo(s.messages.types[r],e.fullField,e.type)):r&&typeof t!==e.type&&i.push(Lo(s.messages.types[r],e.fullField,e.type))}},Ko=function(e,t,o,i,s){var n="number"===typeof e.len,r="number"===typeof e.min,a="number"===typeof e.max,l=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,d=t,c=null,h="number"===typeof t,u="string"===typeof t,p=Array.isArray(t);if(h?c="number":u?c="string":p&&(c="array"),!c)return!1;p&&(d=t.length),u&&(d=t.replace(l,"_").length),n?d!==e.len&&i.push(Lo(s.messages[c].len,e.fullField,e.len)):r&&!a&&d<e.min?i.push(Lo(s.messages[c].min,e.fullField,e.min)):a&&!r&&d>e.max?i.push(Lo(s.messages[c].max,e.fullField,e.max)):r&&a&&(d<e.min||d>e.max)&&i.push(Lo(s.messages[c].range,e.fullField,e.min,e.max))},Ho="enum",Xo=function(e,t,o,i,s){e[Ho]=Array.isArray(e[Ho])?e[Ho]:[],-1===e[Ho].indexOf(t)&&i.push(Lo(s.messages[Ho],e.fullField,e[Ho].join(", ")))},qo=function(e,t,o,i,s){if(e.pattern)if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(t)||i.push(Lo(s.messages.pattern.mismatch,e.fullField,t,e.pattern));else if("string"===typeof e.pattern){var n=new RegExp(e.pattern);n.test(t)||i.push(Lo(s.messages.pattern.mismatch,e.fullField,t,e.pattern))}},Go={required:Wo,whitespace:Oo,type:Bo,range:Ko,enum:Xo,pattern:qo},Qo=function(e,t,o,i,s){var n=[],r=e.required||!e.required&&i.hasOwnProperty(e.field);if(r){if(Ro(t,"string")&&!e.required)return o();Go.required(e,t,i,n,s,"string"),Ro(t,"string")||(Go.type(e,t,i,n,s),Go.range(e,t,i,n,s),Go.pattern(e,t,i,n,s),!0===e.whitespace&&Go.whitespace(e,t,i,n,s))}o(n)},Jo=function(e,t,o,i,s){var n=[],r=e.required||!e.required&&i.hasOwnProperty(e.field);if(r){if(Ro(t)&&!e.required)return o();Go.required(e,t,i,n,s),void 0!==t&&Go.type(e,t,i,n,s)}o(n)},Yo=function(e,t,o,i,s){var n=[],r=e.required||!e.required&&i.hasOwnProperty(e.field);if(r){if(""===t&&(t=void 0),Ro(t)&&!e.required)return o();Go.required(e,t,i,n,s),void 0!==t&&(Go.type(e,t,i,n,s),Go.range(e,t,i,n,s))}o(n)},Zo=function(e,t,o,i,s){var n=[],r=e.required||!e.required&&i.hasOwnProperty(e.field);if(r){if(Ro(t)&&!e.required)return o();Go.required(e,t,i,n,s),void 0!==t&&Go.type(e,t,i,n,s)}o(n)},ei=function(e,t,o,i,s){var n=[],r=e.required||!e.required&&i.hasOwnProperty(e.field);if(r){if(Ro(t)&&!e.required)return o();Go.required(e,t,i,n,s),Ro(t)||Go.type(e,t,i,n,s)}o(n)},ti=function(e,t,o,i,s){var n=[],r=e.required||!e.required&&i.hasOwnProperty(e.field);if(r){if(Ro(t)&&!e.required)return o();Go.required(e,t,i,n,s),void 0!==t&&(Go.type(e,t,i,n,s),Go.range(e,t,i,n,s))}o(n)},oi=function(e,t,o,i,s){var n=[],r=e.required||!e.required&&i.hasOwnProperty(e.field);if(r){if(Ro(t)&&!e.required)return o();Go.required(e,t,i,n,s),void 0!==t&&(Go.type(e,t,i,n,s),Go.range(e,t,i,n,s))}o(n)},ii=function(e,t,o,i,s){var n=[],r=e.required||!e.required&&i.hasOwnProperty(e.field);if(r){if((void 0===t||null===t)&&!e.required)return o();Go.required(e,t,i,n,s,"array"),void 0!==t&&null!==t&&(Go.type(e,t,i,n,s),Go.range(e,t,i,n,s))}o(n)},si=function(e,t,o,i,s){var n=[],r=e.required||!e.required&&i.hasOwnProperty(e.field);if(r){if(Ro(t)&&!e.required)return o();Go.required(e,t,i,n,s),void 0!==t&&Go.type(e,t,i,n,s)}o(n)},ni="enum",ri=function(e,t,o,i,s){var n=[],r=e.required||!e.required&&i.hasOwnProperty(e.field);if(r){if(Ro(t)&&!e.required)return o();Go.required(e,t,i,n,s),void 0!==t&&Go[ni](e,t,i,n,s)}o(n)},ai=function(e,t,o,i,s){var n=[],r=e.required||!e.required&&i.hasOwnProperty(e.field);if(r){if(Ro(t,"string")&&!e.required)return o();Go.required(e,t,i,n,s),Ro(t,"string")||Go.pattern(e,t,i,n,s)}o(n)},li=function(e,t,o,i,s){var n=[],r=e.required||!e.required&&i.hasOwnProperty(e.field);if(r){if(Ro(t,"date")&&!e.required)return o();var a;if(Go.required(e,t,i,n,s),!Ro(t,"date"))a=t instanceof Date?t:new Date(t),Go.type(e,a,i,n,s),a&&Go.range(e,a.getTime(),i,n,s)}o(n)},di=function(e,t,o,i,s){var n=[],r=Array.isArray(t)?"array":typeof t;Go.required(e,t,i,n,s,r),o(n)},ci=function(e,t,o,i,s){var n=e.type,r=[],a=e.required||!e.required&&i.hasOwnProperty(e.field);if(a){if(Ro(t,n)&&!e.required)return o();Go.required(e,t,i,r,s,n),Ro(t,n)||Go.type(e,t,i,r,s)}o(r)},hi=function(e,t,o,i,s){var n=[],r=e.required||!e.required&&i.hasOwnProperty(e.field);if(r){if(Ro(t)&&!e.required)return o();Go.required(e,t,i,n,s)}o(n)},ui={string:Qo,method:Jo,number:Yo,boolean:Zo,regexp:ei,integer:ti,float:oi,array:ii,object:si,enum:ri,pattern:ai,date:li,url:ci,hex:ci,email:ci,required:di,any:hi};function pi(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var mi=pi(),fi=function(){function e(e){this.rules=null,this._messages=mi,this.define(e)}var t=e.prototype;return t.define=function(e){var t=this;if(!e)throw new Error("Cannot configure a schema with no rules");if("object"!==typeof e||Array.isArray(e))throw new Error("Rules must be an object");this.rules={},Object.keys(e).forEach(function(o){var i=e[o];t.rules[o]=Array.isArray(i)?i:[i]})},t.messages=function(e){return e&&(this._messages=_o(pi(),e)),this._messages},t.validate=function(t,o,i){var s=this;void 0===o&&(o={}),void 0===i&&(i=function(){});var n=t,r=o,a=i;if("function"===typeof r&&(a=r,r={}),!this.rules||0===Object.keys(this.rules).length)return a&&a(null,n),Promise.resolve(n);function l(e){var t=[],o={};function i(e){var o;Array.isArray(e)?t=(o=t).concat.apply(o,e):t.push(e)}for(var s=0;s<e.length;s++)i(e[s]);t.length?(o=Co(t),a(t,o)):a(null,n)}if(r.messages){var d=this.messages();d===mi&&(d=pi()),_o(d,r.messages),r.messages=d}else r.messages=this.messages();var c={},h=r.keys||Object.keys(this.rules);h.forEach(function(e){var o=s.rules[e],i=n[e];o.forEach(function(o){var r=o;"function"===typeof r.transform&&(n===t&&(n=fo({},n)),i=n[e]=r.transform(i)),r="function"===typeof r?{validator:r}:fo({},r),r.validator=s.getValidationMethod(r),r.validator&&(r.field=e,r.fullField=r.fullField||e,r.type=s.getType(r),c[e]=c[e]||[],c[e].push({rule:r,value:i,source:n,field:e}))})});var u={};return Do(c,r,function(t,o){var i,s=t.rule,a=("object"===s.type||"array"===s.type)&&("object"===typeof s.fields||"object"===typeof s.defaultField);function l(e,t){return fo({},t,{fullField:s.fullField+"."+e,fullFields:s.fullFields?[].concat(s.fullFields,[e]):[e]})}function d(i){void 0===i&&(i=[]);var d=Array.isArray(i)?i:[i];!r.suppressWarning&&d.length&&e.warning("async-validator:",d),d.length&&void 0!==s.message&&(d=[].concat(s.message));var c=d.map(No(s,n));if(r.first&&c.length)return u[s.field]=1,o(c);if(a){if(s.required&&!t.value)return void 0!==s.message?c=[].concat(s.message).map(No(s,n)):r.error&&(c=[r.error(s,Lo(r.messages.required,s.field))]),o(c);var h={};s.defaultField&&Object.keys(t.value).map(function(e){h[e]=s.defaultField}),h=fo({},h,t.rule.fields);var p={};Object.keys(h).forEach(function(e){var t=h[e],o=Array.isArray(t)?t:[t];p[e]=o.map(l.bind(null,e))});var m=new e(p);m.messages(r.messages),t.rule.options&&(t.rule.options.messages=r.messages,t.rule.options.error=r.error),m.validate(t.value,t.rule.options||r,function(e){var t=[];c&&c.length&&t.push.apply(t,c),e&&e.length&&t.push.apply(t,e),o(t.length?t:null)})}else o(c)}if(a=a&&(s.required||!s.required&&t.value),s.field=t.field,s.asyncValidator)i=s.asyncValidator(s,t.value,d,t.source,r);else if(s.validator){try{i=s.validator(s,t.value,d,t.source,r)}catch(lo){null==mo.error||mo.error(lo),r.suppressValidatorError||setTimeout(function(){throw lo},0),d(lo.message)}!0===i?d():!1===i?d("function"===typeof s.message?s.message(s.fullField||s.field):s.message||(s.fullField||s.field)+" fails"):i instanceof Array?d(i):i instanceof Error&&d(i.message)}i&&i.then&&i.then(function(){return d()},function(e){return d(e)})},function(e){l(e)},n)},t.getType=function(e){if(void 0===e.type&&e.pattern instanceof RegExp&&(e.type="pattern"),"function"!==typeof e.validator&&e.type&&!ui.hasOwnProperty(e.type))throw new Error(Lo("Unknown rule type %s",e.type));return e.type||"string"},t.getValidationMethod=function(e){if("function"===typeof e.validator)return e.validator;var t=Object.keys(e),o=t.indexOf("message");return-1!==o&&t.splice(o,1),1===t.length&&"required"===t[0]?ui.required:ui[this.getType(e)]||void 0},e}();fi.register=function(e,t){if("function"!==typeof t)throw new Error("Cannot register a validator by type, validator is not a function");ui[e]=t},fi.warning=So,fi.messages=mi,fi.validators=ui;var gi=o(11754);function vi(e,t){var o=-1,i=null==e?0:e.length;while(++o<i)if(!1===t(e[o],o,e))break;return e}var yi=vi,wi=o(52851),bi=o(52528);function ki(e,t,o,i){var s=!o;o||(o={});var n=-1,r=t.length;while(++n<r){var a=t[n],l=i?i(o[a],e[a],a,o,e):void 0;void 0===l&&(l=e[a]),s?(0,bi.A)(o,a,l):(0,wi.A)(o,a,l)}return o}var Ii=ki,Pi=o(9084);function Si(e,t){return e&&Ii(t,(0,Pi.A)(t),e)}var Ci=Si,Li=o(83607),Fi=o(23149),Ri=o(97271);function Ei(e){var t=[];if(null!=e)for(var o in Object(e))t.push(o);return t}var xi=Ei,ji=Object.prototype,$i=ji.hasOwnProperty;function Di(e){if(!(0,Fi.A)(e))return xi(e);var t=(0,Ri.A)(e),o=[];for(var i in e)("constructor"!=i||!t&&$i.call(e,i))&&o.push(i);return o}var Ti=Di,Mi=o(38446);function Ni(e){return(0,Mi.A)(e)?(0,Li.A)(e,!0):Ti(e)}var _i=Ni;function Ai(e,t){return e&&Ii(t,_i(t),e)}var Wi=Ai,Oi=o(41917),Vi="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ui=Vi&&"object"==typeof module&&module&&!module.nodeType&&module,zi=Ui&&Ui.exports===Vi,Bi=zi?Oi.A.Buffer:void 0,Ki=Bi?Bi.allocUnsafe:void 0;function Hi(e,t){if(t)return e.slice();var o=e.length,i=Ki?Ki(o):new e.constructor(o);return e.copy(i),i}var Xi=Hi;function qi(e,t){var o=-1,i=e.length;t||(t=Array(i));while(++o<i)t[o]=e[o];return t}var Gi=qi,Qi=o(88634);function Ji(e,t){return Ii(e,(0,Qi.A)(e),t)}var Yi=Ji,Zi=o(76912),es=o(40367),ts=(0,es.A)(Object.getPrototypeOf,Object),os=ts,is=o(13153),ss=Object.getOwnPropertySymbols,ns=ss?function(e){var t=[];while(e)(0,Zi.A)(t,(0,Qi.A)(e)),e=os(e);return t}:is.A,rs=ns;function as(e,t){return Ii(e,rs(e),t)}var ls=as,ds=o(19042),cs=o(33831);function hs(e){return(0,cs.A)(e,_i,rs)}var us=hs,ps=o(44906),ms=Object.prototype,fs=ms.hasOwnProperty;function gs(e){var t=e.length,o=new e.constructor(t);return t&&"string"==typeof e[0]&&fs.call(e,"index")&&(o.index=e.index,o.input=e.input),o}var vs=gs,ys=o(43988);function ws(e){var t=new e.constructor(e.byteLength);return new ys.A(t).set(new ys.A(e)),t}var bs=ws;function ks(e,t){var o=t?bs(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}var Is=ks,Ps=/\w*$/;function Ss(e){var t=new e.constructor(e.source,Ps.exec(e));return t.lastIndex=e.lastIndex,t}var Cs=Ss,Ls=o(241),Fs=Ls.A?Ls.A.prototype:void 0,Rs=Fs?Fs.valueOf:void 0;function Es(e){return Rs?Object(Rs.call(e)):{}}var xs=Es;function js(e,t){var o=t?bs(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}var $s=js,Ds="[object Boolean]",Ts="[object Date]",Ms="[object Map]",Ns="[object Number]",_s="[object RegExp]",As="[object Set]",Ws="[object String]",Os="[object Symbol]",Vs="[object ArrayBuffer]",Us="[object DataView]",zs="[object Float32Array]",Bs="[object Float64Array]",Ks="[object Int8Array]",Hs="[object Int16Array]",Xs="[object Int32Array]",qs="[object Uint8Array]",Gs="[object Uint8ClampedArray]",Qs="[object Uint16Array]",Js="[object Uint32Array]";function Ys(e,t,o){var i=e.constructor;switch(t){case Vs:return bs(e);case Ds:case Ts:return new i(+e);case Us:return Is(e,o);case zs:case Bs:case Ks:case Hs:case Xs:case qs:case Gs:case Qs:case Js:return $s(e,o);case Ms:return new i;case Ns:case Ws:return new i(e);case _s:return Cs(e);case As:return new i;case Os:return xs(e)}}var Zs=Ys,en=Object.create,tn=function(){function e(){}return function(t){if(!(0,Fi.A)(t))return{};if(en)return en(t);e.prototype=t;var o=new e;return e.prototype=void 0,o}}(),on=tn;function sn(e){return"function"!=typeof e.constructor||(0,Ri.A)(e)?{}:on(os(e))}var nn=sn,rn=o(92049),an=o(99912),ln=o(53098),dn="[object Map]";function cn(e){return(0,ln.A)(e)&&(0,ps.A)(e)==dn}var hn=cn,un=o(52789),pn=o(64841),mn=pn.A&&pn.A.isMap,fn=mn?(0,un.A)(mn):hn,gn=fn,vn="[object Set]";function yn(e){return(0,ln.A)(e)&&(0,ps.A)(e)==vn}var wn=yn,bn=pn.A&&pn.A.isSet,kn=bn?(0,un.A)(bn):wn,In=kn,Pn=1,Sn=2,Cn=4,Ln="[object Arguments]",Fn="[object Array]",Rn="[object Boolean]",En="[object Date]",xn="[object Error]",jn="[object Function]",$n="[object GeneratorFunction]",Dn="[object Map]",Tn="[object Number]",Mn="[object Object]",Nn="[object RegExp]",_n="[object Set]",An="[object String]",Wn="[object Symbol]",On="[object WeakMap]",Vn="[object ArrayBuffer]",Un="[object DataView]",zn="[object Float32Array]",Bn="[object Float64Array]",Kn="[object Int8Array]",Hn="[object Int16Array]",Xn="[object Int32Array]",qn="[object Uint8Array]",Gn="[object Uint8ClampedArray]",Qn="[object Uint16Array]",Jn="[object Uint32Array]",Yn={};function Zn(e,t,o,i,s,n){var r,a=t&Pn,l=t&Sn,d=t&Cn;if(o&&(r=s?o(e,i,s,n):o(e)),void 0!==r)return r;if(!(0,Fi.A)(e))return e;var c=(0,rn.A)(e);if(c){if(r=vs(e),!a)return Gi(e,r)}else{var h=(0,ps.A)(e),u=h==jn||h==$n;if((0,an.A)(e))return Xi(e,a);if(h==Mn||h==Ln||u&&!s){if(r=l||u?{}:nn(e),!a)return l?ls(e,Wi(r,e)):Yi(e,Ci(r,e))}else{if(!Yn[h])return s?e:{};r=Zs(e,h,a)}}n||(n=new gi.A);var p=n.get(e);if(p)return p;n.set(e,r),In(e)?e.forEach(function(i){r.add(Zn(i,t,o,i,e,n))}):gn(e)&&e.forEach(function(i,s){r.set(s,Zn(i,t,o,s,e,n))});var m=d?l?us:ds.A:l?_i:Pi.A,f=c?void 0:m(e);return yi(f||e,function(i,s){f&&(s=i,i=e[s]),(0,wi.A)(r,s,Zn(i,t,o,s,e,n))}),r}Yn[Ln]=Yn[Fn]=Yn[Vn]=Yn[Un]=Yn[Rn]=Yn[En]=Yn[zn]=Yn[Bn]=Yn[Kn]=Yn[Hn]=Yn[Xn]=Yn[Dn]=Yn[Tn]=Yn[Mn]=Yn[Nn]=Yn[_n]=Yn[An]=Yn[Wn]=Yn[qn]=Yn[Gn]=Yn[Qn]=Yn[Jn]=!0,Yn[xn]=Yn[jn]=Yn[On]=!1;var er=Zn,tr=4;function or(e){return er(e,tr)}var ir=or,sr=o(52307);const nr=["","error","validating","success"],rr=(0,zt.b_)({label:String,labelWidth:{type:[String,Number],default:""},labelPosition:{type:String,values:["left","right","top",""],default:""},prop:{type:(0,zt.jq)([String,Array])},required:{type:Boolean,default:void 0},rules:{type:(0,zt.jq)([Object,Array])},error:String,validateStatus:{type:String,values:nr},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:Zt.I}});var ar=o(97786);const lr="ElLabelWrap";var dr=(0,i.pM)({name:lr,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(e,{slots:t}){const o=(0,i.WQ)(Yt.F,void 0),s=(0,i.WQ)(Yt.w);s||(0,lo.$)(lr,"usage: <el-form-item><label-wrap /></el-form-item>");const n=(0,Ht.DU)("form"),r=(0,Ut.KR)(),a=(0,Ut.KR)(0),l=()=>{var e;if(null==(e=r.value)?void 0:e.firstElementChild){const e=window.getComputedStyle(r.value.firstElementChild).width;return Math.ceil(Number.parseFloat(e))}return 0},d=(s="update")=>{(0,i.dY)(()=>{t.default&&e.isAutoWidth&&("update"===s?a.value=l():"remove"===s&&(null==o||o.deregisterLabelWidth(a.value)))})},c=()=>d("update");return(0,i.sV)(()=>{c()}),(0,i.xo)(()=>{d("remove")}),(0,i.$u)(()=>c()),(0,i.wB)(a,(t,i)=>{e.updateAll&&(null==o||o.registerLabelWidth(t,i))}),(0,ar.wYm)((0,i.EW)(()=>{var e,t;return null!=(t=null==(e=r.value)?void 0:e.firstElementChild)?t:null}),c),()=>{var l,d;if(!t)return null;const{isAutoWidth:c}=e;if(c){const e=null==o?void 0:o.autoLabelWidth,d=null==s?void 0:s.hasLabel,c={};if(d&&e&&"auto"!==e){const t=Math.max(0,Number.parseInt(e,10)-a.value),i=s.labelPosition||o.labelPosition,n="left"===i?"marginRight":"marginLeft";t&&(c[n]=`${t}px`)}return(0,i.bF)("div",{ref:r,class:[n.be("item","label-wrap")],style:c},[null==(l=t.default)?void 0:l.call(t)])}return(0,i.bF)(i.FK,{ref:r},[null==(d=t.default)?void 0:d.call(t)])}}}),cr=o(77010),hr=o(55158),ur=o(76031),pr=o(96763);const mr=(0,i.pM)({name:"ElFormItem"}),fr=(0,i.pM)({...mr,props:rr,setup(e,{expose:t}){const o=e,r=(0,i.Ht)(),a=(0,i.WQ)(Yt.F,void 0),l=(0,i.WQ)(Yt.w,void 0),d=(0,ao.NV)(void 0,{formItem:!1}),c=(0,Ht.DU)("form-item"),h=(0,cr.Bi)().value,u=(0,Ut.KR)([]),p=(0,Ut.KR)(""),m=(0,sr.V7)(p,100),f=(0,Ut.KR)(""),g=(0,Ut.KR)();let v,y=!1;const w=(0,i.EW)(()=>o.labelPosition||(null==a?void 0:a.labelPosition)),b=(0,i.EW)(()=>{if("top"===w.value)return{};const e=(0,ur._V)(o.labelWidth||(null==a?void 0:a.labelWidth)||"");return e?{width:e}:{}}),k=(0,i.EW)(()=>{if("top"===w.value||(null==a?void 0:a.inline))return{};if(!o.label&&!o.labelWidth&&E)return{};const e=(0,ur._V)(o.labelWidth||(null==a?void 0:a.labelWidth)||"");return o.label||r.label?{}:{marginLeft:e}}),I=(0,i.EW)(()=>[c.b(),c.m(d.value),c.is("error","error"===p.value),c.is("validating","validating"===p.value),c.is("success","success"===p.value),c.is("required",T.value||o.required),c.is("no-asterisk",null==a?void 0:a.hideRequiredAsterisk),"right"===(null==a?void 0:a.requireAsteriskPosition)?"asterisk-right":"asterisk-left",{[c.m("feedback")]:null==a?void 0:a.statusIcon,[c.m(`label-${w.value}`)]:w.value}]),P=(0,i.EW)(()=>(0,eo.Lm)(o.inlineMessage)?o.inlineMessage:(null==a?void 0:a.inlineMessage)||!1),S=(0,i.EW)(()=>[c.e("error"),{[c.em("error","inline")]:P.value}]),C=(0,i.EW)(()=>o.prop?(0,n.cy)(o.prop)?o.prop.join("."):o.prop:""),L=(0,i.EW)(()=>!(!o.label&&!r.label)),F=(0,i.EW)(()=>{var e;return null!=(e=o.for)?e:1===u.value.length?u.value[0]:void 0}),R=(0,i.EW)(()=>!F.value&&L.value),E=!!l,x=(0,i.EW)(()=>{const e=null==a?void 0:a.model;if(e&&o.prop)return(0,hr.GT)(e,o.prop).value}),j=(0,i.EW)(()=>{const{required:e}=o,t=[];o.rules&&t.push(...(0,so.A)(o.rules));const i=null==a?void 0:a.rules;if(i&&o.prop){const e=(0,hr.GT)(i,o.prop).value;e&&t.push(...(0,so.A)(e))}if(void 0!==e){const o=t.map((e,t)=>[e,t]).filter(([e])=>Object.keys(e).includes("required"));if(o.length>0)for(const[i,s]of o)i.required!==e&&(t[s]={...i,required:e});else t.push({required:e})}return t}),$=(0,i.EW)(()=>j.value.length>0),D=e=>{const t=j.value;return t.filter(t=>!t.trigger||!e||((0,n.cy)(t.trigger)?t.trigger.includes(e):t.trigger===e)).map(({trigger:e,...t})=>t)},T=(0,i.EW)(()=>j.value.some(e=>e.required)),M=(0,i.EW)(()=>{var e;return"error"===m.value&&o.showMessage&&(null==(e=null==a?void 0:a.showMessage)||e)}),N=(0,i.EW)(()=>`${o.label||""}${(null==a?void 0:a.labelSuffix)||""}`),_=e=>{p.value=e},A=e=>{var t,i;const{errors:s,fields:n}=e;s&&n||pr.error(e),_("error"),f.value=s?null!=(i=null==(t=null==s?void 0:s[0])?void 0:t.message)?i:`${o.prop} is required`:"",null==a||a.emit("validate",o.prop,!1,f.value)},W=()=>{_("success"),null==a||a.emit("validate",o.prop,!0,"")},O=async e=>{const t=C.value,o=new fi({[t]:e});return o.validate({[t]:x.value},{firstFields:!0}).then(()=>(W(),!0)).catch(e=>(A(e),Promise.reject(e)))},V=async(e,t)=>{if(y||!o.prop)return!1;const i=(0,n.Tn)(t);if(!$.value)return null==t||t(!1),!1;const s=D(e);return 0===s.length?(null==t||t(!0),!0):(_("validating"),O(s).then(()=>(null==t||t(!0),!0)).catch(e=>{const{fields:o}=e;return null==t||t(!1,o),!i&&Promise.reject(o)}))},U=()=>{_(""),f.value="",y=!1},z=async()=>{const e=null==a?void 0:a.model;if(!e||!o.prop)return;const t=(0,hr.GT)(e,o.prop);y=!0,t.value=ir(v),await(0,i.dY)(),U(),y=!1},B=e=>{u.value.includes(e)||u.value.push(e)},K=e=>{u.value=u.value.filter(t=>t!==e)};(0,i.wB)(()=>o.error,e=>{f.value=e||"",_(e?"error":"")},{immediate:!0}),(0,i.wB)(()=>o.validateStatus,e=>_(e||""));const H=(0,Ut.Kh)({...(0,Ut.QW)(o),$el:g,size:d,validateMessage:f,validateState:p,labelId:h,inputIds:u,isGroup:R,hasLabel:L,fieldValue:x,addInputId:B,removeInputId:K,resetField:z,clearValidate:U,validate:V,propString:C});return(0,i.Gt)(Yt.w,H),(0,i.sV)(()=>{o.prop&&(null==a||a.addField(H),v=ir(x.value))}),(0,i.xo)(()=>{null==a||a.removeField(H)}),t({size:d,validateMessage:f,validateState:p,validate:V,clearValidate:U,resetField:z}),(e,t)=>{var o;return(0,i.uX)(),(0,i.CE)("div",{ref_key:"formItemRef",ref:g,class:(0,n.C4)((0,Ut.R1)(I)),role:(0,Ut.R1)(R)?"group":void 0,"aria-labelledby":(0,Ut.R1)(R)?(0,Ut.R1)(h):void 0},[(0,i.bF)((0,Ut.R1)(dr),{"is-auto-width":"auto"===(0,Ut.R1)(b).width,"update-all":"auto"===(null==(o=(0,Ut.R1)(a))?void 0:o.labelWidth)},{default:(0,i.k6)(()=>[(0,Ut.R1)(L)?((0,i.uX)(),(0,i.Wv)((0,i.$y)((0,Ut.R1)(F)?"label":"div"),{key:0,id:(0,Ut.R1)(h),for:(0,Ut.R1)(F),class:(0,n.C4)((0,Ut.R1)(c).e("label")),style:(0,n.Tr)((0,Ut.R1)(b))},{default:(0,i.k6)(()=>[(0,i.RG)(e.$slots,"label",{label:(0,Ut.R1)(N)},()=>[(0,i.eW)((0,n.v_)((0,Ut.R1)(N)),1)])]),_:3},8,["id","for","class","style"])):(0,i.Q3)("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),(0,i.Lk)("div",{class:(0,n.C4)((0,Ut.R1)(c).e("content")),style:(0,n.Tr)((0,Ut.R1)(k))},[(0,i.RG)(e.$slots,"default"),(0,i.bF)(s.F,{name:`${(0,Ut.R1)(c).namespace.value}-zoom-in-top`},{default:(0,i.k6)(()=>[(0,Ut.R1)(M)?(0,i.RG)(e.$slots,"error",{key:0,error:f.value},()=>[(0,i.Lk)("div",{class:(0,n.C4)((0,Ut.R1)(S))},(0,n.v_)(f.value),3)]):(0,i.Q3)("v-if",!0)]),_:3},8,["name"])],6)],10,["role","aria-labelledby"])}}});var gr=(0,Kt.A)(fr,[["__file","form-item.vue"]]);const vr=(0,Qt.GU)(po,{FormItem:gr}),yr=(0,Qt.WM)(gr);var wr=o(50069);const br={class:"tab-navigation"},kr=["onClick"],Ir={class:"tab-content"},Pr={key:0,class:"profile-section"},Sr={class:"user-info"},Cr={class:"info-row"},Lr={class:"info-row"},Fr={class:"info-row"},Rr={class:"info-row"},Er={class:"session-id"},xr={key:1,class:"password-section"},jr={class:"form-actions"},$r={key:2,class:"forgot-section"},Dr={class:"form-actions"},Tr={class:"admin-contact"},Mr={class:"contact-section"},Nr={class:"admin-info"},_r={class:"contact-method"},Ar={class:"contact-method"},Wr={class:"dialog-footer"};function Or(e,t,o,s,r,a){const l=wr.WK,d=yr,c=L.S2,h=vr,u=Jt,p=(0,i.g2)("Mail"),m=(0,i.g2)("MessageSquare"),f=(0,i.g2)("LogOut"),g=C.kZ;return(0,i.uX)(),(0,i.Wv)(g,{modelValue:a.visible,"onUpdate:modelValue":t[6]||(t[6]=e=>a.visible=e),title:o.currentUser?`${o.currentUser.full_name||o.currentUser.username}`:"User Profile",width:"450px","before-close":a.handleClose,"close-on-click-modal":!1,"close-on-press-escape":!0,class:"user-profile-modal"},{footer:(0,i.k6)(()=>[(0,i.Lk)("div",Wr,["profile"===r.activeTab?((0,i.uX)(),(0,i.Wv)(c,{key:0,type:"danger",onClick:a.handleLogout},{default:(0,i.k6)(()=>[(0,i.bF)(f,{size:16}),t[23]||(t[23]=(0,i.eW)(" Logout ",-1))]),_:1,__:[23]},8,["onClick"])):(0,i.Q3)("",!0),(0,i.bF)(c,{onClick:a.handleClose},{default:(0,i.k6)(()=>t[24]||(t[24]=[(0,i.eW)("Close",-1)])),_:1,__:[24]},8,["onClick"])])]),default:(0,i.k6)(()=>[(0,i.Lk)("div",br,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.tabs,e=>((0,i.uX)(),(0,i.CE)("button",{key:e.id,onClick:t=>r.activeTab=e.id,class:(0,n.C4)(["tab-btn",{active:r.activeTab===e.id}])},[((0,i.uX)(),(0,i.Wv)((0,i.$y)(e.icon),{size:16})),(0,i.eW)(" "+(0,n.v_)(e.label),1)],10,kr))),128))]),(0,i.Lk)("div",Ir,["profile"===r.activeTab?((0,i.uX)(),(0,i.CE)("div",Pr,[(0,i.Lk)("div",Sr,[(0,i.Lk)("div",Cr,[t[7]||(t[7]=(0,i.Lk)("label",null,"Username:",-1)),(0,i.Lk)("span",null,(0,n.v_)(o.currentUser?.username),1)]),(0,i.Lk)("div",Lr,[t[8]||(t[8]=(0,i.Lk)("label",null,"Full Name:",-1)),(0,i.Lk)("span",null,(0,n.v_)(o.currentUser?.full_name||"Not set"),1)]),(0,i.Lk)("div",Fr,[t[9]||(t[9]=(0,i.Lk)("label",null,"Role:",-1)),(0,i.Lk)("span",{class:(0,n.C4)(["role-badge",o.currentUser?.role])},(0,n.v_)("professor"===o.currentUser?.role?"Professor":"Student"),3)]),(0,i.Lk)("div",Rr,[t[10]||(t[10]=(0,i.Lk)("label",null,"Session:",-1)),(0,i.Lk)("span",Er,(0,n.v_)(r.sessionId?.substring(0,20))+"...",1)])])])):(0,i.Q3)("",!0),"change-password"===r.activeTab?((0,i.uX)(),(0,i.CE)("div",xr,[(0,i.bF)(h,{ref:"changePasswordForm",model:r.passwordForm,rules:r.passwordRules,"label-position":"top"},{default:(0,i.k6)(()=>[(0,i.bF)(d,{label:"Current Password",prop:"currentPassword"},{default:(0,i.k6)(()=>[(0,i.bF)(l,{modelValue:r.passwordForm.currentPassword,"onUpdate:modelValue":t[0]||(t[0]=e=>r.passwordForm.currentPassword=e),type:"password",placeholder:"Enter your current password","show-password":""},null,8,["modelValue"])]),_:1}),(0,i.bF)(d,{label:"New Password",prop:"newPassword"},{default:(0,i.k6)(()=>[(0,i.bF)(l,{modelValue:r.passwordForm.newPassword,"onUpdate:modelValue":t[1]||(t[1]=e=>r.passwordForm.newPassword=e),type:"password",placeholder:"Enter new password (min 6 characters)","show-password":""},null,8,["modelValue"])]),_:1}),(0,i.bF)(d,{label:"Confirm New Password",prop:"confirmPassword"},{default:(0,i.k6)(()=>[(0,i.bF)(l,{modelValue:r.passwordForm.confirmPassword,"onUpdate:modelValue":t[2]||(t[2]=e=>r.passwordForm.confirmPassword=e),type:"password",placeholder:"Confirm new password","show-password":""},null,8,["modelValue"])]),_:1}),(0,i.Lk)("div",jr,[(0,i.bF)(c,{type:"primary",onClick:a.changePassword,loading:r.loading},{default:(0,i.k6)(()=>t[11]||(t[11]=[(0,i.eW)(" Change Password ",-1)])),_:1,__:[11]},8,["onClick","loading"]),(0,i.bF)(c,{onClick:a.resetPasswordForm},{default:(0,i.k6)(()=>t[12]||(t[12]=[(0,i.eW)("Reset",-1)])),_:1,__:[12]},8,["onClick"])])]),_:1},8,["model","rules"])])):(0,i.Q3)("",!0),"forgot-password"===r.activeTab?((0,i.uX)(),(0,i.CE)("div",$r,[t[22]||(t[22]=(0,i.Lk)("div",{class:"forgot-info"},[(0,i.Lk)("p",null,"To reset your password, you need to verify your current password first."),(0,i.Lk)("p",null,"If you don't remember your current password, please contact the administrator.")],-1)),(0,i.bF)(h,{ref:"forgotPasswordForm",model:r.forgotForm,rules:r.forgotRules,"label-position":"top"},{default:(0,i.k6)(()=>[(0,i.bF)(d,{label:"Current Password",prop:"currentPassword"},{default:(0,i.k6)(()=>[(0,i.bF)(l,{modelValue:r.forgotForm.currentPassword,"onUpdate:modelValue":t[3]||(t[3]=e=>r.forgotForm.currentPassword=e),type:"password",placeholder:"Enter your current password to verify","show-password":""},null,8,["modelValue"])]),_:1}),(0,i.bF)(d,{label:"New Password",prop:"newPassword"},{default:(0,i.k6)(()=>[(0,i.bF)(l,{modelValue:r.forgotForm.newPassword,"onUpdate:modelValue":t[4]||(t[4]=e=>r.forgotForm.newPassword=e),type:"password",placeholder:"Enter new password (min 6 characters)","show-password":"",disabled:!r.passwordVerified},null,8,["modelValue","disabled"])]),_:1}),(0,i.bF)(d,{label:"Confirm New Password",prop:"confirmPassword"},{default:(0,i.k6)(()=>[(0,i.bF)(l,{modelValue:r.forgotForm.confirmPassword,"onUpdate:modelValue":t[5]||(t[5]=e=>r.forgotForm.confirmPassword=e),type:"password",placeholder:"Confirm new password","show-password":"",disabled:!r.passwordVerified},null,8,["modelValue","disabled"])]),_:1}),(0,i.Lk)("div",Dr,[r.passwordVerified?((0,i.uX)(),(0,i.Wv)(c,{key:1,type:"success",onClick:a.resetPasswordWithVerification,loading:r.loading},{default:(0,i.k6)(()=>t[14]||(t[14]=[(0,i.eW)(" Reset Password ",-1)])),_:1,__:[14]},8,["onClick","loading"])):((0,i.uX)(),(0,i.Wv)(c,{key:0,type:"primary",onClick:a.verifyCurrentPassword,loading:r.loading},{default:(0,i.k6)(()=>t[13]||(t[13]=[(0,i.eW)(" Verify Password ",-1)])),_:1,__:[13]},8,["onClick","loading"])),(0,i.bF)(c,{onClick:a.resetForgotForm},{default:(0,i.k6)(()=>t[15]||(t[15]=[(0,i.eW)("Clear",-1)])),_:1,__:[15]},8,["onClick"])])]),_:1},8,["model","rules"]),(0,i.Lk)("div",Tr,[(0,i.bF)(u,null,{default:(0,i.k6)(()=>t[16]||(t[16]=[(0,i.eW)("OR",-1)])),_:1,__:[16]}),(0,i.Lk)("div",Mr,[t[19]||(t[19]=(0,i.Lk)("h4",null,"Contact Administrator",-1)),t[20]||(t[20]=(0,i.Lk)("p",null,"If you cannot remember your current password, please contact the admin:",-1)),(0,i.Lk)("div",Nr,[(0,i.Lk)("div",_r,[(0,i.bF)(p,{size:16}),t[17]||(t[17]=(0,i.Lk)("span",{class:"admin-email"},"sa9082@nyu.edu",-1))]),(0,i.Lk)("div",Ar,[(0,i.bF)(m,{size:16}),(0,i.Lk)("span",null,[t[18]||(t[18]=(0,i.eW)("Include your username: ",-1)),(0,i.Lk)("strong",null,(0,n.v_)(o.currentUser?.username),1)])])]),t[21]||(t[21]=(0,i.Lk)("p",{class:"contact-note"}," Please send an email from your Gmail account with your username and request for password reset. ",-1))])])])):(0,i.Q3)("",!0)])]),_:1},8,["modelValue","title","before-close"])}
/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Vr=(0,xt.A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Ur=(0,xt.A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),zr=(0,xt.A)("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Br=(0,xt.A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),Kr=(0,xt.A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),Hr=(0,xt.A)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);var Xr=o(96763),qr={name:"UserProfileModal",props:{modelValue:{type:Boolean,default:!1},currentUser:{type:Object,default:null}},emits:["update:modelValue","logout","password-changed"],components:{User:Vr,Lock:Ur,HelpCircle:zr,LogOut:Br,Mail:Kr,MessageSquare:Hr},data(){const e=(e,t,o)=>{""===t?o(new Error("Please confirm your password")):t!==this.passwordForm.newPassword&&t!==this.forgotForm.newPassword?o(new Error("Passwords do not match")):o()};return{activeTab:"profile",loading:!1,passwordVerified:!1,sessionId:localStorage.getItem("session_id"),tabs:[{id:"profile",label:"Profile",icon:"User"},{id:"change-password",label:"Change Password",icon:"Lock"},{id:"forgot-password",label:"Forgot Password",icon:"HelpCircle"}],passwordForm:{currentPassword:"",newPassword:"",confirmPassword:""},forgotForm:{currentPassword:"",newPassword:"",confirmPassword:""},passwordRules:{currentPassword:[{required:!0,message:"Please enter your current password",trigger:"blur"}],newPassword:[{required:!0,message:"Please enter a new password",trigger:"blur"},{min:6,message:"Password must be at least 6 characters",trigger:"blur"}],confirmPassword:[{required:!0,message:"Please confirm your password",trigger:"blur"},{validator:e,trigger:"blur"}]},forgotRules:{currentPassword:[{required:!0,message:"Please enter your current password",trigger:"blur"}],newPassword:[{required:!0,message:"Please enter a new password",trigger:"blur"},{min:6,message:"Password must be at least 6 characters",trigger:"blur"}],confirmPassword:[{required:!0,message:"Please confirm your password",trigger:"blur"},{validator:e,trigger:"blur"}]}}},computed:{visible:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},methods:{handleClose(){this.visible=!1,this.resetAllForms()},async handleLogout(){try{const e=await fetch("/api/logout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:this.sessionId})}),t=await e.json();t.success?(localStorage.removeItem("session_id"),localStorage.removeItem("username"),localStorage.removeItem("role"),localStorage.removeItem("full_name"),ye.nk.success("Logged out successfully"),this.handleClose(),this.$emit("logout"),setTimeout(()=>{window.location.reload()},1e3)):ye.nk.error("Logout failed. Please try again.")}catch(lo){Xr.error("Logout error:",lo),ye.nk.error("Network error during logout")}},async changePassword(){this.$refs.changePasswordForm.validate(async e=>{if(e){this.loading=!0;try{const e=await fetch("/api/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:this.sessionId,old_password:this.passwordForm.currentPassword,new_password:this.passwordForm.newPassword})}),t=await e.json();t.success?(ye.nk.success("Password changed successfully!"),this.$emit("password-changed"),this.resetPasswordForm(),this.activeTab="profile"):ye.nk.error(t.error||"Failed to change password")}catch(lo){ye.nk.error("Network error. Please try again.")}finally{this.loading=!1}}})},async verifyCurrentPassword(){if(this.forgotForm.currentPassword){this.loading=!0;try{const e=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.currentUser.username,password:this.forgotForm.currentPassword})}),t=await e.json();t.success?(this.passwordVerified=!0,ye.nk.success("Password verified! Now enter your new password.")):ye.nk.error("Incorrect password. Please try again.")}catch(lo){ye.nk.error("Network error. Please try again.")}finally{this.loading=!1}}else ye.nk.warning("Please enter your current password")},async resetPasswordWithVerification(){this.$refs.forgotPasswordForm.validate(async e=>{if(e&&this.passwordVerified){this.loading=!0;try{const e=await fetch("/api/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:this.sessionId,old_password:this.forgotForm.currentPassword,new_password:this.forgotForm.newPassword})}),t=await e.json();t.success?(ye.nk.success("Password reset successfully!"),this.$emit("password-changed"),this.resetForgotForm(),this.activeTab="profile"):ye.nk.error(t.error||"Failed to reset password")}catch(lo){ye.nk.error("Network error. Please try again.")}finally{this.loading=!1}}})},resetPasswordForm(){this.passwordForm={currentPassword:"",newPassword:"",confirmPassword:""},this.$refs.changePasswordForm?.clearValidate()},resetForgotForm(){this.forgotForm={currentPassword:"",newPassword:"",confirmPassword:""},this.passwordVerified=!1,this.$refs.forgotPasswordForm?.clearValidate()},resetAllForms(){this.resetPasswordForm(),this.resetForgotForm(),this.activeTab="profile"}}};const Gr=(0,k.A)(qr,[["render",Or],["__scopeId","data-v-33954960"]]);var Qr=Gr;o(20116);const Jr={class:"two-header-container"},Yr={class:"header-first"},Zr={class:"nav-menu"},ea={class:"nav__items-left"},ta={class:"nav__item"},oa=["aria-expanded"],ia={class:"nav__dropdown-item"},sa={class:"nav__dropdown-item"},na={class:"nav__dropdown-item"},ra=["disabled"],aa={class:"nav__dropdown-item"},la={class:"nav__dropdown-item"},da=["disabled"],ca={class:"nav__dropdown-item"},ha={class:"nav__dropdown-item"},ua=["disabled"],pa={class:"nav__dropdown-item"},ma={class:"nav__dropdown-item"},fa=["disabled"],ga={class:"nav__item"},va=["aria-expanded"],ya={class:"nav__dropdown-item"},wa={class:"nav__dropdown-item"},ba={class:"nav__dropdown-item"},ka={class:"nav__dropdown-item"},Ia={class:"nav__dropdown-item"},Pa={class:"nav__dropdown-item"},Sa={class:"nav__dropdown-item"},Ca={class:"nav__dropdown-item"},La={class:"nav__item"},Fa=["aria-expanded"],Ra={class:"nav__dropdown-item"},Ea={class:"nav__dropdown-item"},xa={class:"nav__dropdown-item"},ja={class:"nav__item"},$a=["aria-expanded"],Da={class:"nav__dropdown-item"},Ta={class:"nav__dropdown-item"},Ma={class:"nav__dropdown-item"},Na={class:"nav__item"},_a=["aria-expanded"],Aa={class:"nav__dropdown-item"},Wa={class:"header-right-section"},Oa={class:"header-second"},Va={class:"header-second-center-container"},Ua=["title"],za={class:"header-second-right"};function Ba(e,t,o,r,a,l){const d=(0,i.g2)("UserCircle"),c=(0,i.g2)("Play"),h=(0,i.g2)("Square"),u=(0,i.g2)("Trash2"),p=(0,i.g2)("Share2"),m=(0,i.g2)("Settings"),f=Qr;return(0,i.uX)(),(0,i.CE)("div",Jr,[(0,i.Lk)("div",Yr,[(0,i.Lk)("nav",Zr,[(0,i.Lk)("ul",ea,[(0,i.Lk)("li",ta,[(0,i.Lk)("button",{class:"nav__item-button",onClick:t[0]||(t[0]=(0,s.D$)(e=>l.toggleDropdown("file"),["stop"])),"aria-haspopup":"menu","aria-expanded":"file"===a.activeDropdown},t[42]||(t[42]=[(0,i.Lk)("span",{class:"nav__item-header"},"File",-1),(0,i.Lk)("svg",{class:"nav__item-triangle",width:"9",height:"6",viewBox:"0 0 9 6",xmlns:"http://www.w3.org/2000/svg"},[(0,i.Lk)("polygon",{points:"4.5 6 9 0 0 0",fill:"currentColor"})],-1)]),8,oa),(0,i.bo)((0,i.Lk)("ul",{class:"nav__dropdown",onClick:t[10]||(t[10]=(0,s.D$)(()=>{},["stop"]))},[(0,i.Lk)("li",ia,[(0,i.Lk)("button",{onClick:t[1]||(t[1]=e=>l.newFile())},t[43]||(t[43]=[(0,i.Lk)("span",null,"New File",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+Alt+N",-1)]))]),(0,i.Lk)("li",sa,[(0,i.Lk)("button",{onClick:t[2]||(t[2]=e=>l.openFile())},t[44]||(t[44]=[(0,i.Lk)("span",null,"Open File",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+O",-1)]))]),(0,i.Lk)("li",na,[(0,i.Lk)("button",{onClick:t[3]||(t[3]=e=>l.duplicateFile()),disabled:!l.hasSelectedFile},t[45]||(t[45]=[(0,i.Lk)("span",null,"Duplicate (Make a copy)",-1)]),8,ra)]),(0,i.Lk)("li",aa,[(0,i.Lk)("button",{onClick:t[4]||(t[4]=e=>l.saveFile())},t[46]||(t[46]=[(0,i.Lk)("span",null,"Save",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+S",-1)]))]),(0,i.Lk)("li",la,[(0,i.Lk)("button",{onClick:t[5]||(t[5]=e=>l.saveAsFile()),disabled:!l.canSaveAsFile},t[47]||(t[47]=[(0,i.Lk)("span",null,"Save As",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+Shift+S",-1)]),8,da)]),(0,i.Lk)("li",ca,[(0,i.Lk)("button",{onClick:t[6]||(t[6]=e=>l.shareFile())},t[48]||(t[48]=[(0,i.Lk)("span",null,"Share",-1)]))]),(0,i.Lk)("li",ha,[(0,i.Lk)("button",{onClick:t[7]||(t[7]=e=>l.moveFile()),disabled:!l.hasSelectedFile},t[49]||(t[49]=[(0,i.Lk)("span",null,"Move",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+Shift+M",-1)]),8,ua)]),(0,i.Lk)("li",pa,[(0,i.Lk)("button",{onClick:t[8]||(t[8]=e=>l.downloadFile())},t[50]||(t[50]=[(0,i.Lk)("span",null,"Download",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+D",-1)]))]),(0,i.Lk)("li",ma,[(0,i.Lk)("button",{onClick:t[9]||(t[9]=e=>l.deleteFile()),disabled:!l.hasSelectedFile,class:"delete-option"},t[51]||(t[51]=[(0,i.Lk)("span",null,"Delete File",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Delete",-1)]),8,fa)])],512),[[s.aG,"file"===a.activeDropdown]])]),(0,i.Lk)("li",ga,[(0,i.Lk)("button",{class:"nav__item-button",onClick:t[11]||(t[11]=(0,s.D$)(e=>l.toggleDropdown("edit"),["stop"])),"aria-haspopup":"menu","aria-expanded":"edit"===a.activeDropdown},t[52]||(t[52]=[(0,i.Lk)("span",{class:"nav__item-header"},"Edit",-1),(0,i.Lk)("svg",{class:"nav__item-triangle",width:"9",height:"6",viewBox:"0 0 9 6",xmlns:"http://www.w3.org/2000/svg"},[(0,i.Lk)("polygon",{points:"4.5 6 9 0 0 0",fill:"currentColor"})],-1)]),8,va),(0,i.bo)((0,i.Lk)("ul",{class:"nav__dropdown",onClick:t[20]||(t[20]=(0,s.D$)(()=>{},["stop"]))},[(0,i.Lk)("li",ya,[(0,i.Lk)("button",{onClick:t[12]||(t[12]=e=>l.undo())},t[53]||(t[53]=[(0,i.Lk)("span",null,"Undo",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+Z",-1)]))]),(0,i.Lk)("li",wa,[(0,i.Lk)("button",{onClick:t[13]||(t[13]=e=>l.redo())},t[54]||(t[54]=[(0,i.Lk)("span",null,"Redo",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+Y",-1)]))]),t[61]||(t[61]=(0,i.Lk)("li",{class:"nav__dropdown-divider"},null,-1)),(0,i.Lk)("li",ba,[(0,i.Lk)("button",{onClick:t[14]||(t[14]=e=>l.cut())},t[55]||(t[55]=[(0,i.Lk)("span",null,"Cut",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+X",-1)]))]),(0,i.Lk)("li",ka,[(0,i.Lk)("button",{onClick:t[15]||(t[15]=e=>l.copy())},t[56]||(t[56]=[(0,i.Lk)("span",null,"Copy",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+C",-1)]))]),(0,i.Lk)("li",Ia,[(0,i.Lk)("button",{onClick:t[16]||(t[16]=e=>l.paste())},t[57]||(t[57]=[(0,i.Lk)("span",null,"Paste",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+V",-1)]))]),t[62]||(t[62]=(0,i.Lk)("li",{class:"nav__dropdown-divider"},null,-1)),(0,i.Lk)("li",Pa,[(0,i.Lk)("button",{onClick:t[17]||(t[17]=e=>l.find())},t[58]||(t[58]=[(0,i.Lk)("span",null,"Find",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+F",-1)]))]),(0,i.Lk)("li",Sa,[(0,i.Lk)("button",{onClick:t[18]||(t[18]=e=>l.replace())},t[59]||(t[59]=[(0,i.Lk)("span",null,"Replace",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+H",-1)]))]),t[63]||(t[63]=(0,i.Lk)("li",{class:"nav__dropdown-divider"},null,-1)),(0,i.Lk)("li",Ca,[(0,i.Lk)("button",{onClick:t[19]||(t[19]=e=>l.comment())},t[60]||(t[60]=[(0,i.Lk)("span",null,"Comment",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+/",-1)]))])],512),[[s.aG,"edit"===a.activeDropdown]])]),(0,i.Lk)("li",La,[(0,i.Lk)("button",{class:"nav__item-button",onClick:t[21]||(t[21]=(0,s.D$)(e=>l.toggleDropdown("run"),["stop"])),"aria-haspopup":"menu","aria-expanded":"run"===a.activeDropdown},t[64]||(t[64]=[(0,i.Lk)("span",{class:"nav__item-header"},"Run",-1),(0,i.Lk)("svg",{class:"nav__item-triangle",width:"9",height:"6",viewBox:"0 0 9 6",xmlns:"http://www.w3.org/2000/svg"},[(0,i.Lk)("polygon",{points:"4.5 6 9 0 0 0",fill:"currentColor"})],-1)]),8,Fa),(0,i.bo)((0,i.Lk)("ul",{class:"nav__dropdown",onClick:t[25]||(t[25]=(0,s.D$)(()=>{},["stop"]))},[(0,i.Lk)("li",Ra,[(0,i.Lk)("button",{onClick:t[22]||(t[22]=e=>l.runScript())},t[65]||(t[65]=[(0,i.Lk)("span",null,"Run Script",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"F5",-1)]))]),(0,i.Lk)("li",Ea,[(0,i.Lk)("button",{onClick:t[23]||(t[23]=e=>l.stopScript())},t[66]||(t[66]=[(0,i.Lk)("span",null,"Stop",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Shift+F5",-1)]))]),(0,i.Lk)("li",xa,[(0,i.Lk)("button",{onClick:t[24]||(t[24]=e=>l.clearConsole())},t[67]||(t[67]=[(0,i.Lk)("span",null,"Clear Console",-1)]))])],512),[[s.aG,"run"===a.activeDropdown]])]),(0,i.Lk)("li",ja,[(0,i.Lk)("button",{class:"nav__item-button",onClick:t[26]||(t[26]=(0,s.D$)(e=>l.toggleDropdown("view"),["stop"])),"aria-haspopup":"menu","aria-expanded":"view"===a.activeDropdown},t[68]||(t[68]=[(0,i.Lk)("span",{class:"nav__item-header"},"View",-1),(0,i.Lk)("svg",{class:"nav__item-triangle",width:"9",height:"6",viewBox:"0 0 9 6",xmlns:"http://www.w3.org/2000/svg"},[(0,i.Lk)("polygon",{points:"4.5 6 9 0 0 0",fill:"currentColor"})],-1)]),8,$a),(0,i.bo)((0,i.Lk)("ul",{class:"nav__dropdown",onClick:t[30]||(t[30]=(0,s.D$)(()=>{},["stop"]))},[(0,i.Lk)("li",Da,[(0,i.Lk)("button",{onClick:t[27]||(t[27]=e=>l.toggleConsole())},[(0,i.Lk)("span",null,(0,n.v_)(a.consoleVisible?"Hide REPL":"Show REPL"),1),t[69]||(t[69]=(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+`",-1))])]),(0,i.Lk)("li",Ta,[(0,i.Lk)("button",{onClick:t[28]||(t[28]=e=>l.togglePreviewPanel())},[(0,i.Lk)("span",null,(0,n.v_)(a.previewPanelVisible?"Hide Right Panel":"Show Right Panel"),1),t[70]||(t[70]=(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+Shift+P",-1))])]),(0,i.Lk)("li",Ma,[(0,i.Lk)("button",{onClick:t[29]||(t[29]=e=>l.toggleSidebar())},[(0,i.Lk)("span",null,(0,n.v_)(a.sidebarVisible?"Hide Sidebar":"Show Sidebar"),1),t[71]||(t[71]=(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"Ctrl+B",-1))])])],512),[[s.aG,"view"===a.activeDropdown]])]),(0,i.Lk)("li",Na,[(0,i.Lk)("button",{class:"nav__item-button",onClick:t[31]||(t[31]=(0,s.D$)(e=>l.toggleDropdown("help"),["stop"])),"aria-haspopup":"menu","aria-expanded":"help"===a.activeDropdown},t[72]||(t[72]=[(0,i.Lk)("span",{class:"nav__item-header"},"Help",-1),(0,i.Lk)("svg",{class:"nav__item-triangle",width:"9",height:"6",viewBox:"0 0 9 6",xmlns:"http://www.w3.org/2000/svg"},[(0,i.Lk)("polygon",{points:"4.5 6 9 0 0 0",fill:"currentColor"})],-1)]),8,_a),(0,i.bo)((0,i.Lk)("ul",{class:"nav__dropdown",onClick:t[33]||(t[33]=(0,s.D$)(()=>{},["stop"]))},[(0,i.Lk)("li",Aa,[(0,i.Lk)("button",{onClick:t[32]||(t[32]=e=>l.showKeyboardShortcuts())},t[73]||(t[73]=[(0,i.Lk)("span",null,"Keyboard Shortcuts",-1),(0,i.Lk)("span",{class:"nav__keyboard-shortcut"},"F1",-1)]))])],512),[[s.aG,"help"===a.activeDropdown]])])])]),(0,i.Lk)("div",Wa,[o.currentUser?((0,i.uX)(),(0,i.CE)("button",{key:1,class:"user-btn",onClick:t[35]||(t[35]=e=>a.showUserProfile=!0)},[(0,i.bF)(d,{size:18}),(0,i.Lk)("span",null,(0,n.v_)(o.currentUser.username),1)])):((0,i.uX)(),(0,i.CE)("button",{key:0,class:"sign-in-btn",onClick:t[34]||(t[34]=(...e)=>l.handleSignIn&&l.handleSignIn(...e))},[(0,i.bF)(d,{size:18}),t[74]||(t[74]=(0,i.Lk)("span",null,"Sign In",-1))]))])]),(0,i.Lk)("div",Oa,[(0,i.Lk)("div",Va,[o.hasRunProgram?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",{key:0,class:"icon-btn run-btn",onClick:t[36]||(t[36]=e=>l.runScript()),title:"Run (F5)"},[(0,i.bF)(c,{size:20})])),o.hasRunProgram?((0,i.uX)(),(0,i.CE)("div",{key:1,class:"icon-btn stop-btn",onClick:t[37]||(t[37]=e=>l.stopScript()),title:"Stop (Shift+F5)"},[(0,i.bF)(h,{size:20})])):(0,i.Q3)("",!0),(0,i.Lk)("div",{class:(0,n.C4)(["icon-btn delete-btn",{disabled:!l.canDeleteFile}]),onClick:t[38]||(t[38]=e=>l.deleteSelectedFile()),title:l.deleteButtonTitle},[(0,i.bF)(u,{size:20})],10,Ua),(0,i.Lk)("div",{class:"icon-btn",onClick:t[39]||(t[39]=e=>l.shareProject()),title:"Share"},[(0,i.bF)(p,{size:20})])]),(0,i.Lk)("div",za,[(0,i.Lk)("div",{class:"icon-btn settings-btn",onClick:t[40]||(t[40]=e=>l.openSettings()),title:"Settings"},[(0,i.bF)(m,{size:20})])])]),(0,i.bF)(f,{modelValue:a.showUserProfile,"onUpdate:modelValue":t[41]||(t[41]=e=>a.showUserProfile=e),"current-user":o.currentUser,onLogout:l.handleLogout,onPasswordChanged:l.handlePasswordChanged},null,8,["modelValue","current-user","onLogout","onPasswordChanged"])])}var Ka=o(75365),Ha=o(47478),Xa=o(58263),qa=o(39037);
/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const Ga=(0,xt.A)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),Qa=(0,xt.A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),Ja=(0,xt.A)("circle-user",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);var Ya=o(77918),Za=o(96763),el={props:{consoleLimit:Boolean,hasRunProgram:Boolean,currentUser:{type:Object,default:null}},data(){return{isRun:!0,activeDropdown:null,consoleVisible:!0,previewPanelVisible:!1,sidebarVisible:!0,showUserProfile:!1}},computed:{ideInfo(){return this.$store?.state?.ide?.ideInfo||{}},isPythonFile(){return this.ideInfo.currProj&&this.ideInfo.currProj.pathSelected&&this.ideInfo.codeItems&&this.ideInfo.codeItems.length>0&&this.ideInfo.currProj.pathSelected.endsWith(".py")},hasSelectedFile(){const e=this.ideInfo.nodeSelected&&"file"===this.ideInfo.nodeSelected.type;return Za.log("🔍 [DEBUG] hasSelectedFile computed:",{nodeSelected:this.ideInfo.nodeSelected,nodeType:this.ideInfo.nodeSelected?.type,result:e}),e},canDeleteFile(){const e=this.ideInfo.nodeSelected;return e&&"file"===e.type},deleteButtonTitle(){return this.ideInfo.nodeSelected?"file"!==this.ideInfo.nodeSelected.type?"Can only delete files":`Delete ${this.ideInfo.nodeSelected.label||this.ideInfo.nodeSelected.name}`:"Select a file to delete"},canSaveAsFile(){const e=this.hasSelectedFile,t=this.ideInfo.codeSelected&&this.ideInfo.codeSelected.fileName,o=e||t;return Za.log("🔍 [DEBUG] canSaveAsFile computed:",{hasSelectedFile:e,nodeSelected:this.ideInfo.nodeSelected,hasCodeSelected:t,codeSelected:this.ideInfo.codeSelected,result:o}),o}},components:{Upload:Ka.A,Play:Ha.A,Square:Xa.A,Settings:qa.A,Share2:Ga,Trash2:Qa,UserCircle:Ja,UserProfileModal:Qr},mounted(){const e=localStorage.getItem("theme")||"dark";document.documentElement.setAttribute("data-theme",e),document.addEventListener("click",this.closeDropdowns),Za.log("🎹 TwoHeaderMenu - Adding keyboard shortcut listener"),document.addEventListener("keydown",this.handleKeyboardShortcuts)},beforeUnmount(){document.removeEventListener("click",this.closeDropdowns),document.removeEventListener("keydown",this.handleKeyboardShortcuts)},methods:{toggleDropdown(e){this.activeDropdown=this.activeDropdown===e?null:e},closeDropdowns(){this.activeDropdown=null},handleKeyboardShortcuts(e){if(e.ctrlKey&&!e.shiftKey&&"s"===e.key)return e.preventDefault(),e.stopPropagation(),void this.saveFile();if(e.ctrlKey&&e.shiftKey&&"S"===e.key)return Za.log("🔍 [DEBUG] Ctrl+Shift+S keyboard shortcut triggered"),Za.log("🔍 [DEBUG] canSaveAsFile:",this.canSaveAsFile),e.preventDefault(),e.stopPropagation(),void(this.canSaveAsFile?(Za.log("🔍 [DEBUG] Calling saveAsFile() from keyboard shortcut"),this.saveAsFile()):Za.log("🔍 [DEBUG] Cannot save as - no file available"));if(e.ctrlKey&&e.altKey&&!e.shiftKey&&"n"===e.key)return e.preventDefault(),e.stopPropagation(),void this.newFile();if(e.ctrlKey&&!e.shiftKey&&"o"===e.key)return e.preventDefault(),e.stopPropagation(),void this.openFile();if(e.ctrlKey&&!e.shiftKey&&"d"===e.key)return e.preventDefault(),e.stopPropagation(),void this.downloadFile();if(e.ctrlKey&&e.shiftKey&&"M"===e.key)return e.preventDefault(),e.stopPropagation(),void(this.hasSelectedFile&&this.moveFile());if("Delete"===e.key&&this.hasSelectedFile)return e.preventDefault(),e.stopPropagation(),void this.deleteFile();if(e.ctrlKey&&!e.shiftKey&&"z"===e.key)return e.preventDefault(),e.stopPropagation(),void this.undo();if(e.ctrlKey&&!e.shiftKey&&"y"===e.key)return e.preventDefault(),e.stopPropagation(),void this.redo();if(e.ctrlKey&&!e.shiftKey&&"x"===e.key){const t=document.activeElement,o=t&&t.classList.contains("repl-input");if(o)return;return e.preventDefault(),e.stopPropagation(),void this.cut()}if(e.ctrlKey&&!e.shiftKey&&"c"===e.key){const t=document.activeElement,o=t&&t.classList.contains("repl-input");if(o)return;return e.preventDefault(),e.stopPropagation(),void this.copy()}if(e.ctrlKey&&!e.shiftKey&&"v"===e.key){const t=document.activeElement,o=t&&t.classList.contains("repl-input");if(o)return;return e.preventDefault(),e.stopPropagation(),void this.paste()}return e.ctrlKey&&!e.shiftKey&&"f"===e.key?(e.preventDefault(),e.stopPropagation(),void this.find()):e.ctrlKey&&!e.shiftKey&&"h"===e.key?(e.preventDefault(),e.stopPropagation(),void this.replace()):e.ctrlKey&&"/"===e.key?(e.preventDefault(),e.stopPropagation(),void this.comment()):"F5"!==e.key||e.shiftKey?e.shiftKey&&"F5"===e.key?(e.preventDefault(),e.stopPropagation(),void(this.hasRunProgram&&this.stopScript())):e.ctrlKey&&"`"===e.key?(e.preventDefault(),e.stopPropagation(),void this.toggleConsole()):e.ctrlKey&&e.shiftKey&&"P"===e.key?(e.preventDefault(),e.stopPropagation(),void this.togglePreviewPanel()):e.ctrlKey&&!e.shiftKey&&"b"===e.key?(e.preventDefault(),e.stopPropagation(),void this.toggleSidebar()):"F1"===e.key?(e.preventDefault(),e.stopPropagation(),void this.showKeyboardShortcuts()):e.ctrlKey&&","===e.key?(e.preventDefault(),e.stopPropagation(),void this.openSettings()):void 0:(e.preventDefault(),e.stopPropagation(),void(this.isPythonFile&&!this.consoleLimit&&this.runScript()))},newFile(){if(this.closeDropdowns(),!this.ideInfo.nodeSelected||"dir"!==this.ideInfo.nodeSelected.type&&"folder"!==this.ideInfo.nodeSelected.type){const e=this.ideInfo.currProj?.data;e&&this.$store.commit("ide/setNodeSelected",e)}this.$emit("set-text-dialog",{type:"create-file",title:"New File",tips:"Enter file name:",text:"untitled.py"})},saveFile(){this.closeDropdowns(),this.ideInfo.codeSelected&&(this.$store.dispatch("ide/saveFile",this.ideInfo.codeSelected),ye.nk.success("File saved"))},downloadFile(){if(this.closeDropdowns(),this.ideInfo.nodeSelected&&"file"===this.ideInfo.nodeSelected.type){const e=this.ideInfo.nodeSelected,t={fileName:e.label||e.name,filePath:e.path,projectName:e.projectName||this.ideInfo.currProj?.data?.name};this.$emit("download-file",t)}else this.ideInfo.codeSelected?this.$emit("download-file",this.ideInfo.codeSelected):ye.nk.warning("Please select a file to download")},runScript(){this.closeDropdowns(),this.$emit("run-item")},stopScript(){this.closeDropdowns();for(let e=0;e<this.ideInfo.consoleItems.length;e++)!0===this.ideInfo.consoleItems[e].run&&this.$store.commit("ide/setConsoleItemRun",{index:e,value:!1});this.$emit("stop-item",null)},clearConsole(){this.$emit("clear-console")},deleteSelectedFile(){if(!this.canDeleteFile)return void ye.nk.warning("Please select a file to delete");const e=this.ideInfo.nodeSelected,t=e.label||e.name;Ya.s.confirm(`Are you sure you want to delete "${t}"?`,"Confirm Delete",{confirmButtonText:"Delete",cancelButtonText:"Cancel",type:"warning"}).then(()=>{this.$emit("delete-selected-file",{path:e.path,type:e.type,projectName:e.projectName||this.ideInfo.currProj?.data?.name})}).catch(()=>{})},shareProject(){this.$emit("share-project")},openSettings(){this.$emit("open-settings")},handleSignIn(){this.$emit("sign-in")},openFile(){this.closeDropdowns(),this.$emit("open-file-browser")},duplicateFile(){if(Za.log("🔍 [DEBUG] duplicateFile() called from TwoHeaderMenu"),this.closeDropdowns(),!this.hasSelectedFile)return Za.log("🔍 [DEBUG] No file selected for duplication"),void ye.nk.warning("Please select a file to duplicate");const e=this.ideInfo.nodeSelected,t=e.label||e.name,o=t.includes(".")?t.substring(t.lastIndexOf(".")):"",i=t.includes(".")?t.substring(0,t.lastIndexOf(".")):t,s=`${i}_copy${o}`;Za.log("🔍 [DEBUG] Emitting duplicate-file event:",{originalPath:e.path,newName:s,projectName:e.projectName||this.ideInfo.currProj?.data?.name}),this.$emit("duplicate-file",{originalPath:e.path,newName:s,projectName:e.projectName||this.ideInfo.currProj?.data?.name})},saveAsFile(){if(Za.log("🔍 [DEBUG] saveAsFile() called"),Za.log("🔍 [DEBUG] hasSelectedFile:",this.hasSelectedFile),Za.log("🔍 [DEBUG] nodeSelected:",this.ideInfo.nodeSelected),Za.log("🔍 [DEBUG] codeSelected:",this.ideInfo.codeSelected),Za.log("🔍 [DEBUG] canSaveAsFile:",this.canSaveAsFile),this.closeDropdowns(),this.hasSelectedFile){const e=this.ideInfo.nodeSelected,t={fileName:e.label||e.name,filePath:e.path,projectName:e.projectName||this.ideInfo.currProj?.data?.name};return Za.log("🔍 [DEBUG] Converted tree file to fileInfo:",t),Za.log("🔍 [DEBUG] Original selectedFile:",e),void this.$emit("save-as-file",t)}if(this.ideInfo.codeSelected)return Za.log("🔍 [DEBUG] Emitting save-as-file for editor file:",this.ideInfo.codeSelected),void this.$emit("save-as-file",this.ideInfo.codeSelected);Za.log("🔍 [DEBUG] No file available for save as"),ye.nk.warning("Please select a file to save")},moveFile(){this.closeDropdowns(),this.hasSelectedFile?this.$emit("open-move-dialog",this.ideInfo.nodeSelected):ye.nk.warning("Please select a file to move")},deleteFile(){if(this.closeDropdowns(),!this.hasSelectedFile)return void ye.nk.warning("Please select a file to delete");const e=this.ideInfo.nodeSelected,t=e.label||e.name;Ya.s.confirm(`Are you sure you want to delete "${t}"?`,"Confirm Delete",{confirmButtonText:"Delete",cancelButtonText:"Cancel",type:"warning"}).then(()=>{this.$emit("delete-file",{path:e.path,type:e.type,projectName:e.projectName||this.ideInfo.currProj?.data?.name})}).catch(()=>{})},shareFile(){this.closeDropdowns(),this.$emit("share-file")},undo(){this.closeDropdowns(),this.$emit("undo")},redo(){this.closeDropdowns(),this.$emit("redo")},cut(){this.closeDropdowns(),this.$emit("cut")},copy(){this.closeDropdowns(),this.$emit("copy")},paste(){this.closeDropdowns(),this.$emit("paste")},find(){this.closeDropdowns(),this.$emit("find")},replace(){this.closeDropdowns(),this.$emit("replace")},comment(){this.closeDropdowns(),this.$emit("comment")},toggleConsole(){this.closeDropdowns(),this.consoleVisible=!this.consoleVisible,this.$emit("toggle-console",this.consoleVisible)},togglePreviewPanel(){this.closeDropdowns(),this.previewPanelVisible=!this.previewPanelVisible,this.$emit("toggle-preview-panel",this.previewPanelVisible)},toggleSidebar(){this.closeDropdowns(),this.sidebarVisible=!this.sidebarVisible,this.$emit("toggle-sidebar",this.sidebarVisible)},showKeyboardShortcuts(){this.closeDropdowns(),this.$emit("show-keyboard-shortcuts")},handleLogout(){localStorage.removeItem("session_id"),localStorage.removeItem("username"),localStorage.removeItem("role"),this.$emit("logout"),ye.nk.success("Logged out successfully"),setTimeout(()=>{window.location.reload()},1e3)},handlePasswordChanged(){ye.nk.success("Password changed successfully!")}}};const tl=(0,k.A)(el,[["render",Ba],["__scopeId","data-v-bc87ac1e"]]);var ol=tl;const il={class:"main-wrapper ide-wrapper ide-container"},sl={id:"total-frame",class:"total-frame"},nl={id:"left-sidebar",class:"left-sidebar"},rl={id:"center-frame",class:"center-frame"},al={class:"editor-section"},ll={class:"editor-tab-bar"},dl={class:"editor-content"},cl={class:"console-section"},hl={class:"console-header"},ul={class:"console-header-left"},pl={class:"console-title"},ml={class:"console-header-center"},fl={key:0,class:"console-header-right"},gl=["title"],vl={class:"console-body"},yl={class:"console-output-area",ref:"consoleOutputArea"},wl={key:0,class:"console-text"},bl={key:1,class:"console-error"},kl={key:2,class:"console-input-prompt"},Il={key:3,class:"console-system"},Pl={key:4,class:"console-repl-prompt"},Sl=["innerHTML"],Cl={key:6,class:"console-repl-entry"},Ll={key:0,class:"console-repl-prompt"},Fl=["innerHTML"],Rl={key:1,class:"console-repl-line"},El={class:"console-repl-prompt"},xl=["innerHTML"],jl={key:7,class:"console-text"},$l={key:0,class:"console-input-area"},Dl={class:"input-prompt"},Tl={class:"input-field-container"},Ml=["rows"],Nl={key:1,class:"repl-section"},_l={class:"repl-prompt"},Al={class:"prompt-symbol"},Wl=["rows"],Ol={id:"right-sidebar",class:"right-sidebar"},Vl={class:"right-sidebar-placeholder"},Ul={class:"preview-tabs"},zl={class:"preview-tab-list"},Bl=["onClick"],Kl={class:"tab-icon"},Hl={class:"tab-title"},Xl=["onClick"],ql={class:"preview-content"},Gl={key:0,class:"output-panel"},Ql={class:"output-content"},Jl={key:1,class:"media-preview-panel"},Yl={key:2,class:"data-preview-panel"},Zl={key:0,class:"right-panel-controls"},ed=["title"],td={class:"tab-count"},od={key:6,class:"repl-modal"},id={class:"repl-modal-content"},sd={class:"repl-modal-header"},nd={class:"repl-modal-body"};function rd(e,t,o,r,a,l){const d=ol,c=Vt.A,h=Ot,u=Tt,p=pt.A,m=(0,i.g2)("pane"),f=ut,g=tt.A,v=et.A,y=(0,i.g2)("ChevronUp"),w=(0,i.g2)("ChevronDown"),b=(0,i.g2)("Minimize2"),k=(0,i.g2)("splitpanes"),I=Ze.A,C=Ye.A,L=(0,i.g2)("ChevronLeft"),F=(0,i.g2)("ChevronRight"),R=Je.A,E=Qe.A,x=Ge.A,j=qe.A,$=Xe,D=Ie,T=K,M=S.A,N=P;return(0,i.uX)(),(0,i.CE)("div",il,[(0,i.bF)(d,{class:"two-header-menu",consoleLimit:l.consoleLimit,hasRunProgram:l.hasRunProgram,currentUser:l.currentUser,onSetTextDialog:l.setTextDialog,onSetDelDialog:l.setDelDialog,onSetProjsDialog:l.setProjsDialog,onRunItem:l.runPathSelected,onStopItem:l.stop,onClearConsole:l.clearConsole,onShareProject:l.shareProject,onSignIn:l.handleSignIn,onOpenUploadDialog:t[0]||(t[0]=e=>a.showUploadDialog=!0),onDownloadFile:l.downloadFile,onOpenSettings:t[1]||(t[1]=e=>a.showSettingsModal=!0),onOpenFileBrowser:l.openFileBrowser,onDuplicateFile:l.duplicateFile,onSaveAsFile:l.saveAsFile,onOpenMoveDialog:l.openMoveDialog,onDeleteFile:l.deleteFileFromMenu,onDeleteSelectedFile:l.deleteSelectedFile,onShareFile:l.shareFile,onUndo:l.handleUndo,onRedo:l.handleRedo,onCut:l.handleCut,onCopy:l.handleCopy,onPaste:l.handlePaste,onFind:l.handleFind,onReplace:l.handleReplace,onComment:l.handleComment,onToggleConsole:l.toggleConsole,onTogglePreviewPanel:l.togglePreviewPanel,onToggleSidebar:l.toggleLeftSidebar,onShowKeyboardShortcuts:t[2]||(t[2]=e=>a.showKeyboardShortcutsModal=!a.showKeyboardShortcutsModal)},null,8,["consoleLimit","hasRunProgram","currentUser","onSetTextDialog","onSetDelDialog","onSetProjsDialog","onRunItem","onStopItem","onClearConsole","onShareProject","onSignIn","onDownloadFile","onOpenFileBrowser","onDuplicateFile","onSaveAsFile","onOpenMoveDialog","onDeleteFile","onDeleteSelectedFile","onShareFile","onUndo","onRedo","onCut","onCopy","onPaste","onFind","onReplace","onComment","onToggleConsole","onTogglePreviewPanel","onToggleSidebar"]),(0,i.bF)(c,{modelValue:a.showSettingsModal,"onUpdate:modelValue":t[3]||(t[3]=e=>a.showSettingsModal=e),onUpdateFontSize:l.updateFontSize,onUpdateLineNumbers:l.updateLineNumbers,onUpdateWordWrap:l.updateWordWrap,onUpdateAutoSave:l.updateAutoSave,onUpdateAutoSaveInterval:l.updateAutoSaveInterval},null,8,["modelValue","onUpdateFontSize","onUpdateLineNumbers","onUpdateWordWrap","onUpdateAutoSave","onUpdateAutoSaveInterval"]),(0,i.bF)(h,{modelValue:a.showKeyboardShortcutsModal,"onUpdate:modelValue":t[4]||(t[4]=e=>a.showKeyboardShortcutsModal=e)},null,8,["modelValue"]),(0,i.bF)(u,{modelValue:a.showFindReplaceModal,"onUpdate:modelValue":t[5]||(t[5]=e=>a.showFindReplaceModal=e),mode:a.findReplaceMode},null,8,["modelValue","mode"]),(0,i.Lk)("div",sl,[(0,i.bF)(k,{class:(0,n.C4)(["default-theme","main-splitpanes",{"has-right-content":a.previewTabs.length>0}])},{default:(0,i.k6)(()=>[(0,i.bF)(m,{size:l.leftSidebarSize,"min-size":l.leftSidebarMinSize,"max-size":l.leftSidebarMaxSize},{default:(0,i.k6)(()=>[(0,i.bo)((0,i.Lk)("div",nl,[(0,i.bF)(p,{onGetItem:l.getFile,onGetItemRightPanel:l.getFileForRightPanel,onContextMenu:a.showContextMenu,onRenameItem:l.handleRenameItem,onDeleteItem:l.handleDeleteItem,onDownloadItem:l.handleDownloadItem,onNewFile:l.handleNewFileFromTree,onNewFolder:l.handleNewFolderFromTree},null,8,["onGetItem","onGetItemRightPanel","onContextMenu","onRenameItem","onDeleteItem","onDownloadItem","onNewFile","onNewFolder"])],512),[[s.aG,a.leftSidebarVisible&&a.windowWidth>900]])]),_:1},8,["size","min-size","max-size"]),(0,i.bF)(m,{size:l.centerSize,"min-size":30},{default:(0,i.k6)(()=>[(0,i.Lk)("div",rl,[(0,i.bF)(f,{onOpenInRightPanel:l.getFileForRightPanel},null,8,["onOpenInRightPanel"]),(0,i.bF)(k,{horizontal:"",class:"default-theme"},{default:(0,i.k6)(()=>[(0,i.bF)(m,{size:l.editorPaneSize,"min-size":5,"max-size":95},{default:(0,i.k6)(()=>[(0,i.Lk)("div",al,[(0,i.Lk)("div",ll,[l.ideInfo.codeItems.length>0?((0,i.uX)(),(0,i.Wv)(g,{key:0,onSelectItem:l.selectFile,onCloseItem:l.closeFile,onToggleSidebar:l.toggleLeftSidebar},null,8,["onSelectItem","onCloseItem","onToggleSidebar"])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",dl,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(l.ideInfo.codeItems,(e,t)=>((0,i.uX)(),(0,i.CE)(i.FK,{key:`${e.projectName||"default"}:${e.path}`},[l.isSelectedFile(e)?((0,i.uX)(),(0,i.Wv)(v,{key:0,codeItem:e,codeItemIndex:t,consoleLimit:l.consoleLimit,wordWrap:a.wordWrap,onRunItem:l.runPathSelected,onUpdateItem:l.updateItem},null,8,["codeItem","codeItemIndex","consoleLimit","wordWrap","onRunItem","onUpdateItem"])):(0,i.Q3)("",!0)],64))),128))])])]),_:1},8,["size"]),(0,i.bF)(m,{size:l.consolePaneSize,"min-size":5,"max-size":95},{default:(0,i.k6)(()=>[(0,i.Lk)("div",cl,[(0,i.Lk)("div",hl,[(0,i.Lk)("div",ul,[(0,i.Lk)("span",pl,(0,n.v_)(a.isReplMode?"Python REPL":"Console"),1)]),(0,i.Lk)("div",ml,["collapsed"===a.consoleMode?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"console-expand-arrow",onClick:t[6]||(t[6]=(...e)=>l.handleConsoleUpArrow&&l.handleConsoleUpArrow(...e)),title:"Open console"},[(0,i.bF)(y,{size:16})])):(0,i.Q3)("",!0),"normal"===a.consoleMode?((0,i.uX)(),(0,i.CE)("button",{key:1,class:"console-expand-arrow",onClick:t[7]||(t[7]=(...e)=>l.handleConsoleUpArrow&&l.handleConsoleUpArrow(...e)),title:"Maximize console"},[(0,i.bF)(y,{size:16})])):(0,i.Q3)("",!0),"normal"===a.consoleMode?((0,i.uX)(),(0,i.CE)("button",{key:2,class:"console-expand-arrow",onClick:t[8]||(t[8]=(...e)=>l.handleConsoleDownArrow&&l.handleConsoleDownArrow(...e)),title:"Collapse console"},[(0,i.bF)(w,{size:16})])):(0,i.Q3)("",!0),"maximized"===a.consoleMode?((0,i.uX)(),(0,i.CE)("button",{key:3,class:"console-expand-arrow",onClick:t[9]||(t[9]=(...e)=>l.handleConsoleRestore&&l.handleConsoleRestore(...e)),title:"Restore console"},[(0,i.bF)(b,{size:16})])):(0,i.Q3)("",!0),"maximized"===a.consoleMode?((0,i.uX)(),(0,i.CE)("button",{key:4,class:"console-expand-arrow",onClick:t[10]||(t[10]=(...e)=>l.handleConsoleDownArrow&&l.handleConsoleDownArrow(...e)),title:"Collapse console"},[(0,i.bF)(w,{size:16})])):(0,i.Q3)("",!0)]),a.consoleExpanded?((0,i.uX)(),(0,i.CE)("div",fl,[(0,i.Lk)("button",{class:(0,n.C4)(["console-action-btn",{active:a.isReplMode}]),onClick:t[11]||(t[11]=(0,s.D$)((...e)=>l.toggleReplMode&&l.toggleReplMode(...e),["stop"])),title:a.isReplMode?"Exit REPL Mode":"Start Python REPL"},[(0,i.Lk)("span",null,(0,n.v_)(a.isReplMode?"Exit REPL":"REPL"),1)],10,gl),(0,i.Lk)("button",{class:"console-action-btn",onClick:t[12]||(t[12]=(0,s.D$)((...e)=>l.clearConsole&&l.clearConsole(...e),["stop"])),title:"Clear Console"},t[28]||(t[28]=[(0,i.Lk)("span",null,"Clear",-1)]))])):(0,i.Q3)("",!0)]),(0,i.bo)((0,i.Lk)("div",vl,[(0,i.Lk)("div",yl,[l.ideInfo.consoleSelected&&l.ideInfo.consoleSelected.resultList?((0,i.uX)(!0),(0,i.CE)(i.FK,{key:0},(0,i.pI)(l.ideInfo.consoleSelected.resultList,(e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:t,class:"console-line"},["output"!==e.type&&"text"!==e.type||l.isPromptOutput(e)?"error"===e.type?((0,i.uX)(),(0,i.CE)("pre",bl,(0,n.v_)(e.text||e.content||e),1)):"input"===e.type||"input-prompt"===e.type?((0,i.uX)(),(0,i.CE)("div",kl,[(0,i.Lk)("span",null,(0,n.v_)(e.text||e.content||e),1)])):"system"===e.type?((0,i.uX)(),(0,i.CE)("pre",Il,(0,n.v_)(e.text||e.content||e),1)):"repl-prompt"===e.type?((0,i.uX)(),(0,i.CE)("span",Pl,(0,n.v_)(e.text||">>> "),1)):"user-input"===e.type?((0,i.uX)(),(0,i.CE)("pre",{key:5,class:"console-user-input",innerHTML:l.highlightPythonCode(e.text||e.content||e)},null,8,Sl)):"repl-input"===e.type?((0,i.uX)(),(0,i.CE)("div",Cl,[l.isMultilineCode(e.content||e.text||e)?((0,i.uX)(!0),(0,i.CE)(i.FK,{key:0},(0,i.pI)(l.splitCodeLines(e.content||e.text||e),(t,o)=>((0,i.uX)(),(0,i.CE)("div",{key:"line-"+o,class:"console-repl-line"},[0===o?((0,i.uX)(),(0,i.CE)("span",Ll,(0,n.v_)(e.prompt||">>> "),1)):(0,i.Q3)("",!0),(0,i.Lk)("pre",{class:(0,n.C4)(["console-repl-input",{"no-prompt":o>0}]),innerHTML:l.highlightPythonCode(t)},null,10,Fl)]))),128)):((0,i.uX)(),(0,i.CE)("div",Rl,[(0,i.Lk)("span",El,(0,n.v_)(e.prompt||">>> "),1),(0,i.Lk)("pre",{class:"console-repl-input",innerHTML:l.highlightPythonCode(e.content||e.text||e)},null,8,xl)]))])):((0,i.uX)(),(0,i.CE)("pre",jl,(0,n.v_)("object"===typeof e?e.text||e.content||JSON.stringify(e):e),1)):((0,i.uX)(),(0,i.CE)("pre",wl,(0,n.v_)(e.text||e.content||e),1))]))),128)):(0,i.Q3)("",!0)],512),l.ideInfo.consoleSelected&&l.ideInfo.consoleSelected.waitingForInput?((0,i.uX)(),(0,i.CE)("div",$l,[(0,i.Lk)("div",Dl,[t[29]||(t[29]=(0,i.Lk)("span",{class:"prompt-icon"},"💬",-1)),(0,i.Lk)("span",null,(0,n.v_)(l.ideInfo.consoleSelected.inputPrompt||"Enter input:"),1)]),(0,i.Lk)("div",Tl,[(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[13]||(t[13]=e=>a.programInput=e),onKeydown:t[14]||(t[14]=(...e)=>l.handleProgramInputKeydown&&l.handleProgramInputKeydown(...e)),ref:"programInputField",class:"program-input-field",placeholder:"Type your input and press Enter...",rows:a.programInputRows,autofocus:""},null,40,Ml),[[s.Jo,a.programInput]]),(0,i.Lk)("button",{onClick:t[15]||(t[15]=(...e)=>l.sendProgramInput&&l.sendProgramInput(...e)),class:"input-submit-btn"},"Send")])])):(0,i.Q3)("",!0),a.isReplMode||l.ideInfo.consoleSelected&&l.ideInfo.consoleSelected.waitingForReplInput?((0,i.uX)(),(0,i.CE)("div",Nl,[(0,i.Lk)("div",_l,[(0,i.Lk)("span",Al,(0,n.v_)(a.replPrompt||">>> "),1),(0,i.bo)((0,i.Lk)("textarea",{class:"repl-input",placeholder:"Enter Python code...","onUpdate:modelValue":t[16]||(t[16]=e=>a.replInput=e),onKeydown:t[17]||(t[17]=(...e)=>l.handleReplKeydown&&l.handleReplKeydown(...e)),ref:"replInputField",rows:a.replInputRows},"                ",40,Wl),[[s.Jo,a.replInput]])])])):(0,i.Q3)("",!0)],512),[[s.aG,a.consoleExpanded]])])]),_:1},8,["size"])]),_:1})])]),_:1},8,["size"]),(0,i.bF)(m,{size:l.rightSidebarSize,"min-size":l.rightSidebarMinSize,"max-size":l.rightSidebarMaxSize,"push-other-panes":!1},{default:(0,i.k6)(()=>[(0,i.Lk)("div",Ol,[(0,i.bo)((0,i.Lk)("div",Vl,null,512),[[s.aG,!a.rightSidebarVisible||0===a.previewTabs.length]]),(0,i.bo)((0,i.Lk)("div",Ul,[(0,i.Lk)("div",zl,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.previewTabs,e=>((0,i.uX)(),(0,i.CE)("button",{key:e.id,class:(0,n.C4)(["preview-tab",{active:a.selectedPreviewTab===e.id}]),onClick:t=>l.selectPreviewTab(e.id)},[(0,i.Lk)("span",Kl,(0,n.v_)(l.getTabIcon(e.type)),1),(0,i.Lk)("span",Hl,(0,n.v_)(e.title),1),(0,i.Lk)("span",{class:"tab-close",onClick:(0,s.D$)(t=>l.closePreviewTab(e.id),["stop"])},"×",8,Xl)],10,Bl))),128))])],512),[[s.aG,a.rightSidebarVisible&&a.previewTabs.length>0]]),(0,i.bo)((0,i.Lk)("div",ql,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.previewTabs,e=>(0,i.bo)(((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"preview-panel"},["output"===e.type?((0,i.uX)(),(0,i.CE)("div",Gl,[(0,i.Lk)("div",Ql,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.content,(e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:t,class:(0,n.C4)(["output-line",e.type])},[(0,i.Lk)("pre",null,(0,n.v_)(e.text),1)],2))),128))])])):"image"===e.type||"pdf"===e.type?((0,i.uX)(),(0,i.CE)("div",Jl,[(0,i.bF)(I,{codeItem:l.getMediaCodeItem(e),codeItemIndex:0},null,8,["codeItem"])])):"data"===e.type?((0,i.uX)(),(0,i.CE)("div",Yl,[(0,i.bF)(C,{content:e.content},null,8,["content"])])):(0,i.Q3)("",!0)],512)),[[s.aG,a.selectedPreviewTab===e.id]])),128))],512),[[s.aG,a.rightSidebarVisible&&a.previewTabs.length>0]])])]),_:1},8,["size","min-size","max-size"])]),_:1},8,["class"]),"closed"!==a.rightPanelMode&&a.previewTabs.length>0?((0,i.uX)(),(0,i.CE)("div",Zl,["normal"===a.rightPanelMode?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"control-arrow left-arrow",onClick:t[18]||(t[18]=(...e)=>l.handleLeftArrowClick&&l.handleLeftArrowClick(...e)),title:"Expand preview to full width"},[(0,i.bF)(L,{size:16})])):(0,i.Q3)("",!0),(0,i.Lk)("button",{class:"control-arrow right-arrow",onClick:t[19]||(t[19]=(...e)=>l.handleRightArrowClick&&l.handleRightArrowClick(...e)),title:"expanded"===a.rightPanelMode?"Restore to normal size":"Collapse preview panel"},[(0,i.bF)(F,{size:16})],8,ed)])):(0,i.Q3)("",!0),"closed"===a.rightPanelMode&&a.previewTabs.length>0?((0,i.uX)(),(0,i.CE)("div",{key:1,class:"show-preview-btn",onClick:t[20]||(t[20]=(...e)=>l.restoreRightPanel&&l.restoreRightPanel(...e)),title:"Show Preview Panel"},[(0,i.Lk)("span",td,(0,n.v_)(a.previewTabs.length),1),t[30]||(t[30]=(0,i.Lk)("span",null,"◀",-1))])):(0,i.Q3)("",!0)]),a.showProjsDialog?((0,i.uX)(),(0,i.Wv)(R,{key:0,onOnCancel:l.onCloseProjsDialog,onOnSelect:l.onSelectProj,onOnDelete:l.onDeleteProj,onSetTextDialog:l.setTextDialog},null,8,["onOnCancel","onOnSelect","onOnDelete","onSetTextDialog"])):(0,i.Q3)("",!0),a.showFileDialog?((0,i.uX)(),(0,i.Wv)(E,{key:1,title:a.dialogTitle,text:a.dialogText,tips:a.dialogTips,onCheckInput:l.inputIsLegal,onOnCancel:l.onCloseTextDialog,onOnCreate:l.onCreate},null,8,["title","text","tips","onCheckInput","onOnCancel","onOnCreate"])):(0,i.Q3)("",!0),a.showDeleteDialog?((0,i.uX)(),(0,i.Wv)(x,{key:2,title:a.dialogTitle,onOnCancel:l.onCancelDelete,onOnDelete:l.onDelete},null,8,["title","onOnCancel","onOnDelete"])):(0,i.Q3)("",!0),a.showUploadDialog?((0,i.uX)(),(0,i.Wv)(j,{key:3,modelValue:a.showUploadDialog,"onUpdate:modelValue":t[21]||(t[21]=e=>a.showUploadDialog=e),onRefreshTree:l.refreshProjectTree,onClose:t[22]||(t[22]=e=>a.showUploadDialog=!1)},null,8,["modelValue","onRefreshTree"])):(0,i.Q3)("",!0),a.showNewFileDialog?((0,i.uX)(),(0,i.Wv)($,{key:4,modelValue:a.showNewFileDialog,"onUpdate:modelValue":t[23]||(t[23]=e=>a.showNewFileDialog=e),onFileCreated:l.handleFileCreated},null,8,["modelValue","onFileCreated"])):(0,i.Q3)("",!0),a.showNewFolderDialog?((0,i.uX)(),(0,i.Wv)(D,{key:5,modelValue:a.showNewFolderDialog,"onUpdate:modelValue":t[24]||(t[24]=e=>a.showNewFolderDialog=e),onFolderCreated:l.handleFolderCreated},null,8,["modelValue","onFolderCreated"])):(0,i.Q3)("",!0),(0,i.bF)(T,{modelValue:a.showFileBrowserDialog,"onUpdate:modelValue":t[25]||(t[25]=e=>a.showFileBrowserDialog=e),mode:a.fileBrowserMode,fileToMove:a.fileToMove,currentUser:l.currentUser,onOpenFile:l.handleOpenFile,onMoveFile:l.handleMoveFile},null,8,["modelValue","mode","fileToMove","currentUser","onOpenFile","onMoveFile"]),a.showREPL?((0,i.uX)(),(0,i.CE)("div",od,[(0,i.Lk)("div",id,[(0,i.Lk)("div",sd,[t[31]||(t[31]=(0,i.Lk)("h3",null,"Python REPL (Interactive Console)",-1)),(0,i.Lk)("button",{onClick:t[26]||(t[26]=(...e)=>l.closeREPL&&l.closeREPL(...e)),class:"repl-close-btn"},"✕")]),(0,i.Lk)("div",nd,[(0,i.bF)(M)])])])):(0,i.Q3)("",!0),(0,i.bF)(N,{visible:a.showLoginModal,onClose:t[27]||(t[27]=e=>a.showLoginModal=!1),onLoginSuccess:l.handleLoginSuccess},null,8,["visible","onLoginSuccess"])])}o(16573),o(78100),o(77936),o(13579),o(79577),o(41549),o(49797),o(49631),o(35623),o(64979),o(14603),o(47566),o(98721);var ad=o(99415),ld=o(33887);
/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const dd=(0,xt.A)("minimize-2",[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]]),cd={class:"hybrid-console"},hd={class:"console-output",ref:"consoleOutput"},ud={key:1,class:"output-text error-output"},pd={key:2,class:"output-text system-message"},md={key:3,class:"input-prompt-line"},fd={class:"prompt-text"},gd={key:4,class:"user-input-line"},vd={class:"input-text"},yd={class:"repl-prompt"},wd={key:6,class:"repl-output"},bd={key:7,class:"figure-container"},kd=["src"],Id={class:"figure-controls"},Pd=["onClick"],Sd=["onClick"],Cd={key:0,class:"loading-indicator"},Ld={key:0,class:"input-area"},Fd={key:0,class:"input-prompt-display"},Rd={class:"prompt-label"},Ed={key:1,class:"repl-input-container"},xd={class:"repl-input-prefix"},jd={class:"repl-editor-wrapper"},$d={key:2,class:"input-container"},Dd=["rows"],Td=["disabled"],Md={class:"input-hint"},Nd={key:0},_d={key:1},Ad={class:"console-status"},Wd={class:"status-left"},Od={key:0,class:"status-item repl"},Vd={key:1,class:"status-item running"},Ud={key:2,class:"status-item success"},zd={key:3,class:"status-item error"},Bd={key:4,class:"status-item idle"},Kd={class:"status-right"};function Hd(e,t,o,r,a,l){const d=(0,i.g2)("Codemirror");return(0,i.uX)(),(0,i.CE)("div",cd,[(0,i.Lk)("div",hd,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.outputLines,(e,o)=>((0,i.uX)(),(0,i.CE)("div",{key:o,class:"output-line"},["text"===e.type?((0,i.uX)(),(0,i.CE)("pre",{key:0,class:(0,n.C4)(["output-text",e.class])},(0,n.v_)(e.content),3)):"error"===e.type?((0,i.uX)(),(0,i.CE)("pre",ud,(0,n.v_)(e.content),1)):"system"===e.type?((0,i.uX)(),(0,i.CE)("pre",pd,(0,n.v_)(e.content),1)):"input-prompt"===e.type?((0,i.uX)(),(0,i.CE)("div",md,[t[8]||(t[8]=(0,i.Lk)("span",{class:"prompt-indicator"},"🔸",-1)),(0,i.Lk)("span",fd,(0,n.v_)(e.content),1)])):"user-input"===e.type?((0,i.uX)(),(0,i.CE)("div",gd,[t[9]||(t[9]=(0,i.Lk)("span",{class:"input-indicator"},"▶",-1)),(0,i.Lk)("span",vd,(0,n.v_)(e.content),1)])):"repl-input"===e.type?((0,i.uX)(),(0,i.CE)("div",{key:5,class:(0,n.C4)(["repl-line",{multiline:e.multiline}])},[(0,i.Lk)("span",yd,(0,n.v_)(e.prompt),1),(0,i.Lk)("pre",{class:(0,n.C4)(["repl-input-text",{"multiline-content":e.multiline}])},(0,n.v_)(e.content),3)],2)):"repl-output"===e.type?((0,i.uX)(),(0,i.CE)("pre",wd,(0,n.v_)(e.content),1)):"figure"===e.type?((0,i.uX)(),(0,i.CE)("div",bd,[(0,i.Lk)("img",{src:`data:image/png;base64,${e.data}`,alt:"Matplotlib Figure",class:"matplotlib-figure"},null,8,kd),(0,i.Lk)("div",Id,[(0,i.Lk)("button",{class:"figure-btn",onClick:t=>r.downloadFigure(e.data),title:"Download"}," 📥 ",8,Pd),(0,i.Lk)("button",{class:"figure-btn",onClick:t=>r.openFigureInNewTab(e.data),title:"Open in new tab"}," 🔍 ",8,Sd)])])):(0,i.Q3)("",!0)]))),128)),!o.isRunning||r.waitingForInput||r.isReplMode?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",Cd,t[10]||(t[10]=[(0,i.Lk)("span",{class:"loading-dots"},"●●●",-1),(0,i.Lk)("span",{class:"loading-text"},"Running...",-1)])))],512),r.waitingForInput||r.isReplMode?((0,i.uX)(),(0,i.CE)("div",Ld,[r.waitingForInput&&!r.isReplMode?((0,i.uX)(),(0,i.CE)("div",Fd,[t[11]||(t[11]=(0,i.Lk)("span",{class:"prompt-icon"},"💬",-1)),(0,i.Lk)("span",Rd,(0,n.v_)(r.currentPrompt||"Waiting for input..."),1)])):(0,i.Q3)("",!0),r.isReplMode?((0,i.uX)(),(0,i.CE)("div",Ed,[(0,i.Lk)("span",xd,(0,n.v_)(r.replPrompt),1),(0,i.Lk)("div",jd,[(0,i.bF)(d,{value:r.userInput,"onUpdate:value":t[0]||(t[0]=e=>r.userInput=e),options:r.replCodeMirrorOptions,onKeydown:r.handleKeyDown,ref:"replEditor",class:"repl-codemirror",placeholder:"Enter Python code..."},null,8,["value","options","onKeydown"])])])):((0,i.uX)(),(0,i.CE)("div",$d,[t[12]||(t[12]=(0,i.Lk)("span",{class:"input-prefix"},"▶",-1)),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.userInput=e),onKeydown:t[2]||(t[2]=(...e)=>r.handleKeyDown&&r.handleKeyDown(...e)),ref:"inputField",class:"user-input-field",placeholder:"Type your input and press Enter...",rows:r.inputRows,autofocus:""},null,40,Dd),[[s.Jo,r.userInput]]),(0,i.Lk)("button",{class:"input-btn primary",onClick:t[3]||(t[3]=(...e)=>r.sendInput&&r.sendInput(...e)),disabled:!r.userInput.trim(),title:"Submit (Enter)"}," ✓ ",8,Td),(0,i.Lk)("button",{class:"input-btn secondary",onClick:t[4]||(t[4]=(...e)=>r.cancelInput&&r.cancelInput(...e)),title:"Cancel (Escape)"}," ✕ ")])),(0,i.Lk)("div",Md,[r.isReplMode?((0,i.uX)(),(0,i.CE)("span",Nd,"Enter: Execute | Shift+Enter: New line | Up/Down: History")):((0,i.uX)(),(0,i.CE)("span",_d,"Press Enter to submit • Escape to cancel"))])])):(0,i.Q3)("",!0),(0,i.Lk)("div",Ad,[(0,i.Lk)("div",Wd,[r.isReplMode?((0,i.uX)(),(0,i.CE)("span",Od,t[13]||(t[13]=[(0,i.Lk)("span",{class:"status-dot repl"},null,-1),(0,i.eW)(" REPL Mode ",-1)]))):o.isRunning?((0,i.uX)(),(0,i.CE)("span",Vd,[t[14]||(t[14]=(0,i.Lk)("span",{class:"status-dot"},null,-1)),(0,i.eW)(" Running "+(0,n.v_)(r.currentProgram),1)])):0===r.lastExitCode?((0,i.uX)(),(0,i.CE)("span",Ud,t[15]||(t[15]=[(0,i.Lk)("span",{class:"status-dot"},null,-1),(0,i.eW)(" Ready ",-1)]))):null!==r.lastExitCode?((0,i.uX)(),(0,i.CE)("span",zd,[t[16]||(t[16]=(0,i.Lk)("span",{class:"status-dot"},null,-1)),(0,i.eW)(" Exit code: "+(0,n.v_)(r.lastExitCode),1)])):((0,i.uX)(),(0,i.CE)("span",Bd,t[17]||(t[17]=[(0,i.Lk)("span",{class:"status-dot"},null,-1),(0,i.eW)(" Idle ",-1)])))]),(0,i.Lk)("div",Kd,[(0,i.Lk)("button",{class:"status-btn",onClick:t[5]||(t[5]=(...e)=>r.clearConsole&&r.clearConsole(...e)),title:"Clear console"},"🗑️"),(0,i.Lk)("button",{class:"status-btn",onClick:t[6]||(t[6]=(...e)=>r.exportOutput&&r.exportOutput(...e)),title:"Export output"},"📄"),o.isRunning||r.isReplMode?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"status-btn danger",onClick:t[7]||(t[7]=(...e)=>r.stopProgram&&r.stopProgram(...e)),title:"Stop"},"⏹️")):(0,i.Q3)("",!0)])])])}var Xd=o(42453),qd=o(15237),Gd=o.n(qd),Qd=(o(74806),o(50436),o(97923),o(55218),o(44317),o(57829),{name:"HybridConsole",components:{Codemirror:Xd.Ay},props:{item:{type:Object,required:!0},isRunning:{type:Boolean,default:!1}},emits:["run-item","stop-item","send-input"],setup(e,{emit:t}){const o=(0,Ut.KR)([]),s=(0,Ut.KR)(!1),n=(0,Ut.KR)(""),r=(0,Ut.KR)(""),a=(0,Ut.KR)(null),l=(0,Ut.KR)(""),d=(0,Ut.KR)(!1),c=(0,Ut.KR)(">>> "),h=(0,Ut.KR)([]),u=(0,Ut.KR)(-1),p=(0,Ut.KR)(1),m=(0,Ut.KR)(null),f=(0,Ut.KR)(null),g=(0,Ut.KR)(null),v=(0,Ut.KR)({mode:{name:"python",version:3,singleLineStringErrors:!1},theme:"repl-theme",lineNumbers:!1,smartIndent:!0,indentUnit:4,tabSize:4,indentWithTabs:!1,matchBrackets:!0,autoCloseBrackets:!0,styleActiveLine:!1,lineWrapping:!0,showCursorWhenSelecting:!0,viewportMargin:1/0,scrollbarStyle:null,autofocus:!0,extraKeys:{Enter:e=>{const t=e.getCursor(),o=e.getLine(t.line),i=e.getValue().trim(),s=o.trim().endsWith(":")||o.trim().endsWith("\\")||/^\s+/.test(o)||i.split("\n").some((e,o)=>o<t.line&&e.trim().endsWith(":"));if(s||t.line<e.lastLine()){const t=o.match(/^\s*/)[0],i=o.trim().endsWith(":")?"    ":"";e.replaceSelection("\n"+t+i)}else i?L():e.replaceSelection("\n")},"Shift-Enter":e=>{const t=e.getCursor(),o=e.getLine(t.line),i=o.match(/^\s*/)[0];e.replaceSelection("\n"+i)},Up:e=>{0!==e.getCursor().line||e.getSelection()?Gd().commands.goLineUp(e):F("up")},Down:e=>{e.getCursor().line!==e.lastLine()||e.getSelection()?Gd().commands.goLineDown(e):F("down")},Tab:e=>{e.getSelection()?e.indentSelection("add"):e.replaceSelection(Array(e.getOption("indentUnit")+1).join(" "))},"Shift-Tab":e=>{e.indentSelection("subtract")}}}),y=(0,i.EW)(()=>{if(!r.value)return 1;const e=r.value.split("\n").length;return Math.min(Math.max(e,1),10)});(0,i.wB)(r,()=>{p.value=y.value});const w=(e,t="text",s="")=>{o.value.push({type:t,content:e,class:s,timestamp:Date.now()}),(0,i.dY)(()=>{$()})},b=(e,t,s="repl-input")=>{const n=t.includes("\n")&&""!==t.trim()||t.trim().match(/^(def|class|if|for|while|with|try|except|finally)\s/)&&t.trim().endsWith(":");o.value.push({type:s,prompt:e,content:t,timestamp:Date.now(),multiline:n}),(0,i.dY)(()=>{$()})},k=e=>{o.value.push({type:"figure",data:e,timestamp:Date.now()}),(0,i.dY)(()=>{$()})},I=e=>{const t=e||"Program waiting for input:";n.value=t,s.value=!0,w(e||"Program waiting for input:","input-prompt"),(0,i.dY)(()=>{f.value&&f.value.focus()})},P=()=>{d.value=!0,s.value=!1,c.value=">>> ",r.value="",u.value=-1,(0,i.dY)(()=>{setTimeout(()=>{g.value?.cminstance?(g.value.cminstance.refresh(),g.value.cminstance.focus()):f.value&&f.value.focus()},100)})},S=()=>{d.value=!1,c.value=">>> ",r.value="",h.value=[],u.value=-1},C=e=>{d.value?"Enter"!==e.key||e.shiftKey?"Enter"===e.key&&e.shiftKey?c.value="... ":"ArrowUp"===e.key?(e.preventDefault(),F("up")):"ArrowDown"===e.key&&(e.preventDefault(),F("down")):(e.preventDefault(),L()):"Enter"!==e.key||e.shiftKey?"Escape"===e.key&&(e.preventDefault(),E()):(e.preventDefault(),R())},L=()=>{const o=d.value&&g.value?.cminstance?.getValue()||r.value;if(!o.trim())return b(c.value,"","repl-input"),void(c.value=">>> ");o.trim()&&(h.value.push(o),u.value=h.value.length),b(c.value,o,"repl-input"),t("send-input",{programId:e.item.id,input:o,isRepl:!0}),d.value&&g.value?.cminstance&&(g.value.cminstance.setValue(""),(0,i.dY)(()=>{g.value.cminstance.refresh(),g.value.cminstance.focus()})),r.value="",c.value=">>> ",p.value=1},F=e=>{if(0!==h.value.length)if("up"===e){u.value>0?u.value--:-1!==u.value&&u.value!==h.value.length||(u.value=h.value.length-1);const e=h.value[u.value]||"";if(d.value&&g.value?.cminstance){g.value.cminstance.setValue(e);const t=g.value.cminstance.getDoc(),o=t.lastLine(),i=t.getLine(o).length;t.setCursor(o,i)}else r.value=e}else if("down"===e)if(u.value<h.value.length-1){u.value++;const e=h.value[u.value]||"";if(d.value&&g.value?.cminstance){g.value.cminstance.setValue(e);const t=g.value.cminstance.getDoc(),o=t.lastLine(),i=t.getLine(o).length;t.setCursor(o,i)}else r.value=e}else u.value=h.value.length,d.value&&g.value?.cminstance?g.value.cminstance.setValue(""):r.value=""},R=()=>{if(!r.value.trim()&&!s.value)return;const o=r.value;w(o,"user-input"),r.value="",s.value=!1,n.value="",p.value=1,t("send-input",{programId:e.item.id,input:o,isRepl:!1})},E=()=>{r.value="",s.value=!1,n.value="",p.value=1,t("send-input",{programId:e.item.id,input:"",isRepl:!1})},x=()=>{o.value=[],a.value=null,d.value||(h.value=[],u.value=-1),ye.nk.success("Console cleared")},j=()=>{d.value&&S(),t("stop-item",e.item.id)},$=()=>{m.value&&(m.value.scrollTop=m.value.scrollHeight)},D=e=>{const t=document.createElement("a");t.href=`data:image/png;base64,${e}`,t.download=`figure_${Date.now()}.png`,t.click()},T=e=>{const t=`data:image/png;base64,${e}`;window.open(t,"_blank")},M=()=>{const e=o.value.map(e=>"text"===e.type||"error"===e.type||"system"===e.type?e.content:"input-prompt"===e.type?`Prompt: ${e.content}`:"user-input"===e.type?`> ${e.content}`:"repl-input"===e.type?`${e.prompt}${e.content}`:"repl-output"===e.type?e.content:"").join("\n"),t=new Blob([e],{type:"text/plain"}),i=URL.createObjectURL(t),s=document.createElement("a");s.href=i,s.download=`console_output_${Date.now()}.txt`,s.click(),URL.revokeObjectURL(i),ye.nk.success("Output exported")},N=e=>{0===e.code?e.data&&void 0!==e.data.stdout&&w(e.data.stdout,"text"):1===e.code?e.data&&e.data.stdout&&w(e.data.stdout,"error"):2e3===e.code?e.data&&void 0!==e.data.prompt&&I(e.data.prompt):3e3===e.code?e.data&&e.data.figure&&k(e.data.figure):4e3===e.code?e.data&&e.data.error&&(a.value=1):5e3===e.code&&e.data&&"repl"===e.data.mode&&P()};return(0,i.wB)(()=>e.item.resultList,e=>{if(e&&e.length>0){const t=e[e.length-1];N(t)}},{deep:!0}),(0,i.wB)(()=>e.item.run,t=>{t?(l.value=e.item.name||"program",a.value=null):d.value&&S()}),{outputLines:o,waitingForInput:s,currentPrompt:n,userInput:r,lastExitCode:a,currentProgram:l,isReplMode:d,replPrompt:c,inputRows:p,consoleOutput:m,inputField:f,replEditor:g,replCodeMirrorOptions:v,executeReplCommand:L,handleKeyDown:C,sendInput:R,cancelInput:E,clearConsole:x,stopProgram:j,exportOutput:M,downloadFigure:D,openFigureInNewTab:T}}});const Jd=(0,k.A)(Qd,[["render",Hd],["__scopeId","data-v-51b3f28c"]]);var Yd=Jd,Zd=o(45572),ec=o(14188);function tc(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var oc=tc,ic=o(66318);function sc(e,t,o){var i=-1,s=e.length;t<0&&(t=-t>s?0:s+t),o=o>s?s:o,o<0&&(o+=s),s=t>o?0:o-t>>>0,t>>>=0;var n=Array(s);while(++i<s)n[i]=e[i+t];return n}var nc=sc;function rc(e,t){return t.length<2?e:(0,ic.A)(e,nc(t,0,-1))}var ac=rc,lc=o(30901);function dc(e,t){return t=(0,ec.A)(t,e),e=ac(e,t),null==e||delete e[(0,lc.A)(oc(t))]}var cc=dc,hc=o(88496),uc="[object Object]",pc=Function.prototype,mc=Object.prototype,fc=pc.toString,gc=mc.hasOwnProperty,vc=fc.call(Object);function yc(e){if(!(0,ln.A)(e)||(0,hc.A)(e)!=uc)return!1;var t=os(e);if(null===t)return!0;var o=gc.call(t,"constructor")&&t.constructor;return"function"==typeof o&&o instanceof o&&fc.call(o)==vc}var wc=yc;function bc(e){return wc(e)?void 0:e}var kc=bc,Ic=o(14007),Pc=1,Sc=2,Cc=4,Lc=(0,Ic.A)(function(e,t){var o={};if(null==e)return o;var i=!1;t=(0,Zd.A)(t,function(t){return t=(0,ec.A)(t,e),i||(i=t.length>1),t}),Ii(e,us(e),o),i&&(o=er(o,Pc|Sc|Cc,kc));var s=t.length;while(s--)cc(o,t[s]);return o}),Fc=Lc,Rc=o(91361),Ec=o(48548);const xc=Symbol("tabsRootContextKey");var jc=o(51254);const $c=(0,zt.b_)({tabs:{type:(0,zt.jq)(Array),default:()=>(0,jc.f)([])},tabRefs:{type:(0,zt.jq)(Object),default:()=>(0,jc.f)({})}});var Dc=o(69527);const Tc="ElTabBar",Mc=(0,i.pM)({name:Tc}),Nc=(0,i.pM)({...Mc,props:$c,setup(e,{expose:t}){const o=e,s=(0,i.WQ)(xc);s||(0,lo.$)(Tc,"<el-tabs><el-tab-bar /></el-tabs>");const r=(0,Ht.DU)("tabs"),a=(0,Ut.KR)(),l=(0,Ut.KR)(),d=()=>{let e=0,t=0;const i=["top","bottom"].includes(s.props.tabPosition)?"width":"height",n="width"===i?"x":"y",r="x"===n?"left":"top";return o.tabs.every(s=>{if((0,eo.b0)(s.paneName))return!1;const n=o.tabRefs[s.paneName];if(!n)return!1;if(!s.active)return!0;e=n[`offset${(0,Dc.ZH)(r)}`],t=n[`client${(0,Dc.ZH)(i)}`];const a=window.getComputedStyle(n);return"width"===i&&(t-=Number.parseFloat(a.paddingLeft)+Number.parseFloat(a.paddingRight),e+=Number.parseFloat(a.paddingLeft)),!1}),{[i]:`${t}px`,transform:`translate${(0,Dc.ZH)(n)}(${e}px)`}},c=()=>l.value=d(),h=[],u=()=>{h.forEach(e=>e.stop()),h.length=0,Object.values(o.tabRefs).forEach(e=>{h.push((0,ar.wYm)(e,c))})};(0,i.wB)(()=>o.tabs,async()=>{await(0,i.dY)(),c(),u()},{immediate:!0});const p=(0,ar.wYm)(a,()=>c());return(0,i.xo)(()=>{h.forEach(e=>e.stop()),h.length=0,p.stop()}),t({ref:a,update:c}),(e,t)=>((0,i.uX)(),(0,i.CE)("div",{ref_key:"barRef",ref:a,class:(0,n.C4)([(0,Ut.R1)(r).e("active-bar"),(0,Ut.R1)(r).is((0,Ut.R1)(s).props.tabPosition)]),style:(0,n.Tr)(l.value)},null,6))}});var _c=(0,Kt.A)(Nc,[["__file","tab-bar.vue"]]),Ac=o(53344);const Wc=(0,zt.b_)({panes:{type:(0,zt.jq)(Array),default:()=>(0,jc.f)([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),Oc={tabClick:(e,t,o)=>o instanceof Event,tabRemove:(e,t)=>t instanceof Event},Vc="ElTabNav",Uc=(0,i.pM)({name:Vc,props:Wc,emits:Oc,setup(e,{expose:t,emit:o}){const s=(0,i.WQ)(xc);s||(0,lo.$)(Vc,"<el-tabs><tab-nav /></el-tabs>");const n=(0,Ht.DU)("tabs"),r=(0,ar.fho)(),a=(0,ar.esz)(),l=(0,Ut.KR)(),d=(0,Ut.KR)(),c=(0,Ut.KR)(),h=(0,Ut.KR)({}),u=(0,Ut.KR)(),p=(0,Ut.KR)(!1),m=(0,Ut.KR)(0),f=(0,Ut.KR)(!1),g=(0,Ut.KR)(!0),v=(0,Ut.IJ)(),y=(0,i.EW)(()=>["top","bottom"].includes(s.props.tabPosition)?"width":"height"),w=(0,i.EW)(()=>{const e="width"===y.value?"X":"Y";return{transform:`translate${e}(-${m.value}px)`}}),b=()=>{if(!l.value)return;const e=l.value[`offset${(0,Dc.ZH)(y.value)}`],t=m.value;if(!t)return;const o=t>e?t-e:0;m.value=o},k=()=>{if(!l.value||!d.value)return;const e=d.value[`offset${(0,Dc.ZH)(y.value)}`],t=l.value[`offset${(0,Dc.ZH)(y.value)}`],o=m.value;if(e-o<=t)return;const i=e-o>2*t?o+t:e-t;m.value=i},I=async()=>{const t=d.value;if(!p.value||!c.value||!l.value||!t)return;await(0,i.dY)();const o=h.value[e.currentName];if(!o)return;const n=l.value,r=["top","bottom"].includes(s.props.tabPosition),a=o.getBoundingClientRect(),u=n.getBoundingClientRect(),f=r?t.offsetWidth-u.width:t.offsetHeight-u.height,g=m.value;let v=g;r?(a.left<u.left&&(v=g-(u.left-a.left)),a.right>u.right&&(v=g+a.right-u.right)):(a.top<u.top&&(v=g-(u.top-a.top)),a.bottom>u.bottom&&(v=g+(a.bottom-u.bottom))),v=Math.max(v,0),m.value=Math.min(v,f)},P=()=>{var t;if(!d.value||!l.value)return;e.stretch&&(null==(t=u.value)||t.update());const o=d.value[`offset${(0,Dc.ZH)(y.value)}`],i=l.value[`offset${(0,Dc.ZH)(y.value)}`],s=m.value;i<o?(p.value=p.value||{},p.value.prev=s,p.value.next=s+i<o,o-s<i&&(m.value=o-i)):(p.value=!1,s>0&&(m.value=0))},S=e=>{let t=0;switch(e.code){case Ac.R.left:case Ac.R.up:t=-1;break;case Ac.R.right:case Ac.R.down:t=1;break;default:return}const o=Array.from(e.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)")),i=o.indexOf(e.target);let s=i+t;s<0?s=o.length-1:s>=o.length&&(s=0),o[s].focus({preventScroll:!0}),o[s].click(),C()},C=()=>{g.value&&(f.value=!0)},L=()=>f.value=!1,F=(e,t)=>{h.value[t]=e},R=async()=>{await(0,i.dY)();const t=h.value[e.currentName];null==t||t.focus({preventScroll:!0})};return(0,i.wB)(r,e=>{"hidden"===e?g.value=!1:"visible"===e&&setTimeout(()=>g.value=!0,50)}),(0,i.wB)(a,e=>{e?setTimeout(()=>g.value=!0,50):g.value=!1}),(0,ar.wYm)(c,P),(0,i.sV)(()=>setTimeout(()=>I(),0)),(0,i.$u)(()=>P()),t({scrollToActiveTab:I,removeFocus:L,focusActiveTab:R,tabListRef:d,tabBarRef:u,scheduleRender:()=>(0,Ut.mu)(v)}),()=>{const t=p.value?[(0,i.bF)("span",{class:[n.e("nav-prev"),n.is("disabled",!p.value.prev)],onClick:b},[(0,i.bF)(Rc.tk,null,{default:()=>[(0,i.bF)(Ec.nkM,null,null)]})]),(0,i.bF)("span",{class:[n.e("nav-next"),n.is("disabled",!p.value.next)],onClick:k},[(0,i.bF)(Rc.tk,null,{default:()=>[(0,i.bF)(Ec.Qpb,null,null)]})])]:null,r=e.panes.map((t,r)=>{var a,l,d,c;const h=t.uid,u=t.props.disabled,p=null!=(l=null!=(a=t.props.name)?a:t.index)?l:`${r}`,m=!u&&(t.isClosable||e.editable);t.index=`${r}`;const g=m?(0,i.bF)(Rc.tk,{class:"is-icon-close",onClick:e=>o("tabRemove",t,e)},{default:()=>[(0,i.bF)(Ec.bm,null,null)]}):null,v=(null==(c=(d=t.slots).label)?void 0:c.call(d))||t.props.label,y=!u&&t.active?0:-1;return(0,i.bF)("div",{ref:e=>F(e,p),class:[n.e("item"),n.is(s.props.tabPosition),n.is("active",t.active),n.is("disabled",u),n.is("closable",m),n.is("focus",f.value)],id:`tab-${p}`,key:`tab-${h}`,"aria-controls":`pane-${p}`,role:"tab","aria-selected":t.active,tabindex:y,onFocus:()=>C(),onBlur:()=>L(),onClick:e=>{L(),o("tabClick",t,p,e)},onKeydown:e=>{!m||e.code!==Ac.R.delete&&e.code!==Ac.R.backspace||o("tabRemove",t,e)}},[v,g])});return v.value,(0,i.bF)("div",{ref:c,class:[n.e("nav-wrap"),n.is("scrollable",!!p.value),n.is(s.props.tabPosition)]},[t,(0,i.bF)("div",{class:n.e("nav-scroll"),ref:l},[e.panes.length>0?(0,i.bF)("div",{class:[n.e("nav"),n.is(s.props.tabPosition),n.is("stretch",e.stretch&&["top","bottom"].includes(s.props.tabPosition))],ref:d,style:w.value,role:"tablist",onKeydown:S},[e.type?null:(0,i.bF)(_c,{ref:u,tabs:[...e.panes],tabRefs:h.value},null),r]):null])])}}});var zc=o(31069),Bc=o(51338);const Kc=(e,t,o)=>{const s=(0,Bc.CW)(e.subTree).filter(e=>{var o;return(0,i.vv)(e)&&(null==(o=e.type)?void 0:o.name)===t&&!!e.component}),n=s.map(e=>e.component.uid);return n.map(e=>o[e]).filter(e=>!!e)},Hc=(e,t)=>{const o=(0,Ut.IJ)({}),s=(0,Ut.IJ)([]),n=new WeakMap,r=e=>{o.value[e.uid]=e,(0,Ut.mu)(o),(0,i.sV)(()=>{const t=e.getVnode().el,i=t.parentNode;if(!n.has(i)){n.set(i,[]);const e=i.insertBefore.bind(i);i.insertBefore=(t,s)=>{const r=n.get(i).some(e=>t===e||s===e);return r&&(0,Ut.mu)(o),e(t,s)}}n.get(i).push(t)})},a=e=>{delete o.value[e.uid],(0,Ut.mu)(o);const t=e.getVnode().el,i=t.parentNode,s=n.get(i),r=s.indexOf(t);s.splice(r,1)},l=()=>{s.value=Kc(e,t,o.value)},d=e=>e.render(),c=(0,i.pM)({setup(e,{slots:t}){return()=>(l(),t.default?(0,i.h)(d,{render:t.default}):null)}});return{children:s,addChild:r,removeChild:a,ChildrenSorter:c}},Xc=(0,zt.b_)({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:(0,zt.jq)(Function),default:()=>!0},stretch:Boolean}),qc=e=>(0,n.Kg)(e)||(0,eo.Et)(e),Gc={[zc.l4]:e=>qc(e),tabClick:(e,t)=>t instanceof Event,tabChange:e=>qc(e),edit:(e,t)=>["remove","add"].includes(t),tabRemove:e=>qc(e),tabAdd:()=>!0},Qc=(0,i.pM)({name:"ElTabs",props:Xc,emits:Gc,setup(e,{emit:t,slots:o,expose:s}){var n;const r=(0,Ht.DU)("tabs"),a=(0,i.EW)(()=>["left","right"].includes(e.tabPosition)),{children:l,addChild:d,removeChild:c,ChildrenSorter:h}=Hc((0,i.nI)(),"ElTabPane"),u=(0,Ut.KR)(),p=(0,Ut.KR)(null!=(n=e.modelValue)?n:"0"),m=async(o,i=!1)=>{var s,n,r,a;if(p.value!==o&&!(0,eo.b0)(o))try{let d;if(e.beforeLeave){const t=e.beforeLeave(o,p.value);d=t instanceof Promise?await t:t}else d=!0;if(!1!==d){const e=null==(s=l.value.find(e=>e.paneName===p.value))?void 0:s.isFocusInsidePane();p.value=o,i&&(t(zc.l4,o),t("tabChange",o)),null==(r=null==(n=u.value)?void 0:n.removeFocus)||r.call(n),e&&(null==(a=u.value)||a.focusActiveTab())}}catch(d){}},f=(e,o,i)=>{e.props.disabled||(t("tabClick",e,i),m(o,!0))},g=(e,o)=>{e.props.disabled||(0,eo.b0)(e.props.name)||(o.stopPropagation(),t("edit",e.props.name,"remove"),t("tabRemove",e.props.name))},v=()=>{t("edit",void 0,"add"),t("tabAdd")},y=t=>{const o=t.el.firstChild,i=["bottom","right"].includes(e.tabPosition)?t.children[0].el:t.children[1].el;o!==i&&o.before(i)};return(0,i.wB)(()=>e.modelValue,e=>m(e)),(0,i.wB)(p,async()=>{var e;await(0,i.dY)(),null==(e=u.value)||e.scrollToActiveTab()}),(0,i.Gt)(xc,{props:e,currentName:p,registerPane:d,unregisterPane:c,nav$:u}),s({currentName:p,get tabNavRef(){return Fc(u.value,["scheduleRender"])}}),()=>{const t=o["add-icon"],s=e.editable||e.addable?(0,i.bF)("div",{class:[r.e("new-tab"),a.value&&r.e("new-tab-vertical")],tabindex:"0",onClick:v,onKeydown:e=>{[Ac.R.enter,Ac.R.numpadEnter].includes(e.code)&&v()}},[t?(0,i.RG)(o,"add-icon"):(0,i.bF)(Rc.tk,{class:r.is("icon-plus")},{default:()=>[(0,i.bF)(Ec.FWt,null,null)]})]):null,n=()=>(0,i.bF)(Uc,{ref:u,currentName:p.value,editable:e.editable,type:e.type,panes:l.value,stretch:e.stretch,onTabClick:f,onTabRemove:g},null),d=(0,i.bF)("div",{class:[r.e("header"),a.value&&r.e("header-vertical"),r.is(e.tabPosition)]},[(0,i.bF)(h,null,{default:n,$stable:!0}),s]),c=(0,i.bF)("div",{class:r.e("content")},[(0,i.RG)(o,"default")]);return(0,i.bF)("div",{class:[r.b(),r.m(e.tabPosition),{[r.m("card")]:"card"===e.type,[r.m("border-card")]:"border-card"===e.type}],onVnodeMounted:y,onVnodeUpdated:y},[c,d])}}});var Jc=Qc;const Yc=(0,zt.b_)({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),Zc="ElTabPane",eh=(0,i.pM)({name:Zc}),th=(0,i.pM)({...eh,props:Yc,setup(e){const t=e,o=(0,i.nI)(),r=(0,i.Ht)(),a=(0,i.WQ)(xc);a||(0,lo.$)(Zc,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const l=(0,Ht.DU)("tab-pane"),d=(0,Ut.KR)(),c=(0,Ut.KR)(),h=(0,i.EW)(()=>t.closable||a.props.closable),u=(0,sr.uA)(()=>{var e;return a.currentName.value===(null!=(e=t.name)?e:c.value)}),p=(0,Ut.KR)(u.value),m=(0,i.EW)(()=>{var e;return null!=(e=t.name)?e:c.value}),f=(0,sr.uA)(()=>!t.lazy||p.value||u.value),g=()=>{var e;return null==(e=d.value)?void 0:e.contains(document.activeElement)};(0,i.wB)(u,e=>{e&&(p.value=!0)});const v=(0,Ut.Kh)({uid:o.uid,getVnode:()=>o.vnode,slots:r,props:t,paneName:m,active:u,index:c,isClosable:h,isFocusInsidePane:g});return a.registerPane(v),(0,i.xo)(()=>{a.unregisterPane(v)}),(0,i.Ic)(()=>{var e;r.label&&(null==(e=a.nav$.value)||e.scheduleRender())}),(e,t)=>(0,Ut.R1)(f)?(0,i.bo)(((0,i.uX)(),(0,i.CE)("div",{key:0,id:`pane-${(0,Ut.R1)(m)}`,ref_key:"paneRef",ref:d,class:(0,n.C4)((0,Ut.R1)(l).b()),role:"tabpanel","aria-hidden":!(0,Ut.R1)(u),"aria-labelledby":`tab-${(0,Ut.R1)(m)}`},[(0,i.RG)(e.$slots,"default")],10,["id","aria-hidden","aria-labelledby"])),[[s.aG,(0,Ut.R1)(u)]]):(0,i.Q3)("v-if",!0)}});var oh=(0,Kt.A)(th,[["__file","tab-pane.vue"]]);const ih=(0,Qt.GU)(Jc,{TabPane:oh}),sh=(0,Qt.WM)(oh),nh={class:"noselected console-tabs"},rh=["src"],ah={class:"node-label"};function lh(e,t,o,s,r,a){const l=sh,d=ih;return(0,i.uX)(),(0,i.CE)("div",nh,[(0,i.bF)(d,{modelValue:a.pathSelected,"onUpdate:modelValue":t[0]||(t[0]=e=>a.pathSelected=e),type:"card",closable:"",onTabRemove:a.removeTab,onTabClick:a.selectTab},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.consoleItems,e=>((0,i.uX)(),(0,i.Wv)(l,{key:e.path+"-|-"+e.id,label:e.name,name:e.path+"-|-"+e.id},{label:(0,i.k6)(()=>[(0,i.Lk)("img",{src:a.getIconUrl(e.path),alt:"",class:"node-icon"},null,8,rh),(0,i.Lk)("span",ah,(0,n.v_)(a.getItemPath(e)),1)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue","onTabRemove","onTabClick"])])}var dh={data(){return{}},mounted(){},methods:{getItemPath(e){return this.ideInfo.consoleSelected.path!==e.path||this.ideInfo.consoleSelected.id!==e.id||"Terminal"===this.ideInfo.consoleSelected.name&&"Terminal"===this.ideInfo.consoleSelected.path?e.name:"/"+this.ideInfo.currProj.data.name+e.path},getIconUrl(e){return o(80238)(`./${(0,V.ry)(e.substring(e.lastIndexOf(".")+1))}`)},getItem(e){if(!e)return;const t=e.split("-|-");t[1]=Number(t[1]);for(let o=0;o<this.ideInfo.consoleItems.length;o++)if(this.ideInfo.consoleItems[o].path===t[0]&&this.ideInfo.consoleItems[o].id===t[1])return this.ideInfo.consoleItems[o];return""},selectTab(e){},removeTab(e){const t=this.getItem(e);t&&this.$emit("close-item",t)}},watch:{},computed:{ideInfo(){return this.$store.state.ide.ideInfo},consoleItems(){return this.ideInfo.consoleItems},pathSelected:{get(){return this.ideInfo.consoleSelected.path+"-|-"+this.ideInfo.consoleSelected.id},set(e){const t=this.getItem(e);t&&this.$emit("select-item",t)}}},components:{}};const ch=(0,k.A)(dh,[["render",lh],["__scopeId","data-v-109efd1e"]]);var hh=ch,uh=o(96763);const ph={data(){return{replMode:"auto",pyodideNamespace:null,pyodideInitialized:!1}},methods:{async startDualModeReplSession(){this.replSessionId=Date.now().toString(),uh.log("🚀 [REPL] Starting dual-mode REPL session:",this.replSessionId),uh.log("📊 [REPL] Current state:",{wsInfo:this.wsInfo,wsConnected:this.wsInfo?.connected,wsReadyState:this.wsInfo?.rws?.readyState,replMode:this.replMode,pyodideReady:this.pyodideReady,pyodideInitialized:this.pyodideInitialized}),this.ensureReplConsole();const e=this.wsInfo&&this.wsInfo.connected,t="backend"===this.replMode||"auto"===this.replMode&&e;uh.log("🔍 [REPL] Mode detection:",{backendAvailable:e,preferBackend:t,replMode:this.replMode}),t&&e?(uh.log("✅ [REPL] Using backend mode"),await this.startBackendRepl()):(uh.log("🌐 [REPL] Using Pyodide browser mode"),await this.startPyodideRepl())},async startBackendRepl(){uh.log("🔌 [REPL] Starting backend REPL...");try{const e={cmd:"start_python_repl",id:this.replSessionId,data:{projectName:this.ideInfo.currProj?.data?.name||"repl"}};if(uh.log("📤 [REPL] Sending start message:",e),uh.log("🔌 [REPL] WebSocket state:",{rws:this.wsInfo.rws,readyState:this.wsInfo.rws?.readyState,OPEN:WebSocket.OPEN}),!this.wsInfo.rws||this.wsInfo.rws.readyState!==WebSocket.OPEN)throw new Error(`WebSocket not connected: readyState=${this.wsInfo.rws?.readyState}`);this.wsInfo.rws.send(JSON.stringify(e)),uh.log("✅ [REPL] Start message sent successfully")}catch(lo){uh.error("❌ [REPL] Backend REPL failed:",lo),this.addReplOutput("Backend connection lost. Reconnecting...","system"),setTimeout(async()=>{this.wsInfo?.rws?.readyState===WebSocket.OPEN?(uh.log("🔄 [REPL] Retrying backend REPL after reconnection"),await this.startBackendRepl()):(uh.log("🌐 [REPL] Backend still unavailable, switching to browser mode"),this.addReplOutput("Backend unavailable, switching to browser mode...","error"),await this.startPyodideRepl())},2e3)}},async startPyodideRepl(){uh.log("🌐 [REPL] Starting Pyodide REPL, current state:",{pyodideReady:this.pyodideReady,pyodideInitialized:this.pyodideInitialized}),this.pyodideReady||(uh.log("🔄 [REPL] Pyodide not ready, initializing..."),await this.initializePyodideForRepl()),this.pyodideReady?uh.log("✅ [REPL] Pyodide ready for use"):(uh.log("❌ [REPL] Failed to initialize Pyodide"),this.addReplOutput("Failed to initialize browser Python","error"),this.isReplMode=!1)},async initializePyodideForRepl(){if(uh.log("🔄 [REPL] initializePyodideForRepl called, state:",{pyodideLoading:this.pyodideLoading,pyodideReady:this.pyodideReady,loadPyodideAvailable:typeof window.loadPyodide}),this.pyodideLoading||this.pyodideReady)uh.log("⚠️ [REPL] Pyodide already loading or ready, skipping");else{this.pyodideLoading=!0;try{if("function"!==typeof window.loadPyodide)throw new Error("Pyodide not available. Please check internet connection.");uh.log("📦 [REPL] Loading Pyodide from CDN..."),this.pyodide=await window.loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/v0.24.1/full/"}),this.pyodideNamespace=this.pyodide.globals.get("dict")(),await this.pyodide.runPythonAsync("\n          import sys\n          import io\n          import builtins\n          \n          # Store the version\n          python_version = sys.version\n          \n          # Setup for REPL\n          _ = None\n        "),this.pyodideReady=!0,this.pyodideLoading=!1,this.pyodideInitialized=!0,uh.log("✅ [REPL] Pyodide REPL ready!",{pyodide:this.pyodide,namespace:this.pyodideNamespace})}catch(lo){uh.error("❌ [REPL] Pyodide initialization failed:",lo),this.pyodideLoading=!1,this.pyodideReady=!1,this.addReplOutput(`Error: ${lo.message}`,"error")}}},async executeReplCommandDualMode(e){if(uh.log("🎯 [REPL] executeReplCommandDualMode called with:",e),!e.trim())return uh.log("⚠️ [REPL] Empty command, handling continuation mode"),void(this.replContinuationMode&&(this.replContinuationMode=!1,this.replPrompt=">>> "));this.replHistory[this.replHistory.length-1]!==e&&this.replHistory.push(e),this.replHistoryIndex=-1,this.replInput="",this.replInputRows=1,this.ideInfo.consoleSelected&&this.ideInfo.consoleSelected.id&&this.$store.commit("ide/addConsoleOutput",{id:this.ideInfo.consoleSelected.id,type:"repl-input",text:e,prompt:this.replPrompt});const t=this.wsInfo?.connected&&this.replSessionId&&"pyodide"!==this.replMode;uh.log("🔍 [REPL] Execution mode check:",{wsConnected:this.wsInfo?.connected,replSessionId:this.replSessionId,replMode:this.replMode,useBackend:t,pyodideReady:this.pyodideReady}),t?(uh.log("📤 [REPL] Executing via backend"),await this.executeBackendCommand(e)):this.pyodideReady?(uh.log("🌐 [REPL] Executing via Pyodide"),await this.executePyodideCommand(e)):(uh.log("⚠️ [REPL] No environment ready, initializing Pyodide..."),await this.startPyodideRepl(),this.pyodideReady?await this.executePyodideCommand(e):this.addReplOutput("No Python environment available","error"))},async executeBackendCommand(e){uh.log("📤 [REPL] executeBackendCommand called with:",e);try{const t={cmd:"send_program_input",id:Date.now().toString(),data:{program_id:this.replSessionId,input:e}};if(uh.log("📨 [REPL] Sending command message:",t),!this.wsInfo.rws||this.wsInfo.rws.readyState!==WebSocket.OPEN)throw new Error(`WebSocket disconnected: readyState=${this.wsInfo.rws?.readyState}`);this.wsInfo.rws.send(JSON.stringify(t)),uh.log("✅ [REPL] Command sent to backend")}catch(lo){uh.error("❌ [REPL] Backend execution failed:",lo),this.addReplOutput("Backend connection lost. Please restart REPL if needed.","system"),uh.log("⚠️ [REPL] Keeping backend mode, user can manually restart if needed")}},async executePyodideCommand(e){if(this.pyodideReady&&this.pyodide){try{await this.pyodide.runPythonAsync("\n          import sys\n          from io import StringIO\n          _stdout = StringIO()\n          _stderr = StringIO()\n          _old_stdout = sys.stdout\n          _old_stderr = sys.stderr\n          sys.stdout = _stdout\n          sys.stderr = _stderr\n        ");let o=null,i=null;try{o=await this.pyodide.runPythonAsync(e,{globals:this.pyodideNamespace}),void 0!==o&&null!==o&&await this.pyodide.runPythonAsync("_ = _result",{globals:{...this.pyodideNamespace.toJs(),_result:o}})}catch(lo){i=lo}const s=await this.pyodide.runPythonAsync("\n          sys.stdout = _old_stdout\n          sys.stderr = _old_stderr\n          stdout_val = _stdout.getvalue()\n          stderr_val = _stderr.getvalue()\n          _stdout.close()\n          _stderr.close()\n          (stdout_val, stderr_val)\n        ");if(s[0]&&this.addReplOutput(s[0],"output"),s[1]&&this.addReplOutput(s[1],"error"),i)this.addReplOutput(String(i),"error");else if(void 0!==o&&null!==o){const e=this.pyodide.globals.get("None");if(o!==e)try{const e=await this.pyodide.runPythonAsync("repr(_last_val)",{globals:{...this.pyodideNamespace.toJs(),_last_val:o}});e&&"None"!==e&&this.addReplOutput(e,"output")}catch(t){const e=String(o);e&&"[object Object]"!==e&&this.addReplOutput(e,"output")}}this.replContinuationMode=!1,this.replPrompt=">>> "}catch(lo){uh.error("Pyodide execution error:",lo),this.addReplOutput(`Error: ${lo.message}`,"error")}this.$nextTick(()=>{this.$refs.consoleOutputArea&&(this.$refs.consoleOutputArea.scrollTop=this.$refs.consoleOutputArea.scrollHeight)})}else this.addReplOutput("Browser Python not ready","error")},handleBackendReplResponse(e){if(uh.log("📥 [REPL] Backend response received:",{code:e?.code,hasData:!!e?.data,dataKeys:e?.data?Object.keys(e.data):[],fullMessage:e}),e){if(0===e.code||"0"===e.code){if(e.data){if(e.data.stdout){const t=e.data.stdout,o=t.match(/^(>>>|\.\.\.)\s*$/)||t.match(/^(>>>|\.\.\.)\s*\n*$/)||">>>"===t.trim()||"..."===t.trim()||""===t.trim()||">>> "===t||"... "===t||t.match(/^\s*>>>\s*$/)||t.match(/^\s*\.\.\.\s*$/)||t.match(/^>>>\s*\n*$/)||t.match(/^\.\.\.\s*\n*$/);o||""===t.trim()||this.addReplOutput(t,"output")}e.data.stderr&&this.addReplOutput(e.data.stderr,"error")}}else 2e3===e.code?"repl_prompt"===e.data?.type?(this.replPrompt=">>> ",this.replContinuationMode=!1):e.data?.stdout&&this.addReplOutput(e.data.stdout,"output"):1111===e.code&&(this.addReplOutput("Backend session ended","system"),this.replSessionId=null,this.addReplOutput("Switching to browser mode...","system"),this.startPyodideRepl());this.$nextTick(()=>{this.$refs.consoleOutputArea&&(this.$refs.consoleOutputArea.scrollTop=this.$refs.consoleOutputArea.scrollHeight)})}else uh.log("⚠️ [REPL] Empty message received")},async stopDualModeReplSession(){if(this.replSessionId&&this.wsInfo?.rws?.readyState===WebSocket.OPEN){const e={cmd:"stop_python_program",id:Date.now().toString(),data:{program_id:this.replSessionId}};this.wsInfo.rws.send(JSON.stringify(e))}this.replSessionId=null,this.isReplMode=!1,this.replPrompt=">>> ",this.replContinuationMode=!1,this.pyodideNamespace&&(this.pyodideNamespace=this.pyodide?.globals.get("dict")())}}};var mh=ph,fh=o(96763);const gh=o(57975);var vh={data(){return{showDeleteDialog:!1,showFileDialog:!1,showProjsDialog:!1,showUploadDialog:!1,showNewFileDialog:!1,showNewFolderDialog:!1,showFileBrowserDialog:!1,showLoginModal:!1,fileBrowserMode:"open",fileToMove:null,showSettingsModal:!1,showKeyboardShortcutsModal:!1,showFindReplaceModal:!1,findReplaceMode:"find",showREPL:!1,isReplMode:!1,replSessionId:null,showCover:!0,showContextMenu:!1,contextMenuPosition:{x:0,y:0},contextMenuTarget:null,windowWidth:window.innerWidth,leftSidebarVisible:!0,currentUser:null,dialogType:"",dialogTitle:"",dialogTips:"",dialogText:"",leftSidebarWidth:250,rightSidebarWidth:400,rightSidebarVisible:!1,consoleHeight:200,consoleExpanded:!0,consoleMaximized:!1,previousConsoleHeight:200,rightPanelExpanded:!1,previousRightWidth:400,rightPanelMode:"closed",consoleMode:"collapsed",consolePreviousMode:"normal",wasConsoleOpenBeforeRightExpand:!1,fileConsoleStates:{},activeFilePath:null,rightPanelState:"normal",rightPanelNormalWidth:400,previousConsoleState:{expanded:!0,height:200},editorHeight:"calc(100% - 235px)",minEditorWidth:500,isResizingLeft:!1,isResizingRight:!1,isResizingConsole:!1,startX:0,startY:0,startWidth:0,startHeight:0,resizeWarning:!1,programInput:"",programInputRows:1,wordWrap:!0,replInput:"",replHistory:[],replHistoryIndex:-1,replPrompt:">>> ",replInputRows:1,replContinuationMode:!1,previewTabs:[],selectedPreviewTab:null,previewTabCounter:0,terminalOutput:[],terminalSessionActive:!1,pyodide:null,pyodideLoading:!1,pyodideReady:!1,replMode:"auto",pyodideNamespace:null,pyodideInitialized:!1,wsMessageHandler:null}},mixins:[mh],components:{Splitpanes:ad.S,Pane:ad.Z,TwoHeaderMenu:ol,CodeTabs:tt.A,HybridConsole:Yd,ConsoleTabs:hh,ProjTree:pt.A,IdeEditor:et.A,LoginModal:P,PythonREPL:S.A,DialogProjs:Je.A,DialogText:Qe.A,DialogDelete:Ge.A,DialogUpload:qe.A,DialogNewFile:Xe,DialogNewFolder:Ie,DialogFileBrowser:K,CsvViewer:Ye.A,MediaViewer:Ze.A,SettingsModal:Vt.A,KeyboardShortcutsModal:Ot,FindReplaceModal:Tt,FullscreenPreview:ut,ChevronLeft:ld.A,ChevronRight:me.A,ChevronUp:jt,ChevronDown:fe.A,Minimize2:dd},created(){},mounted(){this.throttledHandleResizeLeft=this.throttle(this.handleResizeLeft,16),this.throttledHandleResizeRight=this.throttle(this.handleResizeRight,16),this.throttledHandleResizeConsole=this.throttle(this.handleResizeConsole,16);const e=localStorage.getItem("session_id"),t=localStorage.getItem("username");if(!e||!t)return void fh.log("🔒 [VmIde] No session found, user needs to login");fh.log("🔑 [VmIde] Found existing session for:",t),this.currentUser={username:t,role:localStorage.getItem("role"),full_name:localStorage.getItem("full_name"),session_id:e};try{fh.log("🔌 [VmIde] Initializing WebSocket with authentication..."),this.wsInfo&&this.wsInfo.rws?fh.log("ℹ️ [VmIde] WebSocket already initialized"):(this.$store.dispatch("websocket/init",{}),fh.log("✅ [VmIde] WebSocket initialization dispatched"))}catch(lo){fh.error("❌ [VmIde] Error initializing WebSocket:",lo)}this.rightPanelMode="closed",this.consoleMode="collapsed",this.$nextTick(()=>{setTimeout(()=>{try{this.setupWebSocketHandler()}catch(lo){fh.error("Error in setupWebSocketHandler:",lo)}},500)}),this.loadLayoutPreferences(),window.addEventListener("resize",this.validateLayout);const o=this;if(e&&t){const e=setInterval(()=>{fh.log("⏱️ [VmIde] WebSocket check:",{connected:o.wsInfo.connected,wsInfo:o.wsInfo}),o.wsInfo.connected&&(fh.log("📡 [VmIde] WebSocket connected, listing projects..."),this.$store.dispatch(`ide/${ve.qB}`,{callback:t=>{fh.log("📋 [VmIde] Project list response:",t),clearInterval(e),0==t.code?(fh.log("✅ [VmIde] Projects found:",t.data),this.$store.commit("ide/handleProjects",t.data),o.loadAllDefaultProjects()):fh.error("❌ [VmIde] Failed to list projects:",t)}}))},1e3)}window.addEventListener("resize",this.resize),this.$nextTick(()=>{this.applyInitialEditorSettings()})},beforeUnmount(){window.removeEventListener("resize",this.validateLayout),window.removeEventListener("resize",this.resize),this.wsMessageHandler&&(this.wsMessageHandler=null),this.previewTabs.forEach(e=>{"pdf"===e.type&&e.content&&e.content.startsWith("blob:")&&URL.revokeObjectURL(e.content)})},computed:{wsInfo(){return this.$store.getters["websocket/wsInfo"]()},ideInfo(){return this.$store.state.ide.ideInfo},currentUser(){const e=this.$store.state.ide.currentUser;if(e)return e;try{const e=localStorage.getItem("user");return e?JSON.parse(e):null}catch(t){return null}},isMarkdown(){return!!this.ideInfo.codeSelected.path&&this.ideInfo.codeSelected.path.endsWith(".md")},isMediaFile(){if(this.ideInfo.codeSelected.path){const e=[".png",".jpg",".jpeg",".gif",".bmp",".svg",".webp",".pdf"],t=this.ideInfo.codeSelected.path.toLowerCase();return e.some(e=>t.endsWith(e))}return!1},consoleLimit(){let e=0;for(let t=0;t<this.ideInfo.consoleItems.length;t++)!0!==this.ideInfo.consoleItems[t].run||"Terminal"===this.ideInfo.consoleItems[t].name&&"Terminal"===this.ideInfo.consoleItems[t].path||(e+=1);return e>=3},hasRunProgram(){return this.ideInfo.consoleItems.some(e=>e.run)},showConsole(){const e=0!==this.ideInfo.consoleItems.length;return e},leftSidebarSize(){if(this.windowWidth<=900)return 0;let e=20;if(this.windowWidth<=1400&&this.windowWidth>1200){const t=Math.min(250,.2*this.windowWidth);e=t/this.windowWidth*100}else this.windowWidth<=1200&&(e=180/this.windowWidth*100);return this.leftSidebarVisible?e:.1},leftSidebarMinSize(){return this.windowWidth<=900?0:.1},leftSidebarMaxSize(){return this.windowWidth<=900?0:this.windowWidth<=1400&&this.windowWidth>1200?30:40},rightSidebarSize(){if(this.windowWidth<=900)return 0;if(this.windowWidth<=1200)return 0;if(0===this.previewTabs.length)return 0;if("closed"===this.rightPanelMode)return 0;if("expanded"===this.rightPanelMode){const e=this.leftSidebarVisible?20:0;return 100-e-10}return 30},rightSidebarMinSize(){return this.windowWidth<=1200?0:.1},rightSidebarMaxSize(){return this.windowWidth<=900||this.windowWidth<=1200?0:50},centerSize(){if(this.windowWidth<=900)return 100;if(this.windowWidth<=1200){const e=this.leftSidebarVisible?this.windowWidth<=1200?180/this.windowWidth*100:20:0;return 100-e}const e=this.leftSidebarVisible?this.leftSidebarSize:0,t=this.rightSidebarSize;return 0===t?100-e:Math.max(30,100-e-t)},editorPaneSize(){return"maximized"===this.consoleMode?5:"collapsed"===this.consoleMode?95:70},consolePaneSize(){return"maximized"===this.consoleMode?95:"collapsed"===this.consoleMode?5:30}},watch:{"previewTabs.length":function(e,t){0===e&&t>0&&(this.rightPanelMode="closed",this.rightSidebarVisible=!1)},"ideInfo.codeSelected":function(e,t){e&&t&&e.path&&t.path&&e.path!==t.path?this.handleTabChange(e,t):e&&!t&&(this.activeFilePath=e.path,this.loadFileConsoleState(e.path))},"ideInfo.consoleSelected.waitingForInput":function(e){e&&this.$nextTick(()=>{this.$refs.programInputField&&this.$refs.programInputField.focus()})},consoleExpanded(e){e&&this.$nextTick(()=>{this.$refs.consoleOutputArea&&(this.$refs.consoleOutputArea.scrollTop=this.$refs.consoleOutputArea.scrollHeight)})}},methods:{throttle(e,t){let o=0,i=null;const s=this;return function(...n){const r=Date.now();r-o>=t?(e.apply(s,n),o=r):i||(i=requestAnimationFrame(()=>{e.apply(s,n),o=Date.now(),i=null}))}},toggleLeftSidebar(e){this.leftSidebarVisible=e},applyInitialEditorSettings(){const e=localStorage.getItem("fontSize");e&&this.updateFontSize(e);const t=localStorage.getItem("showLineNumbers");null!==t&&this.updateLineNumbers("true"===t)},updateFontSize(e){const t=parseInt(e)+"px",o=document.querySelectorAll(".CodeMirror");o.forEach(e=>{e.CodeMirror&&(e.style.fontSize=t,e.CodeMirror.refresh())});const i=document.getElementById("codemirror-font-size")||document.createElement("style");i.id="codemirror-font-size",i.innerHTML=`.CodeMirror { font-size: ${t} !important; } .CodeMirror pre { font-size: ${t} !important; }`,document.getElementById("codemirror-font-size")||document.head.appendChild(i),localStorage.setItem("editorFontSize",e)},updateLineNumbers(e){const t=document.querySelectorAll(".CodeMirror");t.forEach(t=>{t.CodeMirror&&t.CodeMirror.setOption("lineNumbers",e)}),localStorage.setItem("editorLineNumbers",e),this.$store.commit("ide/setEditorOption",{option:"lineNumbers",value:e})},updateWordWrap(e){this.wordWrap=e,this.$store.commit("ide/setEditorOption",{option:"lineWrapping",value:e})},updateAutoSave(e){this.$store.commit("ide/setAutoSave",e),e?this.startAutoSave():this.stopAutoSave()},updateAutoSaveInterval(e){this.$store.commit("ide/setAutoSaveInterval",e),this.$store.state.ide.autoSave&&(this.stopAutoSave(),this.startAutoSave())},startAutoSave(){this.autoSaveTimer&&clearInterval(this.autoSaveTimer);const e=this.$store.state.ide.autoSaveInterval||60;this.autoSaveTimer=setInterval(()=>{this.saveAllFiles()},1e3*e)},stopAutoSave(){this.autoSaveTimer&&(clearInterval(this.autoSaveTimer),this.autoSaveTimer=null)},saveAllFiles(){this.ideInfo.codeItems.forEach(e=>{e.changed&&this.saveFile(e)})},toggleConsoleExpand(){this.consoleExpanded=!this.consoleExpanded,this.updateEditorHeight(),localStorage.setItem("console-expanded",this.consoleExpanded)},updateEditorHeight(){if(this.consoleExpanded){const e=window.innerHeight-300,t=Math.min(this.consoleHeight,e);this.editorHeight=`calc(100% - ${t+35}px)`}else this.editorHeight="calc(100% - 35px)"},clearConsole(){const e=this.ideInfo.consoleSelected;e&&e.resultList&&this.$store.commit("ide/clearConsoleOutput",e.id),this.programInput="",this.programInputRows=1},toggleWordWrap(){this.wordWrap=!this.wordWrap,localStorage.setItem("word-wrap",this.wordWrap)},openREPL(){this.toggleReplMode()},closeREPL(){this.showREPL=!1},async toggleReplMode(){this.isReplMode?(this.replSessionId&&await this.stopReplSession(),this.isReplMode=!1,this.replPrompt=">>> ",this.replInput="",this.replInputRows=1):(this.isReplMode=!0,this.clearConsole(),this.consoleExpanded||(this.consoleExpanded=!0),await this.startReplSession(),this.$nextTick(()=>{this.$refs.replInputField&&this.$refs.replInputField.focus()}))},async startReplSession(){this.ideInfo.consoleSelected&&this.addReplOutput("Type Python code and press Enter to execute","system"),await this.startDualModeReplSession()},async stopReplSession(){await this.stopDualModeReplSession()},getPythonVersion(){return"3.x"},setupWebSocketHandler(){try{if(!this.wsInfo||!this.wsInfo.rws)return fh.log("WebSocket not ready, retrying..."),void setTimeout(()=>this.setupWebSocketHandler(),500);const e=e=>{try{const t=JSON.parse(e.data);fh.log("📥 [VmIde] ALL WebSocket msg:",{id:t.id,cmd_id:t.cmd_id,code:t.code,cmd:t.cmd,programId:t.data?.program_id,ourSessionId:this.replSessionId,fullMsg:t});const o=t.id===this.replSessionId||t.cmd_id===this.replSessionId||t.data&&t.data.program_id===this.replSessionId||this.isReplMode&&this.replSessionId&&(0===t.code||2e3===t.code||1111===t.code)&&t.data&&(t.data.stdout||t.data.stderr||t.data.program_id);if(fh.log(`🔍 Match check: id=${t.id===this.replSessionId}, cmd_id=${t.cmd_id===this.replSessionId}, prog_id=${t.data?.program_id===this.replSessionId}, isReplMode=${this.isReplMode}, code=${t.code}`),o)return fh.log("🎯 REPL message matched - routing to REPL handler only!"),void this.handleReplResponse(t)}catch(t){}};this.$store.commit("websocket/addEventListener",{wsKey:"default",type:"message",listener:e}),this.wsMessageHandler=e,fh.log("WebSocket handler for REPL set up successfully")}catch(lo){fh.error("Error setting up WebSocket handler:",lo)}},handleReplMessage(e){fh.log("Handling REPL message:",e),this.handleReplResponse(e)},handleReplResponse(e){if(fh.log("🎯 [REPL] Processing REPL response:",e),fh.log("🎯 [REPL] Response code:",e?.code,"Data keys:",e?.data?Object.keys(e.data):"no data"),e){if(0===e.code||"0"===e.code){if(e.data){if(e.data.stdout){const t=e.data.stdout;fh.log("🔍 [REPL] Processing stdout:",JSON.stringify(t)),t.match(/^(>>>|\.\.\.)\s*$/)||""===t.trim()?""===t.trim()&&this.addReplOutput("","output"):this.addReplOutput(t,"output")}e.data.stderr&&this.addReplOutput(e.data.stderr,"error"),e.data.output&&this.addReplOutput(e.data.output,"output")}}else if(2e3===e.code)fh.log("Input request received:",e.data),e.data&&e.data.prompt&&this.addReplOutput(e.data.prompt,"output");else if(5e3===e.code)fh.log("Entering REPL mode after script execution"),this.isReplMode=!0;else if(1111===e.code||"python_ended"===e.cmd)this.addReplOutput("\nREPL session ended","system"),this.isReplMode=!1,this.replSessionId=null,this.replPrompt=">>> ";else if(-1===e.code||e.error){const t=e.error||e.data?.error||"Unknown error";this.addReplOutput("Error: "+t,"error")}this.$nextTick(()=>{this.$refs.consoleOutputArea&&(this.$refs.consoleOutputArea.scrollTop=this.$refs.consoleOutputArea.scrollHeight)})}},toggleRightSidebar(){(this.previewTabs.length>0||this.rightSidebarVisible)&&(this.rightSidebarVisible=!this.rightSidebarVisible,localStorage.setItem("right-sidebar-visible",this.rightSidebarVisible))},expandRightPanel(){if(!this.rightPanelExpanded){this.previousRightWidth=this.rightSidebarWidth;const e=window.innerWidth,t=this.leftSidebarVisible?this.leftSidebarWidth:0;this.rightSidebarWidth=e-t-10,this.rightPanelExpanded=!0,this.consoleExpanded&&(this.consoleExpanded=!1,this.consoleMaximized=!1,this.updateEditorHeight())}},collapseRightPanel(){this.rightPanelExpanded?(this.rightSidebarWidth=this.previousRightWidth,this.rightPanelExpanded=!1,this.previousConsoleHeight>0&&(this.consoleExpanded=!0,this.updateEditorHeight())):this.rightSidebarWidth=300},handleLeftArrowClick(){"normal"===this.rightPanelMode&&(this.wasConsoleOpenBeforeRightExpand="collapsed"!==this.consoleMode,this.consoleMode="collapsed",this.consoleExpanded=!1,this.consoleMaximized=!1,this.rightPanelMode="expanded",this.rightSidebarVisible=!0,this.saveLayoutPreferences())},handleRightArrowClick(){"expanded"===this.rightPanelMode?(this.rightPanelMode="normal",this.wasConsoleOpenBeforeRightExpand&&(this.consoleMode="normal",this.consoleExpanded=!0)):"normal"===this.rightPanelMode&&(this.rightPanelMode="closed",this.rightSidebarVisible=!1),this.saveLayoutPreferences()},expandRightPanelToFull(){"normal"===this.rightPanelState&&(this.rightPanelNormalWidth=this.rightSidebarWidth),this.previousConsoleState.expanded=this.consoleExpanded,this.previousConsoleState.height=this.consoleHeight,this.consoleExpanded=!1,this.consoleMaximized=!1;const e=window.innerWidth,t=this.leftSidebarVisible?this.leftSidebarWidth:0;this.rightSidebarWidth=e-t-10,this.rightPanelState="expanded",this.rightPanelExpanded=!0,this.rightSidebarVisible=!0,this.updateEditorHeight(),this.saveLayoutPreferences()},collapseRightPanelCompletely(){"normal"===this.rightPanelState&&(this.rightPanelNormalWidth=this.rightSidebarWidth),this.rightSidebarVisible=!1,this.rightPanelState="collapsed",this.rightPanelExpanded=!1,this.saveLayoutPreferences()},restoreRightPanelToNormal(){this.rightSidebarWidth=this.rightPanelNormalWidth||400,this.rightSidebarVisible=!0,this.rightPanelState="normal",this.rightPanelExpanded=!1,this.previousConsoleState.expanded&&(this.consoleExpanded=!0,this.consoleHeight=this.previousConsoleState.height||200),this.updateEditorHeight(),this.saveLayoutPreferences()},restoreRightPanel(){this.rightPanelMode="normal",this.rightSidebarVisible=!0,this.saveLayoutPreferences()},handleConsoleUpArrow(){"collapsed"===this.consoleMode?(this.consoleMode="normal",this.consoleExpanded=!0,this.consoleMaximized=!1,this.updateEditorHeight()):"normal"===this.consoleMode&&(this.consolePreviousMode="normal",this.consoleMode="maximized",this.consoleMaximized=!0,this.consoleExpanded=!0,this.updateEditorHeight())},handleConsoleDownArrow(){"normal"!==this.consoleMode&&"maximized"!==this.consoleMode||(this.consoleMode="collapsed",this.consoleExpanded=!1,this.consoleMaximized=!1,this.updateEditorHeight())},handleConsoleRestore(){"maximized"===this.consoleMode&&(this.consoleMode=this.consolePreviousMode||"normal",this.consoleMaximized=!1,this.consoleExpanded="normal"===this.consoleMode,this.updateEditorHeight())},handleTabChange(e,t){this.isReplMode&&this.replSessionId&&(fh.log("🔄 [VmIde] File switched - stopping REPL session"),this.stopReplSession()),t&&t.path&&this.activeFilePath&&this.saveFileConsoleState(this.activeFilePath),e&&e.path&&(this.activeFilePath=e.path,this.loadFileConsoleState(e.path))},saveFileConsoleState(e){if(!e||!e.endsWith(".py"))return;const t=this.ideInfo.consoleItems.find(t=>t.path===e);this.fileConsoleStates[e]={mode:this.consoleMode,expanded:this.consoleExpanded,maximized:this.consoleMaximized,consoleId:t?t.id:null,hasOutput:t&&t.resultList&&t.resultList.length>0}},loadFileConsoleState(e){if(!e||!e.endsWith(".py"))return this.consoleMode="collapsed",this.consoleExpanded=!1,void(this.consoleMaximized=!1);const t=this.fileConsoleStates[e];if(t){if(this.consoleMode=t.mode||"collapsed",this.consoleExpanded=t.expanded||!1,this.consoleMaximized=t.maximized||!1,t.consoleId&&this.ideInfo.consoleItems){const e=this.ideInfo.consoleItems.find(e=>e.id===t.consoleId);e&&this.$nextTick(()=>{this.$store.commit("ide/setConsoleSelected",e)})}}else this.consoleMode="collapsed",this.consoleExpanded=!1,this.consoleMaximized=!1;this.$nextTick(()=>{this.updateEditorHeight()})},getOrCreateFileConsole(e){if(!e||"string"!==typeof e)return fh.error("getOrCreateFileConsole: Invalid file path provided:",e),null;let t=this.ideInfo.consoleItems.find(t=>t.path===e);if(!t){const o=e.split("/").pop(),i={id:this.ideInfo.consoleId,path:e,name:o,run:!1,resultList:[],waitingForInput:!1,inputPrompt:""};this.$store.commit("ide/addConsoleItem",i),this.$store.commit("ide/setConsoleId",this.ideInfo.consoleId+1),t=this.ideInfo.consoleItems.find(e=>e.id===i.id)}return t},expandConsole(){this.consoleMaximized||(this.consoleMaximized=!0,this.consoleExpanded=!0)},restoreConsole(){this.consoleMaximized&&(this.consoleMaximized=!1,this.consoleExpanded=!0)},collapseConsole(){this.consoleExpanded=!1,this.consoleMaximized=!1},selectPreviewTab(e){this.selectedPreviewTab=e},closePreviewTab(e){const t=this.previewTabs.findIndex(t=>t.id===e);if(t>-1){const o=this.previewTabs[t];"pdf"===o.type&&o.content&&o.content.startsWith("blob:")&&URL.revokeObjectURL(o.content),this.previewTabs.splice(t,1),this.selectedPreviewTab===e&&(this.selectedPreviewTab=this.previewTabs.length>0?this.previewTabs[0].id:null),0===this.previewTabs.length&&(this.rightSidebarVisible=!1,this.rightPanelMode="closed")}},addPreviewTab(e,t,o,i,s){fh.log("[addPreviewTab] Adding tab:",{type:e,title:t,filePath:i,projectName:s,hasContent:!!o});const n=this.previewTabs.find(e=>e.filePath===i&&e.projectName===s);if(n)this.selectedPreviewTab=n.id,n.content!==o&&("pdf"===n.type&&n.content&&n.content.startsWith("blob:")&&URL.revokeObjectURL(n.content),n.content=o);else{const n=`${e}-${++this.previewTabCounter}`;this.previewTabs.push({id:n,type:e,title:t,content:o,filePath:i,projectName:s}),this.selectedPreviewTab=n}"closed"!==this.rightPanelMode&&this.rightSidebarVisible||(this.rightPanelMode="normal",this.rightSidebarVisible=!0,this.$nextTick(()=>{this.rightSidebarVisible||(this.rightSidebarVisible=!0)}))},getTabIcon(e){const t={output:"📄",image:"🖼️",pdf:"📑",data:"📊"};return t[e]||"📄"},handleThemeChange(e){fh.log("Theme changed to:",e)},downloadFile(e){if(!e||!e.fileName)return fh.error("[downloadFile] Invalid fileInfo:",e),void ye.nk.error("Cannot download: invalid file information");const t=[".png",".jpg",".jpeg",".gif",".bmp",".svg",".pdf",".zip",".tar",".gz"],o=t.some(t=>e.fileName.toLowerCase().endsWith(t));this.$store.dispatch(`ide/${ve.Jh}`,{projectName:e.projectName,filePath:e.filePath,binary:o,callback:t=>{if(fh.log("[downloadFile] Response:",{code:t.code,hasData:!!t.data,dataKeys:t.data?Object.keys(t.data):[]}),0==t.code){let s,n=t.data?.content||t.data;if(o)try{if("object"===typeof n&&n.content&&(n=n.content),"string"!==typeof n)throw new Error("Binary content is not a string");n.includes(",")&&(n=n.split(",")[1]);const e=atob(n),t=new Uint8Array(e.length);for(let o=0;o<e.length;o++)t[o]=e.charCodeAt(o);s=new Blob([t],{type:"application/octet-stream"})}catch(i){return fh.error("[downloadFile] Error decoding binary data:",i),void ye.nk.error("Failed to decode file data: "+i.message)}else s=new Blob([n],{type:"text/plain"});const r=window.URL.createObjectURL(s),a=document.createElement("a");a.href=r,a.download=e.fileName,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(r),(0,ye.nk)({type:"success",message:`Downloaded ${e.fileName}`,duration:2e3})}else(0,ye.nk)({type:"error",message:`Failed to download ${e.fileName}`,duration:3e3})}})},handleFileCreated(e){fh.log("[handleFileCreated] File created:",e),e&&e.path&&e.projectName&&this.getFile(e.path,!0,e.projectName),this.refreshProjectTree()},handleFolderCreated(e){fh.log("[handleFolderCreated] Folder created:",e),this.refreshProjectTree()},refreshProjectTree(){this.refreshProjectTreeWithCallback(null)},refreshProjectTreeWithCallback(e){const t=this;if(t.ideInfo.multiRootData&&t.ideInfo.multiRootData.children.length>0){fh.log("[VmIde] Refreshing multi-root project tree");let o=0;const i=t.ideInfo.multiRootData.children.length;t.ideInfo.multiRootData.children.forEach(s=>{t.$store.dispatch(`ide/${ve.QQ}`,{projectName:s.name,callback:n=>{0==n.code?(t.$store.commit("ide/handleProject",n.data),o++,o===i&&(fh.log("[VmIde] All projects refreshed"),e&&e())):(fh.error("[VmIde] Failed to refresh project:",s.name,n),o++,o===i&&e&&e())}})})}else this.ideInfo.currProj&&this.ideInfo.currProj.data?(fh.log("[VmIde] Refreshing single project tree"),this.$store.dispatch(`ide/${ve.QQ}`,{projectName:this.ideInfo.currProj.data.name,callback:o=>{0==o.code?(t.$store.commit("ide/handleProject",o.data),fh.log("[VmIde] Single project refreshed successfully")):fh.error("[VmIde] Failed to refresh project:",o),e&&e()}})):(fh.warn("[VmIde] No project to refresh"),e&&e())},inputIsLegal(e,t){this.dialogText=e;let o=this.checkStrIsLegal(this.dialogText,"create-file"===this.dialogType||"rename-file"===this.dialogType);return o&&("create-project"===this.dialogType||"rename-project"===this.dialogType?o=!this.isProjExist(this.dialogText):"create-file"!==this.dialogType&&"rename-file"!==this.dialogType&&"create-folder"!==this.dialogType&&"rename-folder"!==this.dialogType||(o=!this.isFileExist(this.dialogText,"create-file"===this.dialogType||"create-folder"===this.dialogType))),t(o),o},isProjExist(e){const t=this.ideInfo.projList.some(t=>t.name===e);return t&&(this.dialogTips="Project name already exists"),t},isSelectedFile(e){return this.ideInfo.codeSelected&&this.ideInfo.codeSelected.path===e.path&&this.ideInfo.codeSelected.projectName===e.projectName},getParentData(e){if(this.ideInfo.treeRef&&this.ideInfo.treeRef.currentNode&&this.ideInfo.treeRef.currentNode.parent)return this.ideInfo.treeRef.currentNode.parent.data;if(this.ideInfo.multiRootData&&this.ideInfo.multiRootData.children)for(let t of this.ideInfo.multiRootData.children){const o=this.findParentInTree(t,e);if(o)return o}return this.ideInfo.currProj&&this.ideInfo.currProj.data?this.findParentInTree(this.ideInfo.currProj.data,e):null},findParentInTree(e,t){if(!e||!e.children)return null;for(let o of e.children)if(o.path===t)return e;for(let o of e.children)if(t.startsWith(o.path+"/")||o.path===t){const e=this.findParentInTree(o,t);if(e)return e}return null},isFileExist(e,t){let o=!1;if(!this.ideInfo.nodeSelected)return!1;if(t)o=this.ideInfo.nodeSelected.children&&this.ideInfo.nodeSelected.children.some(t=>t.name===e);else{const t=this.getParentData(this.ideInfo.nodeSelected.path);t&&t.children&&(o=t.children.some(t=>t.name===e))}return o&&(this.dialogTips="File with the same name already exists"),o},checkStrIsLegal(e,t){this.dialogTips="";let o=t&&-1!==e.lastIndexOf(".")?e.substring(0,e.lastIndexOf(".")):e;if(!o)return this.dialogTips="Name cannot be empty",!1;if(o.length>15)return this.dialogTips="Name length cannot exceed 15 characters",!1;if(t&&e.endsWith("."))return this.dialogTips="Name can only contain letters, numbers and underscore _",!1;const i=/^[a-zA-Z0-9_]+$/.test(o);return i||(this.dialogTips="Name can only contain letters, numbers and underscore _"),i},listProjects(e){const t=this;this.$store.dispatch(`ide/${ve.qB}`,{callback:o=>{0==o.code&&(t.$store.commit("ide/handleProjects",o.data),e&&t.getProject(e))}})},loadAllDefaultProjects(){fh.log("🚀 [loadAllDefaultProjects] Starting to load default projects");const e=this,t=localStorage.getItem("username"),o=[],i=this.ideInfo.projList.find(e=>e.name===`Local/${t}`);i&&o.push(i.name);const s=["Lecture Notes","Assignments","Tests"];if(s.forEach(e=>{this.ideInfo.projList.some(t=>t.name===e)&&o.push(e)}),fh.log("📋 [loadAllDefaultProjects] Projects to load:",o),fh.log("📋 [loadAllDefaultProjects] Available projects:",this.ideInfo.projList),0===o.length)return void fh.warn("⚠️ [loadAllDefaultProjects] No projects to load");const n=[];let r=0;o.forEach(i=>{fh.log(`🔍 [loadAllDefaultProjects] Loading project: ${i}`),this.$store.dispatch(`ide/${ve.QQ}`,{projectName:i,callback:s=>{if(fh.log(`📥 [loadAllDefaultProjects] Response for ${i}:`,s),0==s.code){if(n.push(s.data),r++,r===o.length){fh.log("✅ [loadAllDefaultProjects] All projects loaded:",n),e.$store.commit("ide/handleMultipleProjects",n);const o=n.find(e=>e.name===`Local/${t}`);o?e.$store.commit("ide/handleProject",o):n.length>0&&e.$store.commit("ide/handleProject",n[0])}}else fh.error(`❌ [loadAllDefaultProjects] Failed to load ${i}:`,s),r++}})})},getProject(e){const t=this;this.$store.dispatch(`ide/${ve.QQ}`,{projectName:void 0===e?this.ideInfo.currProj.config.name:e,callback:e=>{if(0==e.code){t.$store.commit("ide/handleProject",e.data);for(var o=0;o<t.ideInfo.currProj.config.openList.length;o++)t.getFile(t.ideInfo.currProj.config.openList[o],!1,t.ideInfo.currProj.data.name)}}})},getFile(e,t,o,i=!1){const s=this;fh.log("[getFile] Called with:",{path:e,save:t,projectName:o,openInPanel:i});const n=o||this.ideInfo.nodeSelected&&this.ideInfo.nodeSelected.projectName||this.ideInfo.currProj?.data?.name||this.ideInfo.currProj?.config?.name,r=[".png",".jpg",".jpeg",".gif",".bmp",".svg",".webp",".pdf"],a=[".csv"],l=r.some(t=>e.toLowerCase().endsWith(t)),d=a.some(t=>e.toLowerCase().endsWith(t));if(!l&&!d||i)if(l){const o=e.split("/").pop(),i=e.toLowerCase().split(".").pop(),r="pdf"===i?"pdf":"image";fh.log("[getFile] Adding media file tab:",{originalPath:e,fileName:o,fileExt:i,actualProjectName:n}),s.addPreviewTab(r,o,null,e,n),!1!==t&&s.$store.dispatch(`ide/${ve.xv}`,{})}else if(d){const o=e.split("/").pop();this.$store.dispatch(`ide/${ve.Jh}`,{projectName:n,filePath:e,callback:i=>{if(0===i.code&&i.data){const r=i.data.content||i.data;s.addPreviewTab("data",o,r,e,n),!1!==t&&s.$store.dispatch(`ide/${ve.xv}`,{})}else fh.error("Failed to get CSV file:",e,i),(0,ye.nk)({type:"error",message:`Failed to load ${o}`,duration:3e3})}})}else{this.ideInfo.fullscreenPreview&&this.ideInfo.fullscreenPreview.active&&this.$store.commit("ide/closeFullscreenPreview");let o=e;n&&e.startsWith(n+"/")&&(o=e.substring(n.length+1)),fh.log("[getFile] Getting file with relative path:",{originalPath:e,projectName:n,relativePath:o}),this.$store.dispatch(`ide/${ve.Jh}`,{projectName:n,filePath:o,callback:o=>{0==o.code?(s.$store.commit("ide/handleGetFile",{filePath:e,data:o.data,save:t,isMedia:!1,projectName:s.ideInfo.currProj?.data?.name}),!1!==t&&s.$store.dispatch(`ide/${ve.xv}`,{})):fh.error("Failed to get file:",e,o)}})}else this.openFullscreenPreview(e,n)},getFileForRightPanel(e,t){this.getFile(e,!1,t,!0)},getMediaCodeItem(e){const t=e.projectName||this.ideInfo.currProj?.data?.name||this.ideInfo.currProj?.config?.name;return fh.log("[getMediaCodeItem] Creating media code item:",{tabTitle:e.title,tabFilePath:e.filePath,tabProjectName:e.projectName,actualProjectName:t,hasContent:!!e.content,contentType:e.content?e.content.startsWith("data:")?"data-url":e.content.startsWith("blob:")?"blob-url":"other":"none"}),e.content&&e.content.startsWith("data:")||e.content&&e.content.startsWith("blob:")?{name:e.title,path:e.filePath,projectName:t,content:e.content,preloaded:!0}:{name:e.title,path:e.filePath,projectName:t,preloaded:!1}},openFullscreenPreview(e,t){const o=this,i=e.split("/").pop(),s=e.toLowerCase().split(".").pop(),n=[".png",".jpg",".jpeg",".gif",".bmp",".svg",".webp",".pdf"],r=[".csv"],a=n.some(t=>e.toLowerCase().endsWith(t)),l=r.some(t=>e.toLowerCase().endsWith(t));a?this.$store.dispatch(`ide/${ve.Jh}`,{projectName:t,filePath:e,binary:!0,callback:n=>{if(0===n.code&&n.data){let r=n.data.content||n.data;if(r&&r.length>0){const n={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",bmp:"image/bmp",svg:"image/svg+xml",webp:"image/webp",pdf:"application/pdf"},a=n[s]||"application/octet-stream",l=`data:${a};base64,${r}`,d={name:i,path:e,projectName:t,content:l,type:"pdf"===s?"pdf":"image"};o.$store.commit("ide/setFullscreenPreview",{file:d,content:l})}else o.$message.error(`Failed to load ${i}: No content received`)}else o.$message.error(`Failed to load ${i}`)}}):l&&this.$store.dispatch(`ide/${ve.Jh}`,{projectName:t,filePath:e,callback:s=>{if(0===s.code&&s.data){const n=s.data.content||s.data,r={name:i,path:e,projectName:t,content:n,type:"csv"};o.$store.commit("ide/setFullscreenPreview",{file:r,content:n})}else o.$message.error(`Failed to load ${i}`)}})},setTextDialog(e){"create-file"!==e.type||"New File"!==e.title?(this.dialogType=e.type,this.dialogTitle=e.title,this.dialogText=e.text,this.dialogTips=e.tips,this.showFileDialog=!0,this.showProjsDialog=!1):this.showNewFileDialog=!0},handleRenameItem(e){fh.log("[handleRenameItem] Received rename request:",e);const{oldPath:t,newName:o,type:i,projectName:s}=e,n=s||this.ideInfo.currProj?.config?.name||this.ideInfo.currProj?.data?.name;fh.log("[handleRenameItem] Using project:",n),fh.log("[handleRenameItem] Data projectName:",s),fh.log("[handleRenameItem] Current project:",this.ideInfo.currProj?.data?.name),fh.log("[handleRenameItem] Renaming:",{oldPath:t,newName:o,type:i,actualProjectName:n}),"file"===i?this.renameFile(o,t,n):"dir"!==i&&"folder"!==i||this.renameFolder(o,t,n)},handleDeleteItem(e){const{path:t,type:o,projectName:i}=e;fh.log("[handleDeleteItem] Deleting:",o,"at path:",t,"in project:",i),"file"===o?this.deleteFile(t,i):"dir"!==o&&"folder"!==o||this.deleteFolder(t,i)},handleDownloadItem(e){if(fh.log("[handleDownloadItem] Download request:",e),!e||!e.path)return fh.error("[handleDownloadItem] Invalid data:",e),void ye.nk.error("Cannot download: no file selected");const t=e.path.split("/").pop()||e.label||e.name||"download",o={fileName:t,filePath:e.path,projectName:e.projectName||this.ideInfo.currProj?.data?.name||this.ideInfo.currProj?.config?.name};fh.log("[handleDownloadItem] Downloading:",o),this.downloadFile(o)},openFileBrowser(){this.fileBrowserMode="open",this.fileToMove=null,this.showFileBrowserDialog=!0},shareProject(){this.$message.info("Share project feature coming soon!")},handleSignIn(){fh.log("handleSignIn called");const e=localStorage.getItem("session_id"),t=localStorage.getItem("username");e&&t?Ya.s.confirm(`You are already logged in as ${t}. Do you want to sign out and login with a different account?`,"Already Logged In",{confirmButtonText:"Sign Out",cancelButtonText:"Cancel",type:"info"}).then(()=>{localStorage.removeItem("session_id"),localStorage.removeItem("username"),localStorage.removeItem("role"),localStorage.removeItem("full_name"),window.location.reload()}).catch(()=>{}):(fh.log("Setting showLoginModal to true"),this.showLoginModal=!0,fh.log("showLoginModal is now:",this.showLoginModal),this.$nextTick(()=>{fh.log("After nextTick, showLoginModal:",this.showLoginModal),fh.log("Login modal element:",document.querySelector(".login-modal-overlay"))}))},handleLoginSuccess(e){fh.log("Login success received:",e),e?(this.currentUser=e,ye.nk.success(`Welcome, ${e.full_name||e.username}!`),setTimeout(()=>{window.location.reload()},500)):fh.error("No user data received in handleLoginSuccess")},reconnectWebSocket(){this.wsInfo&&this.wsInfo.rws&&this.wsInfo.rws.close(),setTimeout(()=>{this.$store.dispatch("websocket/init")},500)},handleNewFileFromTree(){const e=this.ideInfo.nodeSelected;if(!e||"dir"!==e.type&&"folder"!==e.type){const e=this.ideInfo.currProj?.data;e&&this.$store.commit("ide/setNodeSelected",e)}this.setTextDialog({type:"create-file",title:"New File",tips:"Enter file name:",text:"untitled.py"})},handleNewFolderFromTree(){const e=this.ideInfo.nodeSelected;if(!e||"dir"!==e.type&&"folder"!==e.type){const e=this.ideInfo.currProj?.data;e&&this.$store.commit("ide/setNodeSelected",e)}this.showNewFolderDialog=!0},shareFile(){this.$message.info("Share file feature coming soon!")},handleUndo(){const e=this.getActiveCodeMirrorInstance();e?e.undo():document.execCommand("undo")},handleRedo(){const e=this.getActiveCodeMirrorInstance();e?e.redo():document.execCommand("redo")},handleCut(){const e=this.getActiveCodeMirrorInstance();if(e&&e.somethingSelected()){const t=e.getSelection();navigator.clipboard.writeText(t),e.replaceSelection("")}else document.execCommand("cut")},handleCopy(){const e=this.getActiveCodeMirrorInstance();if(e&&e.somethingSelected()){const t=e.getSelection();navigator.clipboard.writeText(t)}else document.execCommand("copy")},handlePaste(){const e=this.getActiveCodeMirrorInstance();e?navigator.clipboard.readText().then(t=>{e.replaceSelection(t)}).catch(()=>{document.execCommand("paste")}):document.execCommand("paste")},handleFind(){this.findReplaceMode="find",this.showFindReplaceModal=!0},handleReplace(){this.findReplaceMode="replace",this.showFindReplaceModal=!0},handleComment(){const e=this.getActiveCodeMirrorInstance();if(e)try{const t=e.getCursor(),o=e.getLine(t.line);let i=t.ch;if(o.trim().startsWith("# ")){const s=o.replace(/^(\s*)# /,"$1");e.replaceRange(s,{line:t.line,ch:0},{line:t.line,ch:o.length}),i=Math.max(0,t.ch-2)}else if(o.trim().startsWith("#")){const s=o.replace(/^(\s*)#/,"$1");e.replaceRange(s,{line:t.line,ch:0},{line:t.line,ch:o.length}),i=Math.max(0,t.ch-1)}else if(""!==o.trim()){const s=o.match(/^(\s*)(.*)/),n=s[1]||"",r=s[2]||"",a=n+"# "+r;e.replaceRange(a,{line:t.line,ch:0},{line:t.line,ch:o.length}),i=t.ch+2}e.setCursor(t.line,i),e.focus(),e.refresh()}catch(lo){fh.error("Comment toggle error:",lo)}},getActiveCodeMirrorInstance(){const e=document.querySelector(".editor-content .code-editor-flex .CodeMirror");if(e&&e.CodeMirror)return e.CodeMirror;const t=document.querySelectorAll(".code-editor-container");for(let i=0;i<t.length;i++){const e=t[i];if(null!==e.offsetParent){const t=e.querySelector(".CodeMirror");if(t&&t.CodeMirror)return t.CodeMirror}}const o=document.querySelectorAll(".CodeMirror");for(let i=0;i<o.length;i++){const e=o[i];if(e.CodeMirror&&null!==e.offsetParent)return e.CodeMirror}return null},toggleConsole(e){e?(this.consoleMode="normal",this.consolePaneSize=30,this.ideInfo.consoleSelected&&this.ideInfo.consoleSelected.id||this.startEmptyRepl()):(this.consoleMode="collapsed",this.consolePaneSize=5)},startEmptyRepl(){const e={id:"empty-repl-"+Date.now(),name:"Python REPL",path:"REPL",resultList:[],run:!1,stop:!1,waitingForInput:!1,inputPrompt:""};this.$store.commit("ide/pushConsoleItem",e),this.$store.commit("ide/selectConsoleItem",e.id),this.sendMessage({cmd:"start_python_repl",cmd_id:e.id,data:{projectName:this.ideInfo.currProj?.data?.name||"Local"}}),this.$store.commit("ide/updateConsoleItem",{id:e.id,run:!0})},togglePreviewPanel(e){e&&0===this.previewTabs.length?this.$message.info("No files to preview. Open an image, PDF, or CSV file."):this.rightPanelMode=e?"normal":"closed"},handleOpenFile(e){this.getFile(e),this.showFileBrowserDialog=!1},async duplicateFile(e){const{originalPath:t,newName:o,projectName:i}=e,s=this;fh.log("🔍 [DEBUG] duplicateFile called with:",{originalPath:t,newName:o,projectName:i});const n=t.lastIndexOf("/"),r=n>0?t.substring(0,n):"/",a=await this.generateUniqueFileName(o,r,i),l=r+"/"+a;fh.log("🔍 [DEBUG] Generated unique filename:",a),fh.log("🔍 [DEBUG] New file path will be:",l),this.$store.dispatch(`ide/${ve.Jh}`,{projectName:i,filePath:t,callback:e=>{if(0==e.code){const t=e.data.content||e.data;fh.log("🔍 [DEBUG] Original file content retrieved, length:",t?.length),s.$store.dispatch(`ide/${ve.Zd}`,{projectName:i,parentPath:r,fileName:a,callback:e=>{0==e.code?(fh.log("🔍 [DEBUG] File created successfully, now writing content"),s.$store.dispatch(`ide/${ve._L}`,{projectName:i,filePath:l,fileData:t,complete:!0,callback:e=>{0==e.code?(fh.log("🔍 [DEBUG] File duplicated successfully as:",a),ye.nk.success(`File duplicated as ${a}`),s.refreshProjectTree()):(fh.error("🔍 [DEBUG] Failed to write content to duplicate file:",e),ye.nk.error("Failed to write content to duplicate file"))}})):(fh.error("🔍 [DEBUG] Failed to create duplicate file:",e),ye.nk.error("Failed to create duplicate file"))}})}else fh.error("🔍 [DEBUG] Failed to read original file:",e),ye.nk.error("Failed to read original file")}})},async generateUniqueFileName(e,t,o){const i=e.lastIndexOf("."),s=i>0?e.substring(i):"",n=i>0?e.substring(0,i):e;fh.log("🔍 [DEBUG] generateUniqueFileName:",{proposedName:e,baseName:n,extension:s,parentPath:t});const r=await this.getExistingFilesInDirectory(t,o);if(fh.log("🔍 [DEBUG] Existing files in directory:",r),!r.includes(e))return fh.log("🔍 [DEBUG] Proposed name is already unique:",e),e;for(let d=1;d<1e3;d++){const e=1===d?`${n}_copy${s}`:`${n}_copy_${d}${s}`;if(!r.includes(e))return fh.log("🔍 [DEBUG] Found unique name:",e),e}const a=Date.now(),l=`${n}_copy_${a}${s}`;return fh.log("🔍 [DEBUG] Using timestamp fallback:",l),l},async getExistingFilesInDirectory(e,t){return new Promise(t=>{const o=this.ideInfo.currProj?.data;if(!o)return fh.log("🔍 [DEBUG] No project data available"),void t([]);const i=(e,t)=>{if(e.path===t&&"dir"===e.type)return e;if(e.children)for(const o of e.children){const e=i(o,t);if(e)return e}return null},s=i(o,e);if(fh.log("🔍 [DEBUG] Found target directory:",s),s&&s.children){const e=s.children.filter(e=>"file"===e.type).map(e=>e.label||e.name);fh.log("🔍 [DEBUG] Extracted filenames:",e),t(e)}else fh.log("🔍 [DEBUG] Directory not found or has no children"),t([])})},async saveAsFile(e){if(fh.log("🔍 [DEBUG] VmIde.saveAsFile() called with:",e),!e||!e.fileName)return fh.log("🔍 [DEBUG] Invalid fileInfo - no fileName"),void ye.nk.error("No file selected to save");const t=this.ideInfo.codeItems.find(t=>t.filePath===e.filePath&&(t.projectName===e.projectName||!t.projectName&&!e.projectName));fh.log("🔍 [DEBUG] Looking for codeItem with filePath:",e.filePath),fh.log("🔍 [DEBUG] Available codeItems:",this.ideInfo.codeItems?.map(e=>({filePath:e.filePath,projectName:e.projectName}))),fh.log("🔍 [DEBUG] Found codeItem:",!!t),t?(fh.log("🔍 [DEBUG] Using editor content, calling performSaveAs"),await this.performSaveAs(e,t.content)):(fh.log("🔍 [DEBUG] File not in editor, reading from server"),this.readFileForSaveAs(e))},readFileForSaveAs(e){fh.log("🔍 [DEBUG] readFileForSaveAs called with:",e);const t=[".png",".jpg",".jpeg",".gif",".bmp",".svg",".pdf",".zip",".tar",".gz"],o=t.some(t=>e.fileName.toLowerCase().endsWith(t));fh.log("🔍 [DEBUG] File is binary:",o),fh.log("🔍 [DEBUG] Dispatching IDE_GET_FILE with:",{projectName:e.projectName,filePath:e.filePath,binary:o}),this.$store.dispatch(`ide/${ve.Jh}`,{projectName:e.projectName,filePath:e.filePath,binary:o,callback:async t=>{if(fh.log("🔍 [DEBUG] IDE_GET_FILE callback received:",{code:t.code,hasData:!!t.data}),0==t.code){let i=t.data?.content||t.data;if(o)return void ye.nk.info("Binary files should be downloaded using the Download option instead.");"object"===typeof i&&i.content&&(i=i.content),await this.performSaveAs(e,i)}else ye.nk.error("Failed to read file content")}})},async performSaveAs(e,t){fh.log("🔍 [DEBUG] performSaveAs called with fileInfo:",e),fh.log("🔍 [DEBUG] Content length:",t?.length);const o=e=>{const t=e.toLowerCase().split(".").pop(),o={py:"text/x-python",js:"text/javascript",html:"text/html",css:"text/css",json:"application/json",md:"text/markdown",txt:"text/plain",csv:"text/csv",xml:"text/xml"};return o[t]||"text/plain"},i=o(e.fileName),s="showSaveFilePicker"in window,n=window.isSecureContext;if(s&&n)try{const o=e.fileName.split(".").pop()||"txt",s={suggestedName:e.fileName,types:[{description:`${o.toUpperCase()} files`,accept:{[i]:["."+o]}}],excludeAcceptAllOption:!1},n=await window.showSaveFilePicker(s),r=await n.createWritable();if(t.length>1048576){const e=t.match(/.{1,65536}/g)||[];for(const t of e)await r.write(t)}else await r.write(t);return await r.close(),void ye.nk.success(`File saved successfully as: ${n.name}`)}catch(lo){if("AbortError"===lo.name)return;"NotAllowedError"===lo.name?ye.nk.warning("File access permission denied. Using fallback download method."):fh.warn("File System Access API failed:",lo)}else s&&!n&&fh.warn("File System Access API requires HTTPS. Using fallback method.");try{const o=new Blob([t],{type:i+";charset=utf-8"}),s=document.createElement("a"),n="download"in s;if(n){const t=window.URL.createObjectURL(o),i=document.createElement("a");if(i.href=t,i.download=e.fileName,i.style.display="none",i.setAttribute("target","_blank"),i.setAttribute("rel","noopener noreferrer"),document.body.appendChild(i),"function"===typeof i.click)i.click();else{const e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});i.dispatchEvent(e)}setTimeout(()=>{document.body.contains(i)&&document.body.removeChild(i),window.URL.revokeObjectURL(t)},150),ye.nk.success("File downloaded to your default downloads folder")}else{const e=window.URL.createObjectURL(o),t=window.open(e,"_blank");if(!t)throw new Error("Popup blocked or browser not supported");ye.nk.info("File opened in new window. Use browser's save function to download."),setTimeout(()=>{window.URL.revokeObjectURL(e)},1e3)}}catch(lo){if(fh.error("Save As failed:",lo),navigator.clipboard&&navigator.clipboard.writeText)try{await navigator.clipboard.writeText(t),ye.nk.warning("Could not download file. Content copied to clipboard instead.")}catch(r){ye.nk.error("Failed to save file. Please try using a modern browser.")}else ye.nk.error("Failed to save file. Please try using a modern browser.")}},openMoveDialog(e){fh.log("[VmIde] openMoveDialog called with:",e);e.path||e.filePath;const t=(o,i)=>{if("file"===o.type&&o.name===e.name)return o;if(o.children)for(const e of o.children){const o=t(e,i);if(o)return o}return null};let o=e;if(this.ideInfo.multiRootData&&this.ideInfo.multiRootData.children.length>0)for(const i of this.ideInfo.multiRootData.children){const s=t(i,e.name);if(s){fh.log("[VmIde] Found fresh file data in tree:",s.path),o={...e,path:s.path,filePath:s.path};break}}else if(this.ideInfo.currProj&&this.ideInfo.currProj.data){const i=t(this.ideInfo.currProj.data,e.name);i&&(fh.log("[VmIde] Found fresh file data in single project:",i.path),o={...e,path:i.path,filePath:i.path})}this.fileBrowserMode="move",this.fileToMove=o,this.showFileBrowserDialog=!0,fh.log("[VmIde] Move dialog opened with fresh data, mode:",this.fileBrowserMode,"fileToMove:",this.fileToMove)},handleMoveFile(e){fh.log("[VmIde] handleMoveFile called with data:",e);const{oldPath:t,newPath:o,projectName:i}=e,s=this,n=(e,t)=>{if(!e||!t)return e;const o=t+"/";return e.startsWith(o)?e.substring(o.length):e},r=n(t,i),a=n(o,i);if(fh.log("[VmIde] Path normalization:",{originalOldPath:t,normalizedOldPath:r,originalNewPath:o,normalizedNewPath:a,projectName:i}),fh.log("[VmIde] Move parameters:",{oldPath:t,newPath:o,projectName:i,currentUser:this.currentUser}),this.currentUser&&this.currentUser.username&&"student"===this.currentUser.role){const e=`Local/${this.currentUser.username}`;fh.log("[VmIde] Student permission check:",{studentDir:e,oldPathValid:t.startsWith(e+"/")||r.startsWith(e.replace("Local/","")+"/"),newPathValid:o.startsWith(e+"/")||a.startsWith(e.replace("Local/","")+"/"),oldPath:t,newPath:o,normalizedOldPath:r,normalizedNewPath:a});const i=t.startsWith(e+"/")||r.startsWith(e.replace("Local/","")+"/"),s=o.startsWith(e+"/")||a.startsWith(e.replace("Local/","")+"/");if(!i||!s)return fh.error("[VmIde] Permission denied for student move"),ye.nk.error("Students can only move files within their personal directory"),void(this.showFileBrowserDialog=!1)}return r===a?(fh.error("[VmIde] Same source and destination path"),ye.nk.warning("Source and destination paths are the same"),void(this.showFileBrowserDialog=!1)):a.startsWith(r+"/")?(fh.error("[VmIde] Attempting to move file into its subdirectory"),ye.nk.error("Cannot move a file into its own subdirectory"),void(this.showFileBrowserDialog=!1)):(fh.log("[VmIde] Starting move operation - getting file content"),this.$store.dispatch(`ide/${ve.Jh}`,{projectName:i,filePath:r,callback:e=>{if(fh.log("[VmIde] GET_FILE response:",e),0==e.code&&e.data){const n=e.data.content||e.data||"";fh.log("[VmIde] File content retrieved, length:",n?n.length:0),fh.log("[VmIde] Creating file at new location");const l=a.lastIndexOf("/"),d=l>0?a.substring(0,l):"/",c=l>=0?a.substring(l+1):a;fh.log("[VmIde] Create file params:",{projectName:i,parentPath:d,fileName:c}),s.$store.dispatch(`ide/${ve.Zd}`,{projectName:i,parentPath:d,fileName:c,callback:e=>{fh.log("[VmIde] CREATE_FILE response:",e),0==e.code?(fh.log("[VmIde] File created successfully, now writing content"),s.$store.dispatch(`ide/${ve._L}`,{projectName:i,filePath:c,fileData:n,complete:!0,callback:e=>{fh.log("[VmIde] WRITE_FILE response:",e),0==e.code?(fh.log("[VmIde] Content written successfully, deleting original file"),s.$store.dispatch(`ide/${ve.w7}`,{projectName:i,filePath:r,callback:e=>{if(fh.log("[VmIde] DEL_FILE response:",e),0==e.code){fh.log("[VmIde] Move completed successfully"),ye.nk.success("File moved successfully"),s.refreshProjectTreeWithCallback(()=>{if(fh.log("[VmIde] Tree refresh completed after move"),s.ideInfo.nodeSelected&&s.ideInfo.nodeSelected.path===t){fh.log("[VmIde] Updating nodeSelected to new path:",o);const e={...s.ideInfo.nodeSelected,path:o,filePath:o,fileName:o.substring(o.lastIndexOf("/")+1),name:o.substring(o.lastIndexOf("/")+1),label:o.substring(o.lastIndexOf("/")+1)};s.$store.commit("ide/setNodeSelected",e)}s.fileToMove=null,s.showFileBrowserDialog=!1});const e=s.ideInfo.codeItems.find(e=>e.filePath===t&&e.projectName===i);e&&(fh.log("[VmIde] Updating open file reference"),e.filePath=o,e.fileName=o.substring(o.lastIndexOf("/")+1),e.path=o,s.$store.commit("ide/updateCodeItem",{index:s.ideInfo.codeItems.indexOf(e),updates:{filePath:o,fileName:e.fileName,path:o}})),s.fileConsoleStates&&s.fileConsoleStates[t]&&(fh.log("[VmIde] Updating console states"),s.fileConsoleStates[o]=s.fileConsoleStates[t],delete s.fileConsoleStates[t]),fh.log("[VmIde] File moved successfully from",t,"to",o)}else fh.error("[VmIde] Failed to delete original file:",e),ye.nk.error("Failed to delete original file after move")}})):(fh.error("[VmIde] Failed to write file content:",e),ye.nk.error("Failed to write content to new file"))}})):(fh.error("[VmIde] Failed to create file:",e),ye.nk.error("Failed to create file at new location"))}})}else fh.error("[VmIde] Failed to read file:",e),ye.nk.error(e.message||"Failed to read file for moving")}}),void fh.log("[VmIde] Move operation initiated, dialog will close after tree refresh"))},deleteFileFromMenu(e){this.handleDeleteItem(e)},deleteSelectedFile(e){this.handleDeleteItem(e)},setDelDialog(e){this.dialogType="",this.dialogTitle=e.title,this.dialogText="",this.dialogTips="",this.showDeleteDialog=!0},setProjsDialog(e){this.dialogType="",this.dialogTitle="",this.dialogText="",this.dialogTips="",this.showProjsDialog=!0},onCloseTextDialog(){this.showFileDialog=!1,this.ideInfo.nodeSelected&&this.ideInfo.treeRef.setCurrentNode(this.ideInfo.nodeSelected),"create-project"===this.dialogType&&(this.showProjsDialog=!0)},onCloseProjsDialog(){this.showProjsDialog=!1,this.showFileDialog=!1,this.showDeleteDialog=!1,this.ideInfo.nodeSelected&&this.ideInfo.treeRef.setCurrentNode(this.ideInfo.nodeSelected)},onCancelDelete(){this.showDeleteDialog=!1,this.ideInfo.nodeSelected&&this.ideInfo.treeRef.setCurrentNode(this.ideInfo.nodeSelected)},deleteProject(e){const t=this;this.$store.dispatch(`ide/${ve.DO}`,{projectName:e,callback:o=>{0==o.code&&t.$store.commit("ide/handleDelProject",e)}})},deleteFile(e,t){const o=this;fh.log("[deleteFile] Deleting file:",e,"from project:",t||this.ideInfo.currProj.config.name);const i=t||this.ideInfo.currProj.config.name||this.ideInfo.currProj.data?.name;this.$store.dispatch(`ide/${ve.w7}`,{projectName:i,filePath:e,callback:t=>{if(fh.log("[deleteFile] Response:",t),0==t.code){const t=o.getParentData(e);t&&o.$store.commit("ide/handleDelFile",{parentData:t,filePath:e}),o.refreshProjectTree(),(0,ye.nk)({type:"success",message:"File deleted successfully",duration:2e3})}else(0,ye.nk)({type:"error",message:"Failed to delete file",duration:3e3})}})},deleteFolder(e,t){const o=this;fh.log("[deleteFolder] Deleting folder:",e,"from project:",t||this.ideInfo.currProj.config.name);const i=t||this.ideInfo.currProj.config.name||this.ideInfo.currProj.data?.name;this.$store.dispatch(`ide/${ve.Ec}`,{projectName:i,folderPath:e,callback:t=>{if(fh.log("[deleteFolder] Response:",t),0==t.code){const t=o.getParentData(e);t&&o.$store.commit("ide/handleDelFolder",{parentData:t,folderPath:e}),o.refreshProjectTree(),(0,ye.nk)({type:"success",message:"Folder deleted successfully",duration:2e3})}else(0,ye.nk)({type:"error",message:"Failed to delete folder",duration:3e3})}})},createProject(e){const t=this;this.$store.dispatch(`ide/${ve.KV}`,{projectName:e,callback:o=>{0==o.code&&t.listProjects(e)}})},createFile(e,t,o){const i=this;this.$store.dispatch(`ide/${ve.Zd}`,{projectName:void 0===o?this.ideInfo.currProj.config.name:o,parentPath:void 0===t?this.ideInfo.nodeSelected.path:t,fileName:e,callback:t=>{if(0==t.code){const t=gh.join(i.ideInfo.nodeSelected.path,e);i.$store.commit("ide/addChildrenNode",{name:e,path:t,type:"file"}),i.$store.dispatch(`ide/${ve.xv}`,{})}}})},createFolder(e,t,o){const i=this;this.$store.dispatch(`ide/${ve.p_}`,{projectName:void 0===o?this.ideInfo.currProj.config.name:o,parentPath:void 0===t?this.ideInfo.nodeSelected.path:t,folderName:e,callback:t=>{if(0==t.code){const t=gh.join(i.ideInfo.nodeSelected.path,e);i.$store.commit("ide/addChildrenNode",{name:e,path:t,type:"dir"}),i.$store.dispatch(`ide/${ve.xv}`,{})}}})},renameProject(e,t){const o=this;this.$store.dispatch(`ide/${ve.sh}`,{oldName:void 0===t?this.ideInfo.currProj.config.name:t,newName:e,callback:t=>{0==t.code&&(o.$store.commit("ide/handleRename",e),o.$store.dispatch(`ide/${ve.xv}`,{}))}})},renameFile(e,t,o){const i=this;let s=t;if(void 0===s){if(!this.ideInfo.nodeSelected||!this.ideInfo.nodeSelected.path)return fh.error("Cannot rename: no path provided and nodeSelected is null"),void ye.nk.error("Cannot rename: no file selected");s=this.ideInfo.nodeSelected.path}fh.log("[renameFile] Starting rename:",{actualOldPath:s,newName:e,projectName:o});const n=o||this.ideInfo.currProj?.config?.name||this.ideInfo.currProj?.data?.name;fh.log("[renameFile] Using project name:",n),this.$store.dispatch(`ide/${ve.Z0}`,{projectName:n,oldPath:s,fileName:e,callback:t=>{if(fh.log("[renameFile] Backend response:",t),0==t.code){const t=s.substring(0,s.lastIndexOf("/")+1)+e;fh.log("[renameFile] New path will be:",t);for(let o=0;o<i.ideInfo.codeItems.length;o++)if(i.ideInfo.codeItems[o].path===s){fh.log("[renameFile] Updating open tab from",s,"to",t),i.ideInfo.codeItems[o].path=t,i.ideInfo.codeItems[o].name=e;break}i.$store.dispatch(`ide/${ve.QQ}`,{projectName:n,callback:e=>{0==e.code&&(i.$store.commit("ide/handleProject",e.data),i.$store.commit("ide/setPathSelected",t),i.ideInfo.multiRootData&&(fh.log("[renameFile] Refreshing all projects in multi-root mode"),i.loadAllDefaultProjects()),ye.nk.success("File renamed successfully"))}})}else{fh.error("[renameFile] Rename failed:",t);const e=t.data?.message||t.message||"Unknown error";ye.nk.error("Failed to rename file: "+e)}}})},renameFolder(e,t,o){const i=this;let s=t;if(void 0===s){if(!this.ideInfo.nodeSelected||!this.ideInfo.nodeSelected.path)return fh.error("Cannot rename folder: no path provided and nodeSelected is null"),void ye.nk.error("Cannot rename folder: no folder selected");s=this.ideInfo.nodeSelected.path}fh.log("[renameFolder] Starting rename:",{actualOldPath:s,newName:e,projectName:o});const n=o||this.ideInfo.currProj?.config?.name||this.ideInfo.currProj?.data?.name;fh.log("[renameFolder] Using project name:",n),this.$store.dispatch(`ide/${ve.Zz}`,{projectName:n,oldPath:s,folderName:e,callback:t=>{if(fh.log("[renameFolder] Backend response:",t),0==t.code){const t=s.substring(0,s.lastIndexOf("/")+1)+e;fh.log("[renameFolder] New path will be:",t);for(let e=0;e<i.ideInfo.codeItems.length;e++)if(i.ideInfo.codeItems[e].path.startsWith(s+"/")){const o=i.ideInfo.codeItems[e].path.substring(s.length),n=t+o;fh.log("[renameFolder] Updating open tab from",i.ideInfo.codeItems[e].path,"to",n),i.ideInfo.codeItems[e].path=n}i.$store.dispatch(`ide/${ve.QQ}`,{projectName:n,callback:e=>{0==e.code&&(i.$store.commit("ide/handleProject",e.data),i.$store.commit("ide/setPathSelected",t),i.ideInfo.multiRootData&&(fh.log("[renameFolder] Refreshing all projects in multi-root mode"),i.loadAllDefaultProjects()),ye.nk.success("Folder renamed successfully"))}})}else{fh.error("[renameFolder] Rename failed:",t);const e=t.data?.message||t.message||"Unknown error";ye.nk.error("Failed to rename folder: "+e)}}})},onDelete(){this.showDeleteDialog=!1,this.ideInfo.nodeSelected&&this.ideInfo.nodeSelected.type&&("dir"===this.ideInfo.nodeSelected.type||"folder"===this.ideInfo.nodeSelected.type)?this.deleteFolder(this.ideInfo.nodeSelected.path):this.deleteFile(this.ideInfo.nodeSelected.path)},onCreate(){const e=this.dialogText;if("create-file"===this.dialogType)this.createFile(e);else if("rename-file"===this.dialogType)this.renameFile(e);else if("create-folder"===this.dialogType)this.createFolder(e);else if("rename-folder"===this.dialogType)this.renameFolder(e);else if("create-project"===this.dialogType)if(this.hasRunProgram){const t=this;Ya.s.confirm("Stop all running programs and create new project?","Warning",{confirmButtonText:"Stop and Create",cancelButtonText:"Cancel",type:"warning"}).then(()=>{t.stopAll(),t.$store.commit("ide/setConsoleItems",[]),t.createProject(e)}).catch(()=>{fh.log("canceled create project")})}else this.$store.commit("ide/setConsoleItems",[]),this.createProject(e);else"rename-project"===this.dialogType&&this.renameProject(e);this.showProjsDialog=!1,this.showFileDialog=!1,this.showDeleteDialog=!1},onDeleteProj(e){const t=this;Ya.s.confirm("Delete this project?","Confirm",{confirmButtonText:"Delete",cancelButtonText:"Cancel",type:"warning"}).then(()=>{t.deleteProject(e),(0,ye.nk)({type:"success",message:"Deleted successfully"})}).catch(()=>{(0,ye.nk)({type:"info",message:"Cancelled"})})},onSelectProj(e){this.hasRunProgram?Ya.s.confirm("Stop all running programs and switch project?","Warning",{confirmButtonText:"Stop and Switch",cancelButtonText:"Cancel",type:"warning"}).then(()=>{this.stopAll(),this.$store.commit("ide/setConsoleItems",[]),this.getProject(e),this.showProjsDialog=!1}).catch(()=>{this.showProjsDialog=!1}):(this.getProject(e),this.showProjsDialog=!1,this.$store.commit("ide/setConsoleItems",[]))},selectFile(e){const t=this.ideInfo.codeSelected,o=t&&t.path!==e.path;if(o&&t.path&&t.path.endsWith(".py")){const e=this.ideInfo.consoleItems.find(e=>e.path===t.path);e&&e.run&&!this.isReplMode&&(this.stop(e.id),e.waitingForInput&&this.$store.commit("ide/updateConsoleItem",{id:e.id,waitingForInput:!1,inputPrompt:""})),this.saveFileConsoleState(t.path)}if(this.$store.commit("ide/setPathSelected",e.path),this.$store.commit("ide/setCodeSelected",e),this.activeFilePath=e.path,o&&e.path&&e.path.endsWith(".py")){let t=this.ideInfo.consoleItems.find(t=>t.path===e.path);t||(t={id:this.$store.state.ide.consoleId,name:e.name,path:e.path,resultList:[],run:!1,stop:!1,waitingForInput:!1,inputPrompt:""},this.$store.commit("ide/pushConsoleItem",t)),this.$store.commit("ide/setConsoleSelected",t),this.consoleMode="collapsed",this.consoleExpanded=!1,this.consoleMaximized=!1,this.$nextTick(()=>{this.updateEditorHeight()})}this.ideInfo.currProj.pathSelected&&this.ideInfo.treeRef&&(this.ideInfo.treeRef.setCurrentKey(this.ideInfo.currProj.pathSelected),this.$store.commit("ide/setNodeSelected",this.ideInfo.treeRef.getCurrentNode())),this.$store.dispatch(`ide/${ve.xv}`,{})},closeFile(e){if(e.path&&e.path.endsWith(".py")){this.activeFilePath===e.path&&this.saveFileConsoleState(e.path);const t=this.ideInfo.consoleItems.filter(t=>t.path!==e.path);this.$store.commit("ide/setConsoleItems",t)}const t=[];for(let o=0;o<this.ideInfo.codeItems.length;o++)e.path!==this.ideInfo.codeItems[o].path?t.push(this.ideInfo.codeItems[o]):o>0?this.ideInfo.currProj.pathSelected===e.path&&(this.$store.commit("ide/setPathSelected",this.ideInfo.codeItems[o-1].path),this.$store.commit("ide/setCodeSelected",this.ideInfo.codeItems[o-1])):o<this.ideInfo.codeItems.length-1&&this.ideInfo.currProj.pathSelected===e.path&&(this.$store.commit("ide/setPathSelected",this.ideInfo.codeItems[o+1].path),this.$store.commit("ide/setCodeSelected",this.ideInfo.codeItems[o+1]));this.$store.commit("ide/setCodeItems",t),0===this.ideInfo.codeItems.length&&(this.$store.commit("ide/setPathSelected",null),this.$store.commit("ide/setCodeSelected",{})),this.$store.dispatch(`ide/${ve.xv}`,{})},updateItem(e,t){for(let o=0;o<this.ideInfo.codeItems.length;o++)if(e===this.ideInfo.codeItems[o].path){this.$store.commit("ide/setCodeItemMirror",{index:o,codemirror:t});break}},selectConsole(e){this.$store.commit("ide/setConsoleSelected",e)},closeConsoleSafe(e){!0===e.run?Ya.s.confirm("Stop this program and close terminal?","Warning",{confirmButtonText:"Stop and Close",cancelButtonText:"Cancel",type:"warning"}).then(()=>{this.stop(e.id),this.closeConsole(e)}).catch(()=>{fh.log("canceled close console")}):this.closeConsole(e)},closeConsole(e){const t=[];for(let o=0;o<this.ideInfo.consoleItems.length;o++)"Terminal"===e.name&&"Terminal"===e.path?e.id!==this.ideInfo.consoleItems[o].id?t.push(this.ideInfo.consoleItems[o]):o>0?this.$store.commit("ide/setConsoleSelected",this.ideInfo.consoleItems[o-1]):o<this.ideInfo.consoleItems.length-1&&this.$store.commit("ide/setConsoleSelected",this.ideInfo.consoleItems[o+1]):e.path!==this.ideInfo.consoleItems[o].path||e.id!==this.ideInfo.consoleItems[o].id?t.push(this.ideInfo.consoleItems[o]):o>0?this.$store.commit("ide/setConsoleSelected",this.ideInfo.consoleItems[o-1]):o<this.ideInfo.consoleItems.length-1&&this.$store.commit("ide/setConsoleSelected",this.ideInfo.consoleItems[o+1]);this.$store.commit("ide/setConsoleItems",t),0===this.ideInfo.consoleItems.length&&this.$store.commit("ide/setConsoleSelected",{}),this.resize()},getCurrentConsoleHeight(){return 400},resize(){this.windowWidth=window.innerWidth,this.$forceUpdate()},runPathSelected(){const e=this.ideInfo.currProj.pathSelected;if(!e||""===e||null===e)return void(0,ye.nk)({type:"warning",message:"No script is open to run. Please open a Python file first.",duration:3e3});this.consoleExpanded||(this.consoleExpanded=!0,this.updateEditorHeight());const t=this.getOrCreateFileConsole(e);this.$store.commit("ide/resetConsoleItem",{consoleId:t.id,run:!1,stop:!1,resultList:[]}),this.$store.commit("ide/setConsoleSelected",t),this.$store.commit("ide/assignConsoleSelected",{id:this.ideInfo.consoleId}),this.saveFileConsoleState(e),"collapsed"===this.consoleMode&&(this.consoleMode="normal",this.consoleExpanded=!0,this.consoleMaximized=!1);const o=this.ideInfo.codeSelected?.projectName||this.ideInfo.currProj?.data?.name||this.ideInfo.currProj?.config?.name,i=this.ideInfo.consoleId;this.replSessionId=i,fh.log(`[VmIde] Setting replSessionId to ${i} for Python program execution`),this.$store.dispatch(`ide/${ve.j8}`,{msgId:i,projectName:o,filePath:this.ideInfo.currProj.pathSelected,callback:{limits:-1,callback:e=>{fh.log("🔍 [VmIde] Script execution callback:",e);const t=e.id===this.replSessionId||e.cmd_id===this.replSessionId||e.data&&e.data.program_id===this.replSessionId||this.isReplMode&&this.replSessionId&&(0===e.code||2e3===e.code||5e3===e.code)&&e.data&&(e.data.stdout||e.data.stderr),o=null===e.data||void 0===e.data||2e3===e.code||4e3===e.code||5e3===e.code;fh.log("🔍 [Script] Callback - isReplMessage:",t,"isProgramLifecycle:",o,"code:",e.code,"id:",e.id,"replSessionId:",this.replSessionId),!t||o?(fh.log("✅ [Script] Processing through handleRunResult"),this.$store.commit("ide/handleRunResult",e)):fh.log("⏭️ [Script] Skipping - will be handled by REPL"),5e3!==e.code||t||(fh.log("🎯 [VmIde] Script completed, entering REPL mode"),this.isReplMode=!0)}}}),this.$store.commit("ide/setConsoleId",this.ideInfo.consoleId+1)},runConsoleSelected(){this.switchToOutputTab(),"collapsed"===this.consoleMode&&(this.consoleMode="normal",this.consoleExpanded=!0,this.consoleMaximized=!1);const e=this.ideInfo.consoleSelected?.projectName||this.ideInfo.currProj?.data?.name||this.ideInfo.currProj?.config?.name,t=this.ideInfo.consoleSelected.id;this.replSessionId=t,fh.log(`[VmIde] Setting replSessionId to ${t} for Python program re-run`),this.$store.dispatch(`ide/${ve.j8}`,{msgId:t,projectName:e,filePath:this.ideInfo.consoleSelected.path,callback:{limits:-1,callback:e=>{const t=e.id===this.replSessionId||e.cmd_id===this.replSessionId||e.data&&e.data.program_id===this.replSessionId||this.isReplMode&&this.replSessionId&&(0===e.code||2e3===e.code||5e3===e.code)&&e.data&&(e.data.stdout||e.data.stderr),o=null===e.data||void 0===e.data||2e3===e.code||4e3===e.code||5e3===e.code;fh.log("🔍 [REPL] Callback - isReplMessage:",t,"isProgramLifecycle:",o,"code:",e.code,"id:",e.id,"replSessionId:",this.replSessionId),!t||o?(fh.log("✅ [REPL] Processing through handleRunResult"),this.$store.commit("ide/handleRunResult",e)):fh.log("⏭️ [REPL] Skipping - will be handled by WebSocket")}}})},stop(e){this.$store.dispatch(`ide/${ve.aQ}`,{consoleId:e,callback:{limits:-1,callback:t=>{this.$store.commit("ide/handleStopResult",{consoleId:e,dict:t})}}})},stopAll(){for(let e=0;e<this.ideInfo.consoleItems.length;e++)!0===this.ideInfo.consoleItems[e].run&&this.stop(this.ideInfo.consoleItems[e].id);this.stop(null)},startResizeLeft(e){this.isResizingLeft=!0,this.startX=e.clientX,this.startWidth=this.leftSidebarWidth,document.addEventListener("mousemove",this.throttledHandleResizeLeft),document.addEventListener("mouseup",this.stopResizeLeft),e.preventDefault()},handleResizeLeft(e){if(!this.isResizingLeft)return;const t=e.clientX-this.startX,o=window.innerWidth,i=this.rightSidebarVisible?this.rightSidebarWidth:0,s=o-i-this.minEditorWidth-10;let n=this.startWidth+t;this.resizeWarning=n<160||n>s-10,n=Math.max(150,Math.min(Math.min(500,s),n)),this.leftSidebarWidth=n},stopResizeLeft(){this.isResizingLeft=!1,this.resizeWarning=!1,document.removeEventListener("mousemove",this.throttledHandleResizeLeft),document.removeEventListener("mouseup",this.stopResizeLeft),this.validateLayout(),this.saveLayoutPreferences()},startResizeRight(e){this.isResizingRight=!0,this.startX=e.clientX,this.startWidth=this.rightSidebarWidth,document.addEventListener("mousemove",this.throttledHandleResizeRight),document.addEventListener("mouseup",this.stopResizeRight),e.preventDefault()},handleResizeRight(e){if(!this.isResizingRight)return;const t=this.startX-e.clientX,o=window.innerWidth,i=o-this.leftSidebarWidth-this.minEditorWidth-10;let s=this.startWidth+t;this.resizeWarning=s<310||s>i-10,s=Math.max(300,Math.min(i,s)),this.rightSidebarWidth=s},stopResizeRight(){this.isResizingRight=!1,this.resizeWarning=!1,document.removeEventListener("mousemove",this.throttledHandleResizeRight),document.removeEventListener("mouseup",this.stopResizeRight),this.validateLayout(),this.saveLayoutPreferences()},startResizeConsole(e){this.isResizingConsole=!0,this.startY=e.clientY,this.startHeight=this.consoleHeight,document.addEventListener("mousemove",this.throttledHandleResizeConsole),document.addEventListener("mouseup",this.stopResizeConsole),e.preventDefault()},handleResizeConsole(e){if(!this.isResizingConsole)return;const t=this.startY-e.clientY,o=window.innerHeight,i=o-200;let s=this.startHeight+t;s=Math.max(100,Math.min(i,s)),this.consoleHeight=s,this.updateEditorHeight()},stopResizeConsole(){this.isResizingConsole=!1,document.removeEventListener("mousemove",this.throttledHandleResizeConsole),document.removeEventListener("mouseup",this.stopResizeConsole),this.updateEditorHeight(),this.saveLayoutPreferences()},saveLayoutPreferences(){const e={leftSidebarWidth:this.leftSidebarWidth,rightSidebarWidth:this.rightSidebarWidth,rightSidebarVisible:this.rightSidebarVisible,consoleHeight:this.consoleHeight,consoleExpanded:this.consoleExpanded,wordWrap:this.wordWrap,rightPanelMode:this.rightPanelMode,consoleMode:this.consoleMode,consolePreviousMode:this.consolePreviousMode,wasConsoleOpenBeforeRightExpand:this.wasConsoleOpenBeforeRightExpand};localStorage.setItem("ide-layout-preferences",JSON.stringify(e))},loadLayoutPreferences(){const e=localStorage.getItem("ide-layout-preferences");if(e)try{const t=JSON.parse(e);this.leftSidebarWidth=t.leftSidebarWidth||250,this.rightSidebarWidth=t.rightSidebarWidth||400,this.rightSidebarVisible=!0===t.rightSidebarVisible,this.consoleHeight=t.consoleHeight||200,this.consoleExpanded=!1!==t.consoleExpanded,this.wordWrap=!1!==t.wordWrap,this.rightPanelMode=t.rightPanelMode||"closed",this.consoleMode=t.consoleMode||"collapsed",this.consolePreviousMode=t.consolePreviousMode||"normal",this.wasConsoleOpenBeforeRightExpand=t.wasConsoleOpenBeforeRightExpand||!1,this.rightSidebarVisible="closed"!==this.rightPanelMode,this.consoleExpanded="collapsed"!==this.consoleMode,this.consoleMaximized="maximized"===this.consoleMode}catch(t){fh.warn("Failed to load layout preferences:",t)}this.validateLayout(),this.updateEditorHeight()},validateLayout(){const e=window.innerWidth;if(e<900)return;const t=this.leftSidebarWidth+(this.rightSidebarVisible?this.rightSidebarWidth:0),o=e-t-10;if(o<this.minEditorWidth){const t=this.minEditorWidth-o;if(this.rightSidebarVisible){const o=this.leftSidebarWidth/(this.leftSidebarWidth+this.rightSidebarWidth),i=1-o,s=Math.min(this.leftSidebarWidth-150,t*o),n=Math.min(this.rightSidebarWidth-300,t*i);this.leftSidebarWidth=Math.max(150,this.leftSidebarWidth-s),this.rightSidebarWidth=Math.max(300,this.rightSidebarWidth-n);const r=this.leftSidebarWidth+this.rightSidebarWidth;e-r-10<this.minEditorWidth&&(this.rightSidebarVisible=!1)}else this.leftSidebarWidth=Math.max(150,Math.min(this.leftSidebarWidth,e-this.minEditorWidth-10))}},handleProgramInputKeydown(e){if("Enter"===e.key)if(e.shiftKey){e.preventDefault();const t=e.target.selectionStart,o=e.target.selectionEnd,i=this.programInput;this.programInput=i.substring(0,t)+"\n"+i.substring(o),this.$nextTick(()=>{e.target.selectionStart=e.target.selectionEnd=t+1,this.updateProgramInputRows()})}else e.preventDefault(),this.sendProgramInput();else if("Tab"===e.key){e.preventDefault();const t=e.target.selectionStart,o=e.target.selectionEnd,i=this.programInput;this.programInput=i.substring(0,t)+"    "+i.substring(o),this.$nextTick(()=>{e.target.selectionStart=e.target.selectionEnd=t+4,this.updateProgramInputRows()})}this.$nextTick(()=>{this.updateProgramInputRows()})},updateProgramInputRows(){const e=7,t=this.programInput.split("\n").length;this.$refs.programInputField?(this.programInputRows=1,this.$nextTick(()=>{const t=this.$refs.programInputField,o=parseInt(window.getComputedStyle(t).lineHeight)||20,i=t.scrollHeight,s=Math.ceil(i/o);this.programInputRows=Math.min(e,Math.max(1,s))})):this.programInputRows=Math.min(e,Math.max(1,t))},sendProgramInput(){if(!this.programInput.trim())return;const e=this.programInput,t=this.ideInfo.consoleSelected.id;this.$store.commit("ide/addConsoleOutput",{id:t,type:"input",text:`▶ ${e}`}),this.programInput="",this.programInputRows=1,this.$store.commit("ide/setConsoleWaiting",{id:t,waiting:!1,prompt:""}),this.$store.dispatch(`ide/${ve.WP}`,{program_id:t,input:e,callback:{limits:-1,callback:e=>{fh.log("Input sent:",e)}}}),this.$nextTick(()=>{this.$refs.consoleOutputArea&&(this.$refs.consoleOutputArea.scrollTop=this.$refs.consoleOutputArea.scrollHeight)})},handleReplKeydown(e){if("Enter"===e.key)if(e.shiftKey){e.preventDefault();const t=e.target.selectionStart,o=e.target.selectionEnd,i=this.replInput;this.replInput=i.substring(0,t)+"\n"+i.substring(o),this.$nextTick(()=>{e.target.selectionStart=e.target.selectionEnd=t+1,this.updateReplRows()})}else{e.preventDefault();const t=e.target.selectionStart,o=this.replInput.substring(0,t),i=o.split("\n"),s=i[i.length-1],n=""===s.trim(),r=this.replInput.includes("\n");if(n&&r)this.executeReplCommand();else if(this.shouldContinueMultiline(this.replInput)){const t=e.target.selectionStart,o=e.target.selectionEnd,i=this.replInput;this.replInput=i.substring(0,t)+"\n"+i.substring(o),this.$nextTick(()=>{e.target.selectionStart=e.target.selectionEnd=t+1,this.updateReplRows()})}else this.executeReplCommand()}else if("Tab"===e.key){e.preventDefault();const t=e.target.selectionStart,o=e.target.selectionEnd,i=this.replInput;this.replInput=i.substring(0,t)+"    "+i.substring(o),this.$nextTick(()=>{e.target.selectionStart=e.target.selectionEnd=t+4,this.updateReplRows()})}else"ArrowUp"!==e.key||0!==e.target.selectionStart||this.replInput.includes("\n")?"ArrowDown"!==e.key||this.replInput.includes("\n")||(e.preventDefault(),this.navigateReplHistory("down")):(e.preventDefault(),this.navigateReplHistory("up"));this.$nextTick(()=>{this.updateReplRows()})},updateReplRows(){const e=7,t=this.replInput.split("\n").length;this.$refs.replInputField?(this.replInputRows=1,this.$nextTick(()=>{const t=this.$refs.replInputField,o=parseInt(window.getComputedStyle(t).lineHeight)||20,i=t.scrollHeight,s=Math.ceil(i/o);this.replInputRows=Math.min(e,Math.max(1,s))})):this.replInputRows=Math.min(e,Math.max(1,t))},async executeReplCommand(){let e=this.replInput;while(e.endsWith("\n\n"))e=e.slice(0,-1);if(!e||!e.trim())return this.replInput="",void(this.replInputRows=1);if(this.ideInfo.consoleSelected&&this.ideInfo.consoleSelected.waitingForReplInput){const t=this.ideInfo.consoleSelected.id;if(this.replInput="",this.replInputRows=1,this.$store.commit("ide/addConsoleOutput",{id:t,type:"user-input",text:`>>> ${e}`}),this.wsInfo&&this.wsInfo.rws&&this.wsInfo.rws.readyState===WebSocket.OPEN){const o={cmd:"send_program_input",id:t,data:{program_id:t,input:e}};this.wsInfo.rws.send(JSON.stringify(o)),this.$store.commit("ide/setConsoleWaitingForReplInput",{id:t,waiting:!1})}}else await this.executeReplCommandDualMode(e)},shouldContinueMultiline(e){if(!e||!e.trim())return!1;const t=e.split("\n"),o=t[t.length-1].trim();if(o.endsWith(":"))return!0;e.trim();let i=0,s=0;for(const n of t){if(""===n.trim())continue;const e=n.search(/\S/);if(-1===e)continue;const t=n.trim();t.match(/^(def|class|if|elif|else|for|while|with|try|except|finally)\b.*:/)?(i++,s=e):e<=s&&i>0&&!t.match(/^(elif|else|except|finally)\b/)&&(i=Math.max(0,i-1),s=e)}return i>0&&!o.match(/^(return|break|continue|pass|raise)\b/)},highlightPythonCode(e){if(!e||"string"!==typeof e)return e;if("undefined"!==typeof Prism&&Prism.languages&&Prism.languages.python)try{return Prism.highlight(e,Prism.languages.python,"python")}catch(lo){return fh.warn("Prism.js highlighting failed:",lo),this.simpleHighlight(e)}return this.simpleHighlight(e)},isPromptOutput(e){const t=e.text||e.content||e;return"string"===typeof t&&(t.match(/^\s*>>>\s*$/)||t.match(/^\s*\.\.\.\s*$/)||t.match(/^>>>\s*\n*$/)||t.match(/^\.\.\.\s*\n*$/)||">>>"===t.trim()||"..."===t.trim()||">>> "===t||"... "===t)},simpleHighlight(e){if(!e)return e;let t=this.escapeHtml(e);const o=["def","class","if","elif","else","try","except","finally","for","while","with","as","import","from","return","yield","lambda","pass","break","continue","raise","assert","del","and","or","not","in","is","None","True","False","async","await"],i=new RegExp(`\\b(${o.join("|")})\\b`,"g");t=t.replace(i,'<span class="python-keyword">$1</span>'),t=t.replace(/(["'])((?:\\.|(?!\1).)*?)\1/g,'<span class="python-string">$1$2$1</span>'),t=t.replace(/\b(\d+\.?\d*)\b/g,'<span class="python-number">$1</span>'),t=t.replace(/(#.*$)/gm,'<span class="python-comment">$1</span>');const s=["print","input","range","len","str","int","float","list","dict","set","tuple","type","sum","max","min","abs","round","sorted","reversed"],n=new RegExp(`\\b(${s.join("|")})\\b`,"g");return t=t.replace(n,'<span class="python-builtin">$1</span>'),t},escapeHtml(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,e=>t[e])},isMultilineCode(e){return!(!e||"string"!==typeof e)&&(e.includes("\n")&&""!==e.trim())},splitCodeLines(e){return e&&"string"===typeof e?e.split("\n"):[e||""]},ensureReplConsole(){if(fh.log("🔍 [VmIde] ensureReplConsole called"),!this.ideInfo.consoleSelected||!this.ideInfo.consoleSelected.resultList){const e={id:"repl-console",name:"REPL",path:"REPL",resultList:[],run:!1,stop:!1,waitingForInput:!1,inputPrompt:""},t=this.ideInfo.consoleItems.find(e=>"repl-console"===e.id);t||this.$store.commit("ide/pushConsoleItem",e),this.$store.commit("ide/selectConsoleItem","repl-console")}},addReplOutput(e,t="output"){fh.log(`📢 [VmIde] addReplOutput: [${t}] ${e}`),this.ideInfo.consoleSelected&&this.ideInfo.consoleSelected.id&&(this.$store.commit("ide/addConsoleOutput",{id:this.ideInfo.consoleSelected.id,type:t,text:e}),this.$nextTick(()=>{this.$refs.consoleOutputArea&&(this.$refs.consoleOutputArea.scrollTop=this.$refs.consoleOutputArea.scrollHeight)}))},navigateReplHistory(e){if(0!==this.replHistory.length){if("up"===e)-1===this.replHistoryIndex?this.replHistoryIndex=this.replHistory.length-1:this.replHistoryIndex>0&&this.replHistoryIndex--;else if("down"===e){if(-1===this.replHistoryIndex)return;if(!(this.replHistoryIndex<this.replHistory.length-1))return this.replHistoryIndex=-1,void(this.replInput="");this.replHistoryIndex++}this.replHistoryIndex>=0&&(this.replInput=this.replHistory[this.replHistoryIndex])}},async executeTerminalCommand(){if(!this.terminalInput.trim())return;const e=this.terminalInput.trim();if(this.terminalHistory[this.terminalHistory.length-1]!==e&&this.terminalHistory.push(e),this.terminalHistoryIndex=-1,this.addTerminalOutput("input",e),"clear"===e||"clear()"===e)return this.clearTerminal(),void(this.terminalInput="");if("help"===e||"help()"===e)return this.addTerminalOutput("output",this.getHelpText()),this.terminalInput="",void this.$nextTick(()=>{this.scrollTerminalToBottom(),this.focusTerminalInput()});const t=await this.ensurePyodideReady();if(!t)return this.addTerminalOutput("error","Python environment failed to initialize"),void(this.terminalInput="");try{fh.log("[Pyodide] Executing:",e);const t=this.pyodide.runPython(e);void 0!==t&&null!==t&&this.addTerminalOutput("output",String(t))}catch(lo){fh.error("[Pyodide] Execution error:",lo),this.addTerminalOutput("error",lo.toString())}this.terminalInput="",this.$nextTick(()=>{this.scrollTerminalToBottom(),this.focusTerminalInput()})},addTerminalOutput(e,t){this.terminalOutput.push({type:e,content:t,timestamp:(new Date).toISOString()})},getHelpText(){return"🐍 Python Interactive Terminal (Powered by Pyodide)\n\nFeatures:\n• Full Python 3.11 environment in your browser\n• All variables and imports persist across commands\n• NumPy, Pandas, Matplotlib support available\n• Use Up/Down arrows for command history\n• Type 'clear' to clear the terminal\n\nTry these examples:\n  >>> import math\n  >>> math.sqrt(16)\n  >>> x = [1, 2, 3, 4, 5]\n  >>> sum(x)\n\nAdvanced packages (install with micropip):\n  >>> import micropip\n  >>> await micropip.install(\"requests\")"},navigateHistory(e){if(0!==this.terminalHistory.length){if("up"===e)-1===this.terminalHistoryIndex?this.terminalHistoryIndex=this.terminalHistory.length-1:this.terminalHistoryIndex>0&&this.terminalHistoryIndex--;else if("down"===e){if(-1===this.terminalHistoryIndex)return;if(!(this.terminalHistoryIndex<this.terminalHistory.length-1))return this.terminalHistoryIndex=-1,void(this.terminalInput="");this.terminalHistoryIndex++}this.terminalHistoryIndex>=0&&(this.terminalInput=this.terminalHistory[this.terminalHistoryIndex])}},scrollTerminalToBottom(){this.$refs.terminalContent&&(this.$refs.terminalContent.scrollTop=this.$refs.terminalContent.scrollHeight)},focusTerminalInput(){this.$refs.terminalInputField&&this.$refs.terminalInputField.focus()},switchToOutputTab(){this.consoleModeTab="output"},switchToTerminalTab(){this.consoleModeTab="terminal",this.$nextTick(()=>{this.focusTerminalInput()})}}};const yh=(0,k.A)(vh,[["render",rd],["__scopeId","data-v-f7bccc82"]]);var wh=yh},44317:function(e,t,o){(function(e){e(o(15237))})(function(e){e.defineOption("showTrailingSpace",!1,function(t,o,i){i==e.Init&&(i=!1),i&&!o?t.removeOverlay("trailingspace"):!i&&o&&t.addOverlay({token:function(e){for(var t=e.string.length,o=t;o&&/\s/.test(e.string.charAt(o-1));--o);return o>e.pos?(e.pos=o,null):(e.pos=t,"trailingspace")},name:"trailingspace"})})})}}]);